<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"samarium-z.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="[TOC] 一、网络安全概述1.1 计算机安全面临的挑战1.1.1 信息在处理、保存、传输中的安全威胁 窃听导致消息内容泄露 流量分析攻击 改写消息 攻击者假冒其他用户 拒绝服务攻击 重放攻击1.2 计算机安全的目标 CIA三元组： 机密性 完整性 可用性   其他： 认证和不可否认性（真实性） 可计量性：能够追踪安全违规的责任方1.3 计算机入侵的特点1.3.1 计算机入侵基本术语   计算系统">
<meta property="og:type" content="article">
<meta property="og:title" content="网络安全">
<meta property="og:url" content="https://samarium-z.github.io/2022/03/06/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/index.html">
<meta property="og:site_name" content="1_ynx&#39;s blog">
<meta property="og:description" content="[TOC] 一、网络安全概述1.1 计算机安全面临的挑战1.1.1 信息在处理、保存、传输中的安全威胁 窃听导致消息内容泄露 流量分析攻击 改写消息 攻击者假冒其他用户 拒绝服务攻击 重放攻击1.2 计算机安全的目标 CIA三元组： 机密性 完整性 可用性   其他： 认证和不可否认性（真实性） 可计量性：能够追踪安全违规的责任方1.3 计算机入侵的特点1.3.1 计算机入侵基本术语   计算系统">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105145936.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150004.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150025.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150827.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152406.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152735.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152803.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152858.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152927.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105153133.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105155238.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105160325.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE12.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE112.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201231130854.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105165006.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE138.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105213845.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210106002207.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210106002544.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE31.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210101154055.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-30-52.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-42-44.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-40-22.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-41-04.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-41-34.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-14-45-44.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-08-20-16-43.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-23-04.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-23-24.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-40-08.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-41-53.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-43-57.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-50-33.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-15-56-34.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-00-43.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-01-41.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-07-01.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-07-15.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-08-34.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-09-10.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-09-34.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-16-02-02.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-18-33-38.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-19-14-39.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-19-33-21.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-04-21-17-27.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-10-42-10.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-10-42-27.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-10-49-32.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-10-51-35.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-10-50-35.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-14-31-09.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-15-29-26.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-15-32-41.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-05-17-47-58.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-10-43-09.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-10-43-46.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-10-57-08.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-11-20-52.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-13-57-35.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-14-03-15.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-14-08-39.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-16-45-35.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-16-44-27.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-17-31-15.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-18-37-20.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-18-41-37.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-06-19-27-24.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-07-14-46-27.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-07-15-33-19.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-07-16-38-42.png">
<meta property="og:image" content="https://samarium-z.github.io/2021-12-07-16-43-23.png">
<meta property="article:published_time" content="2022-03-06T01:59:21.000Z">
<meta property="article:modified_time" content="2022-03-06T02:00:24.873Z">
<meta property="article:author" content="1_ynx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105145936.png">

<link rel="canonical" href="https://samarium-z.github.io/2022/03/06/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>网络安全 | 1_ynx's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">1_ynx's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">LIFE IS BUT A DREAMING...</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">3</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://samarium-z.github.io/2022/03/06/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="1_ynx">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="1_ynx's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          网络安全
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-06 09:59:21 / 修改时间：10:00:24" itemprop="dateCreated datePublished" datetime="2022-03-06T09:59:21+08:00">2022-03-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p>
<h1 id="一、网络安全概述"><a href="#一、网络安全概述" class="headerlink" title="一、网络安全概述"></a>一、网络安全概述</h1><h2 id="1-1-计算机安全面临的挑战"><a href="#1-1-计算机安全面临的挑战" class="headerlink" title="1.1 计算机安全面临的挑战"></a>1.1 计算机安全面临的挑战</h2><h3 id="1-1-1-信息在处理、保存、传输中的安全威胁"><a href="#1-1-1-信息在处理、保存、传输中的安全威胁" class="headerlink" title="1.1.1 信息在处理、保存、传输中的安全威胁"></a>1.1.1 信息在处理、保存、传输中的安全威胁</h3><ul>
<li>窃听导致消息内容泄露</li>
<li>流量分析攻击</li>
<li>改写消息</li>
<li>攻击者假冒其他用户</li>
<li>拒绝服务攻击</li>
<li>重放攻击<h2 id="1-2-计算机安全的目标"><a href="#1-2-计算机安全的目标" class="headerlink" title="1.2 计算机安全的目标"></a>1.2 计算机安全的目标</h2></li>
<li>CIA三元组：<ul>
<li>机密性</li>
<li>完整性</li>
<li>可用性</li>
</ul>
</li>
<li>其他：<ul>
<li>认证和不可否认性（真实性）</li>
<li>可计量性：能够追踪安全违规的责任方<h2 id="1-3-计算机入侵的特点"><a href="#1-3-计算机入侵的特点" class="headerlink" title="1.3 计算机入侵的特点"></a>1.3 计算机入侵的特点</h2><h3 id="1-3-1-计算机入侵基本术语"><a href="#1-3-1-计算机入侵基本术语" class="headerlink" title="1.3.1 计算机入侵基本术语"></a>1.3.1 计算机入侵基本术语</h3></li>
</ul>
</li>
<li>计算系统:硬件、软件、存储介质、数据、执行计算任务的人</li>
<li><strong>最易渗透原则</strong>:任何可能的入侵手段，没有必要针对安装有最可靠的防御系统。</li>
<li>所以安全专家必须考虑所有可能的入侵方式，系统入侵分析必须反复进行，尤其是当系统及安全措施发生变化时。</li>
<li>系统的脆弱点（ vulnerability)<br>计算机系统中的缺陷，能被攻击者所利用来破坏。(如访问没有身份鉴别)</li>
<li>威胁(threat)<br>能潜在引起系统损失和伤害的一些环境。人为机器误用、硬件设计缺陷、软件失效、自然灾害（洪水、地震)</li>
<li>攻击(attack)<br>利用脆弱点实施危害系统的行为</li>
<li>控制(countermeasure)<br>利用一些动作、装置、程序或技术消除或减少脆弱点<h4 id="威胁的四种类型"><a href="#威胁的四种类型" class="headerlink" title="威胁的四种类型"></a>威胁的四种类型</h4></li>
<li>截取(interception)<br>一些未授权方获得了访问资源的权利。（非法拷贝程序或数据文件、通过网络窃听wiretapping&gt;</li>
<li>中断( interruption)<br>系统资源丢失、不可得或不可用（硬件破坏、程序或数据文件被删除、操作系统文件管理器出现故障导致找不到所需磁盘文件)</li>
<li>篡改(modification)<br>不仅访问了资源，而且修改了内容。(修改了数据库的某些值、替换了某程序，修改硬件)</li>
<li>伪造(fabrication)<br>插入伪造的事务处理或向数据库加入记录</li>
</ul>
<h2 id="1-4-各类资源脆弱点及其基本防御方法"><a href="#1-4-各类资源脆弱点及其基本防御方法" class="headerlink" title="1.4 各类资源脆弱点及其基本防御方法"></a>1.4 各类资源脆弱点及其基本防御方法</h2><h3 id="1-4-1-硬件"><a href="#1-4-1-硬件" class="headerlink" title="1.4.1 硬件"></a>1.4.1 硬件</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105145936.png"></p>
<h3 id="1-4-2-软件"><a href="#1-4-2-软件" class="headerlink" title="1.4.2 软件"></a>1.4.2 软件</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150004.png"></p>
<h3 id="1-4-3-数据"><a href="#1-4-3-数据" class="headerlink" title="1.4.3 数据"></a>1.4.3 数据</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150025.png"></p>
<h3 id="1-4-4-传输介质"><a href="#1-4-4-传输介质" class="headerlink" title="1.4.4 传输介质"></a>1.4.4 传输介质</h3><ul>
<li><p>脆弱点：</p>
<ul>
<li>数据信息泄露<br>  移动通信数据传输采用无线网络接入服务器、客户端, 无线网络采用的传输介质包括微波、中波、短波等电磁波, 这些波段覆盖的频率不同, 非常容易被攻击者窃听, 造成数据丢失, 非法用户篡改移动通信数据, 比如操作日志、服务器信息等, 不利于移动通信数据的正常传输。另外, 在传输移动通信数据的过程中, 许多的攻击者利用伪装基站或AP截取信息, 盗取用户发送的信息或篡改用户信息,从而破坏了信息的完整性。</li>
<li>泛洪攻击<br>  攻击者发送海量的数据和信令, 造成移动通信网络中存在大量的数据内容, 从而堵塞传输设备, 降低了无线通信资源的浪费, 导致移动设备无线通信存在很高的掉话</li>
<li>盗用移动通信设备IP<br>  攻击者盗用移动通信设备IP, 可以注册请求信息, 并且向宿主网络发出篡改注册请求信息, 以攻击者的IP地址代替用户相关的转交地址, 攻击者就可以冒用其他用户的IP地址隐藏自己的身份, 并且给网络注册、追踪溯源和安全审计审查带来了严重的负面影响。另外, 移动通信设备在运行过程中, 由于设备自身工作的环境的较为复杂, 因此移动设备通常容易产生故障或问题, 设备供电电源采用冗余配置, 为了能够突出运行软件进行自行更新, 因此需要及时的对设备进行更换、定期运行维护, 以便保证设备的安全性。</li>
</ul>
</li>
<li><p>防御策略：</p>
<ul>
<li>接入网安全防御措施研究<br>  移动通信系统具有高辐射性, 空中接口受到的安全威胁较大, 攻击者容易通过无线链路截取传输信息, 破坏信息完整性, 因此拟采用安全加密和传输算法保证接入网安全, 同时引入先进的状态检测、深度包过滤等技术, 提高接入网安全性能。状态检测可以根据网络中传输的数据流感知上下文信息, 构建一个完善的网络连接, 分析和删除网络的内容, 从而确认TCP协议中包含的网络数据状态内容, 状态检测技术可以通过TCP数据包中的标识位信息确定连接状态, 从而构建一个动态的状态表项, 控制TCP连接中的数据传输内容, 从而发现不正常的网络流量内容, 进而可以控制移动通信外部侵扰。入侵检测是移动通信系统核心网防御系统不可或缺的组成部分, 其可以部署在防火墙、访问控制列表中, 能够实时地采集网络中的流量数据, 对其进行分析、识别和处理, 及时发现不正常的数据包。深度包过滤是一种强大的入侵检测技术, 其可以分析移动通信数据发送的端口号、IP地址、通信协议类型、TCP标志位等信息, 可以从根本上穿透网络协议内容, 分析数据包内的所有信息, 完成信息过滤需求, 从而发现病毒、木马等不安全信息。状态检测和深度包过滤可以集成在一起, 实现移动通信系统接入网安全防御功能, 进一步保障移动通信系统的使用。</li>
<li>核心网安全防御措施研究<br>  移动通信系统的核心网主要是ATM、移动IP网两个类型, 因此可以针对这些网络采用先进的多层次融合安全防御技术, 提高系统安全性。融合技术主要包括安全保护、安全预警等技术。移动通信系统安全保护技术较多, 比如防火墙、360杀毒软件、卡巴斯基木马查杀软件等;安全预警技术主要包括漏洞预警、行为预警和攻击趋势预警。为了提高安全保护能力, 将多种网络安全防御技术整合在一起, 利用安全预警、安全保护技术构建了一个多层次、主动式的防御系统, 实现核心网病毒、木马查杀,避免核心网木马和病毒蔓延, 防止移动通信系统被攻击和感染, 扰乱移动通信系统正常使用。<h2 id="1-5-黑客"><a href="#1-5-黑客" class="headerlink" title="1.5 黑客"></a>1.5 黑客</h2><h3 id="1-5-1-黑客的发展史"><a href="#1-5-1-黑客的发展史" class="headerlink" title="1.5.1 黑客的发展史"></a>1.5.1 黑客的发展史</h3>最早的计算机于1946年在宾夕法尼亚大学诞生，而最早的黑客出现于麻省理工学院。贝尔实验室也有。最初的黑客一般都是一些高级的技术人员，他们热衷于挑战、崇尚自由并主张信息的共享。<br>1994年以来，因特网在中国乃至世界的迅猛发展，为人们提供了方便、自由和无限的财富。政治、军事、经济、科技、教育、文化等各个方面都越来越网络化，并且逐渐成为人们生活、娱乐的一部分。可以说，信息时代已经到来，信息已成为物质和能量以外维持人类社会的第三资源，它是未来生活中的重要介质。而随着计算机的普及和因特网技术的迅速发展，黑客也随之出现了。<h3 id="1-5-2-黑客的目的"><a href="#1-5-2-黑客的目的" class="headerlink" title="1.5.2 黑客的目的"></a>1.5.2 黑客的目的</h3><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105150827.png"><h3 id="1-5-3-著名黑客"><a href="#1-5-3-著名黑客" class="headerlink" title="1.5.3 著名黑客"></a>1.5.3 著名黑客</h3>见PPT<h3 id="1-5-4-黑客的技术要求"><a href="#1-5-4-黑客的技术要求" class="headerlink" title="1.5.4 黑客的技术要求"></a>1.5.4 黑客的技术要求</h3></li>
</ul>
</li>
<li><p>口令猜测</p>
</li>
<li><p>编写自我复制的代码</p>
</li>
<li><p>口令破解</p>
</li>
<li><p>利用已知漏洞</p>
</li>
<li><p>使审计失效</p>
</li>
<li><p>后门</p>
</li>
<li><p>会话劫持</p>
</li>
<li><p>清理器（sweepers）</p>
</li>
<li><p>嗅探器</p>
</li>
<li><p>隐形诊断</p>
</li>
<li><p>包欺骗</p>
</li>
</ul>
<h2 id="1-6-网络攻击事件举例"><a href="#1-6-网络攻击事件举例" class="headerlink" title="1.6 网络攻击事件举例"></a>1.6 网络攻击事件举例</h2><h3 id="1-6-1-海湾战争"><a href="#1-6-1-海湾战争" class="headerlink" title="1.6.1 海湾战争"></a>1.6.1 海湾战争</h3><p>看PPT</p>
<h3 id="1-6-2-震网"><a href="#1-6-2-震网" class="headerlink" title="1.6.2 震网"></a>1.6.2 震网</h3><p>看PPT</p>
<h2 id="1-7-新的攻击手段与趋势"><a href="#1-7-新的攻击手段与趋势" class="headerlink" title="1.7 新的攻击手段与趋势"></a>1.7 新的攻击手段与趋势</h2><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152406.png"></p>
<ul>
<li>bot牧民：是黑客，他们使用自动化技术扫描特定的网络范围，并找到要在其上安装其bot程序的易受攻击的系统，例如没有最新安全修补程序的机器。然后，受感染的计算机已成为僵尸网络中的许多僵尸之一，并通常通过Internet中继聊天通道对僵尸网络蠕虫发出的命令做出响应。</li>
</ul>
<h2 id="1-8-安全的相关标准"><a href="#1-8-安全的相关标准" class="headerlink" title="1.8 安全的相关标准"></a>1.8 安全的相关标准</h2><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152735.png"></p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152803.png"></p>
<h2 id="1-9-信息安全研究的内容"><a href="#1-9-信息安全研究的内容" class="headerlink" title="1.9 信息安全研究的内容"></a>1.9 信息安全研究的内容</h2><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152858.png"></p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105152927.png"></p>
<h1 id="二、密码学、密钥分配"><a href="#二、密码学、密钥分配" class="headerlink" title="二、密码学、密钥分配"></a>二、密码学、密钥分配</h1><h2 id="2-1-密码学的基本概念"><a href="#2-1-密码学的基本概念" class="headerlink" title="2.1 密码学的基本概念"></a>2.1 密码学的基本概念</h2><h3 id="2-1-1-密码算法的表示"><a href="#2-1-1-密码算法的表示" class="headerlink" title="2.1.1 密码算法的表示"></a>2.1.1 密码算法的表示</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105153133.png"></p>
<h3 id="2-1-2-密码算法的分类"><a href="#2-1-2-密码算法的分类" class="headerlink" title="2.1.2 密码算法的分类"></a>2.1.2 密码算法的分类</h3><ul>
<li>对称密钥<ul>
<li>分组加密</li>
<li>流加密</li>
</ul>
</li>
<li>公钥（非对称密钥）</li>
</ul>
<h2 id="2-2-典型的加密方法"><a href="#2-2-典型的加密方法" class="headerlink" title="2.2 典型的加密方法"></a>2.2 典型的加密方法</h2><ul>
<li>替换</li>
<li>一次一密</li>
<li>置换</li>
</ul>
<h2 id="2-3-对称密钥标准DES、3DES、AES"><a href="#2-3-对称密钥标准DES、3DES、AES" class="headerlink" title="2.3 对称密钥标准DES、3DES、AES"></a>2.3 对称密钥标准DES、3DES、AES</h2><h3 id="2-3-1-DES"><a href="#2-3-1-DES" class="headerlink" title="2.3.1 DES"></a>2.3.1 DES</h3><h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><p>见书&#x2F;PPT</p>
<h4 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h4><ul>
<li>算法本身：没有致命缺陷</li>
<li>56bit密钥长度：超级计算机穷举攻击可以在1小时内找到正确密钥</li>
</ul>
<h3 id="2-3-2-3DES"><a href="#2-3-2-3DES" class="headerlink" title="2.3.2 3DES"></a>2.3.2 3DES</h3><h4 id="算法-1"><a href="#算法-1" class="headerlink" title="算法"></a>算法</h4><p>见书&#x2F;PPT</p>
<h4 id="安全性-1"><a href="#安全性-1" class="headerlink" title="安全性"></a>安全性</h4><ul>
<li>算法本身：没有致命缺陷</li>
<li>168bit密钥长度：穷举攻击不可行</li>
</ul>
<h3 id="2-3-3-AES"><a href="#2-3-3-AES" class="headerlink" title="2.3.3 AES"></a>2.3.3 AES</h3><h4 id="算法-2"><a href="#算法-2" class="headerlink" title="算法"></a>算法</h4><p>见书&#x2F;PPT</p>
<h4 id="安全性-2"><a href="#安全性-2" class="headerlink" title="安全性"></a>安全性</h4><p>支持的三种密钥长度都不可穷举攻击</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105155238.png"></p>
<h2 id="2-4-公开密钥标准RSA、Diffie-Hellman"><a href="#2-4-公开密钥标准RSA、Diffie-Hellman" class="headerlink" title="2.4 公开密钥标准RSA、Diffie-Hellman"></a>2.4 公开密钥标准RSA、Diffie-Hellman</h2><h3 id="2-4-1-RSA"><a href="#2-4-1-RSA" class="headerlink" title="2.4.1 RSA"></a>2.4.1 RSA</h3><h4 id="算法-3"><a href="#算法-3" class="headerlink" title="算法"></a>算法</h4><p>见书&#x2F;PPT</p>
<h4 id="安全性-3"><a href="#安全性-3" class="headerlink" title="安全性"></a>安全性</h4><p>若破译者能对公开的n作因子分解，找出p和q，就可得出z，由z和e可以得到d<br>对大数的因式分解极其困难，对200位数分解因子需40亿年。所以RSA算法被广泛使用。</p>
<h3 id="2-4-2-Diffie-Hellman"><a href="#2-4-2-Diffie-Hellman" class="headerlink" title="2.4.2 Diffie-Hellman"></a>2.4.2 Diffie-Hellman</h3><h4 id="算法-4"><a href="#算法-4" class="headerlink" title="算法"></a>算法</h4><p>见书&#x2F;PPT</p>
<h4 id="安全性-4"><a href="#安全性-4" class="headerlink" title="安全性"></a>安全性</h4><ul>
<li>水桶队列攻击（没查到是什么）</li>
<li>中间人攻击</li>
</ul>
<h2 id="2-5-哈希与认证码"><a href="#2-5-哈希与认证码" class="headerlink" title="2.5 哈希与认证码"></a>2.5 哈希与认证码</h2><h3 id="2-5-1-哈希函数的特点"><a href="#2-5-1-哈希函数的特点" class="headerlink" title="2.5.1 哈希函数的特点"></a>2.5.1 哈希函数的特点</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105160325.png"></p>
<h3 id="2-5-2-哈希函数的应用"><a href="#2-5-2-哈希函数的应用" class="headerlink" title="2.5.2 哈希函数的应用"></a>2.5.2 哈希函数的应用</h3><ul>
<li>口令文件中存放的口令形式</li>
<li>数字签名</li>
<li>数据完整性</li>
<li>带密钥的哈希用于消息认证（消息认证码HMAC）</li>
</ul>
<h3 id="2-5-3-消息认证码HMAC的原理"><a href="#2-5-3-消息认证码HMAC的原理" class="headerlink" title="2.5.3 消息认证码HMAC的原理"></a>2.5.3 消息认证码HMAC的原理</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE12.png"></p>
<h3 id="2-5-4-HMAC的作用"><a href="#2-5-4-HMAC的作用" class="headerlink" title="2.5.4 HMAC的作用"></a>2.5.4 HMAC的作用</h3><h4 id="消息完整性认证"><a href="#消息完整性认证" class="headerlink" title="消息完整性认证"></a>消息完整性认证</h4><p>能够证明消息内容在传送过程没有被修改</p>
<h4 id="信源身份认证"><a href="#信源身份认证" class="headerlink" title="信源身份认证"></a>信源身份认证</h4><p>因为通信双方共享了认证的密钥，接收方能够认证发送该数据的信源与所宣称的一致，即能够可靠地确认接收的消息与发送的一致。</p>
<h2 id="2-6-密钥分配和用户认证的作用"><a href="#2-6-密钥分配和用户认证的作用" class="headerlink" title="2.6 密钥分配和用户认证的作用"></a>2.6 密钥分配和用户认证的作用</h2><h3 id="2-6-1-会话密钥的作用"><a href="#2-6-1-会话密钥的作用" class="headerlink" title="2.6.1 会话密钥的作用"></a>2.6.1 会话密钥的作用</h3><p>会话密钥，是一次性用于会话中加密用的对称式密钥，所有成员使用同一把密钥来加密明文、解密密文，在此次连接结束该密钥即无效</p>
<h2 id="2-7-基于对称加密的密钥分配；Kerberos认证"><a href="#2-7-基于对称加密的密钥分配；Kerberos认证" class="headerlink" title="2.7 基于对称加密的密钥分配；Kerberos认证"></a>2.7 基于对称加密的密钥分配；Kerberos认证</h2><h3 id="2-7-1-Kerberos认证适用场景"><a href="#2-7-1-Kerberos认证适用场景" class="headerlink" title="2.7.1 Kerberos认证适用场景"></a>2.7.1 Kerberos认证适用场景</h3><p>Kerberos是一种用于分布式鉴别的认证服务。适用于<strong>分布式环境</strong>中，用户希望访问分布在网络各处的服务器上的服务，但各个组件之间的相互通信不能够简单的互通，而需要在通信之前进行相互认证，以确保通信的安全性。</p>
<h3 id="2-7-2-AS、TGS、V之间的关系"><a href="#2-7-2-AS、TGS、V之间的关系" class="headerlink" title="2.7.2 AS、TGS、V之间的关系"></a>2.7.2 AS、TGS、V之间的关系</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE112.png"></p>
<h3 id="2-7-3-Kerberos安全性"><a href="#2-7-3-Kerberos安全性" class="headerlink" title="2.7.3 Kerberos安全性"></a>2.7.3 Kerberos安全性</h3><p>Kerberos面临的安全威胁：</p>
<ul>
<li>kerberos不能解决拒绝服务攻击</li>
<li>入侵者通过某种方法窃取了主体的私钥，他就能冒充身份</li>
<li>Kerberos无法应付口令猜测攻击</li>
<li>要保证网络上每个主机时钟都是松散同步的（票据有生存时间限制）</li>
<li>要保证主体的标识不能频繁地循环使用</li>
</ul>
<h2 id="2-8-基于非对称加密的密钥分配"><a href="#2-8-基于非对称加密的密钥分配" class="headerlink" title="2.8 基于非对称加密的密钥分配"></a>2.8 基于非对称加密的密钥分配</h2><p>当B想要发消息给A的时候，需要让A知道他们之间的会话密钥，这时候可以用公钥来分发：</p>
<ul>
<li>使用一次性&amp;&amp;传统的&amp;&amp;会话密钥，加密消息 </li>
<li>用A的公钥加密会话密钥</li>
<li>把加密后的会话密钥和加密后的消息放在一起送给A</li>
</ul>
<h2 id="2-9-X-509证书"><a href="#2-9-X-509证书" class="headerlink" title="2.9 X.509证书"></a>2.9 X.509证书</h2><h3 id="2-9-1-证书包含的内容"><a href="#2-9-1-证书包含的内容" class="headerlink" title="2.9.1 证书包含的内容"></a>2.9.1 证书包含的内容</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201231130854.png"></p>
<h3 id="2-9-2-如何验证相应的证书"><a href="#2-9-2-如何验证相应的证书" class="headerlink" title="2.9.2 如何验证相应的证书"></a>2.9.2 如何验证相应的证书</h3><ul>
<li>用户向服务器提出访问请求时，用户递交数字证书；</li>
<li>服务器利用CA公钥对CA签名解密,得到散列码</li>
<li>同时对证书信息部分用同样散列算法得到散列结果，与解密结果比较。相同则通过身份认证.</li>
</ul>
<h2 id="2-10-公钥基础设施KPI"><a href="#2-10-公钥基础设施KPI" class="headerlink" title="2.10 公钥基础设施KPI"></a>2.10 公钥基础设施KPI</h2><h3 id="2-10-1-PKI中CA的作用"><a href="#2-10-1-PKI中CA的作用" class="headerlink" title="2.10.1 PKI中CA的作用"></a>2.10.1 PKI中CA的作用</h3><p>检查证书持有者身份的合法性，并签发证书，以防证书被伪造或篡改。</p>
<ul>
<li>用自己的私钥签发证书</li>
<li>提供证书查询</li>
<li>接受证书注销请求</li>
<li>提供证书注销表</li>
</ul>
<h3 id="2-10-2-CA之间的信任关系"><a href="#2-10-2-CA之间的信任关系" class="headerlink" title="2.10.2 CA之间的信任关系"></a>2.10.2 CA之间的信任关系</h3><ul>
<li>层次结构信任模型<br><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105165006.png"></li>
<li>分布式信任模型<br><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE138.png"></li>
</ul>
<h1 id="三、用户认证"><a href="#三、用户认证" class="headerlink" title="三、用户认证"></a>三、用户认证</h1><h2 id="3-1-认证的一般方法"><a href="#3-1-认证的一般方法" class="headerlink" title="3.1 认证的一般方法"></a>3.1 认证的一般方法</h2><h3 id="3-1-1-认证采用的一般方法"><a href="#3-1-1-认证采用的一般方法" class="headerlink" title="3.1.1 认证采用的一般方法"></a>3.1.1 认证采用的一般方法</h3><ul>
<li>口令认证：密码等</li>
<li>令牌认证：所有物，如银行卡等</li>
<li>生物特征认证：声音、指纹等</li>
</ul>
<h3 id="3-1-2-口令认证面临的威胁"><a href="#3-1-2-口令认证面临的威胁" class="headerlink" title="3.1.2 口令认证面临的威胁"></a>3.1.2 口令认证面临的威胁</h3><ul>
<li>字典攻击</li>
<li>彩虹表攻击</li>
<li>特定账号猜口令</li>
<li>常用密码字典攻击</li>
<li>根据用户信息+系统口令规则猜口令</li>
<li>工作站劫持</li>
<li>利用用户犯的错</li>
<li>利用用户的“一个密码多用”</li>
<li>电子监视</li>
</ul>
<h3 id="3-1-3-Unix口令存储方式"><a href="#3-1-3-Unix口令存储方式" class="headerlink" title="3.1.3 Unix口令存储方式"></a>3.1.3 Unix口令存储方式</h3><p>见书P290</p>
<p>传统的UNIX身份鉴别即口令认证方式，它主要通过识别用户的用户名或者UID号获取在&#x2F;etc&#x2F;shadow中存放的对应用户密码密文等信息，然后获取用户输入密码并采用crypt()函数对获得的输入密码进行加密，当然加密方式是与原用户密码的加密方式是一致的，然后将这两个密文进行比较，如果一致则通过验证，如果不一致则拒绝赋予权限。</p>
<h2 id="3-2-远程认证"><a href="#3-2-远程认证" class="headerlink" title="3.2 远程认证"></a>3.2 远程认证</h2><h3 id="3-2-1-远程认证中需要解决的问题"><a href="#3-2-1-远程认证中需要解决的问题" class="headerlink" title="3.2.1 远程认证中需要解决的问题"></a>3.2.1 远程认证中需要解决的问题</h3><ul>
<li>直接传递用户名和口令，容易遭受窃听、重放攻击</li>
<li>容易被暴力破解</li>
</ul>
<h3 id="3-2-2-构造一次性动态口令的方法"><a href="#3-2-2-构造一次性动态口令的方法" class="headerlink" title="3.2.2 构造一次性动态口令的方法"></a>3.2.2 构造一次性动态口令的方法</h3><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210105213845.png"></p>
<h3 id="3-2-3-挑战应答非同步认证的一般原理"><a href="#3-2-3-挑战应答非同步认证的一般原理" class="headerlink" title="3.2.3 挑战应答非同步认证的一般原理"></a>3.2.3 挑战应答非同步认证的一般原理</h3><p>顾名思义，基于挑战&#x2F;应答（Challenge&#x2F;Response）方式的身份认证系统就是每次认证时认证服务器端都给客户端发送一个不同的”挑战”字串，客户端程序收到这个”挑战”字串后，做出相应的”应答”,以此机制而研制的系统.认证过程为：</p>
<ul>
<li>客户向认证服务器发出请求，要求进行身份认证；给服务器发送自己的ID</li>
<li>认证服务器从用户数据库中查询该ID是否是合法的用户，若不是，则不做进一步处理；</li>
<li>认证服务器内部产生一个随机数，作为”提问”，发送给客户；</li>
<li>客户按照<code>F(R,H(p))</code>生成一个字节串作为应答，其中f和h都是函数，r是随机数，p是用户口令</li>
<li>认证服务器将应答串与自己的计算结果比较，若二者相同，则通过一次认证；否则，认证失败；</li>
<li>认证服务器通知客户认证成功或失败。</li>
</ul>
<p>以后的认证由客户不定时地发起，过程中没有了客户认证请求一步。两次认证的时间间的密钥隔不能太短，否则就给网络、客户和认证服务器带来太大的开销；也不能太长，否则不能保证用户不被他人盗用IP地址，一般定为1-2分钟。</p>
<h3 id="3-2-4-挑战应答非同步认证的安全性"><a href="#3-2-4-挑战应答非同步认证的安全性" class="headerlink" title="3.2.4 挑战应答非同步认证的安全性"></a>3.2.4 挑战应答非同步认证的安全性</h3><p>密码不显示为通过网络发送的明文，这只是加强了安全性，但并不能完全阻止黑客破坏。挑战应答认证在一定情况下还是会被攻击，比如未验证黑客身份为超级用户。这就使得黑客有可能使用拒绝服务性的攻击方式，使得授权用户不能通过认证。</p>
<h2 id="3-3-与远程认证相关的技术"><a href="#3-3-与远程认证相关的技术" class="headerlink" title="3.3 与远程认证相关的技术"></a>3.3 与远程认证相关的技术</h2><h3 id="3-3-1-TCP序列号"><a href="#3-3-1-TCP序列号" class="headerlink" title="3.3.1 TCP序列号"></a>3.3.1 TCP序列号</h3><p>没找到QWQ</p>
<h3 id="3-3-2-DNS"><a href="#3-3-2-DNS" class="headerlink" title="3.3.2 DNS"></a>3.3.2 DNS</h3><h4 id="DNSSEC"><a href="#DNSSEC" class="headerlink" title="DNSSEC"></a>DNSSEC</h4><p>DNSSEC 在 DNS 协议中新增了两项重要功能：</p>
<ul>
<li>数据来源验证：解析器可以通过加密的方式验证收到的数据是否确实来自其认定的数据传送区域。</li>
<li>数据完整性保护：解析器可以确信，自区域所有者使用区域私钥初次进行数据签名以来，数据在传输过程中并未遭到修改</li>
</ul>
<p>其中数据来源验证也就是与远程认证相关的技术</p>
<h3 id="3-3-3-HTTP"><a href="#3-3-3-HTTP" class="headerlink" title="3.3.3 HTTP"></a>3.3.3 HTTP</h3><h4 id="基本认证"><a href="#基本认证" class="headerlink" title="基本认证"></a>基本认证</h4><p>将用户名追加一个冒号(‘:’)，接上密码，把得出的结果字符串再用Base64算法编码</p>
<h4 id="摘要认证"><a href="#摘要认证" class="headerlink" title="摘要认证"></a>摘要认证</h4><p>一方先发认证要求给另一方，接着使用从另一方面收到的质询码生成响应码</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210106002207.png"></p>
<h4 id="OAuth认证"><a href="#OAuth认证" class="headerlink" title="OAuth认证"></a>OAuth认证</h4><p>OAuth允许用户提供一个令牌，而不是用户名和密码来访问他们存放在特定服务提供者的数据。每一个令牌授权一个特定的第三方系统（例如，视频编辑网站)在特定的时段（例如，接下来的2小时内）内访问特定的资源（例如仅仅是某一相册中的视频）。这样，OAuth让用户可以授权第三方网站访问他们存储在另外服务提供者的某些特定信息，而非所有内容</p>
<h4 id="Cookie认证"><a href="#Cookie认证" class="headerlink" title="Cookie认证"></a>Cookie认证</h4><p>Cookie认证机制就是为一次请求认证在服务端创建一个Session对象，同时在客户端的浏览器端创建了一个Cookie对象；通过客户端带上来Cookie对象来与服务器端的session对象匹配来实现状态管理的。默认的，当我们关闭浏览器的时候，cookie会被删除。但可以通过修改cookie 的expire time使cookie在一定时间内有效；</p>
<h4 id="Token认证"><a href="#Token认证" class="headerlink" title="Token认证"></a>Token认证</h4><p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210106002544.png"></p>
<h3 id="3-3-4-SSL"><a href="#3-3-4-SSL" class="headerlink" title="3.3.4 SSL"></a>3.3.4 SSL</h3><p>使用证书的请求与验证来实现认证：</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/%E7%BB%98%E5%9B%BE31.png"></p>
<h3 id="3-3-5-SSH"><a href="#3-3-5-SSH" class="headerlink" title="3.3.5 SSH"></a>3.3.5 SSH</h3><p>认证流程如下：</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20210101154055.png"></p>
<h1 id="四、网络协议缺陷"><a href="#四、网络协议缺陷" class="headerlink" title="四、网络协议缺陷"></a>四、网络协议缺陷</h1><h2 id="4-1-Internet网络协议基本的安全问题"><a href="#4-1-Internet网络协议基本的安全问题" class="headerlink" title="4.1 Internet网络协议基本的安全问题"></a>4.1 Internet网络协议基本的安全问题</h2><ul>
<li>TCP的状态容易猜测——导致包欺骗和会话劫持</li>
<li>拒绝服务问题（Dos）——如SYN 泛洪DOS攻击（SYN Flooding），TCP RST攻击等</li>
<li>网络数据包经过不可信的主机——包窃听、包嗅探</li>
</ul>
<h2 id="4-2-路由的漏洞"><a href="#4-2-路由的漏洞" class="headerlink" title="4.2 路由的漏洞"></a>4.2 路由的漏洞</h2><blockquote>
<p>共性：广播虚假的路由消息</p>
</blockquote>
<h3 id="4-2-1-ARP欺骗过程"><a href="#4-2-1-ARP欺骗过程" class="headerlink" title="4.2.1 ARP欺骗过程"></a>4.2.1 ARP欺骗过程</h3><ul>
<li>主机A、B都洪泛了ARP Request.攻击者C现在有了两台主机的IP、MAC地址，开始攻击。攻击者发送一个ARP Reply给主机B，把此包protocol header里的sender IP设为A的IP地址，sender mac设为攻击者自己的MAC地址。</li>
<li>主机B收到ARP Reply后，更新它的ARP表，把主机A的MAC地址（IP_A, MAC_A）改为（IP_A, MAC_C）。</li>
<li>当主机B要发送数据包给主机A时，它根据ARP表来封装数据包的Link报头，把目的MAC地址设为MAC_C，而非MAC_A。</li>
<li>当交换机收到B发送给A的数据包时，根据此包的目的MAC地址（MAC_C）而把数据包转发给攻击者C。</li>
<li>攻击者收到数据包后，可以把它存起来后再发送给A，达到窃听效果。攻击者也可以篡改数据后才发送数据包给A，造成伤害</li>
</ul>
<h3 id="4-2-2-BGP协议"><a href="#4-2-2-BGP协议" class="headerlink" title="4.2.2 BGP协议"></a>4.2.2 BGP协议</h3><h4 id="BGP劫持简介"><a href="#BGP劫持简介" class="headerlink" title="BGP劫持简介"></a>BGP劫持简介</h4><p>BGP劫持是指攻击者恶意改变互联网流量的路由。攻击者通过错误地宣布他们实际上并不拥有、控制或路由的IP地址组(称为IP前缀)的所有权来实现这一点。BGP劫持很像是有人在高速公路上改变所有的标志，将汽车指向错误的出口。</p>
<p>当AS宣布它实际上不控制的IP前缀的路由时，该公告（如果未被过滤）可以传播并被添加到因特网上的BGP路由器中的路由表。从那时起，直到有人注意到并纠正路由之前，这些IP的流量将被路由到该AS。</p>
<h4 id="BGP劫持要求"><a href="#BGP劫持要求" class="headerlink" title="BGP劫持要求"></a>BGP劫持要求</h4><p>BGP始终支持所需IP地址的最快最详细的的路径。所以为了使BGP劫持成功，路由公告必须：</p>
<ul>
<li>提供一个更具体的路线，宣布一个较小的范围的IP地址，且比其他AS先宣布</li>
<li>为某些IP地址块提供更短的路由</li>
</ul>
<h2 id="4-3-DNS系统的安全问题"><a href="#4-3-DNS系统的安全问题" class="headerlink" title="4.3 DNS系统的安全问题"></a>4.3 DNS系统的安全问题</h2><p>由于DNS本身的设计缺陷，没有提供适当的信息保护和认证机制，使得DNS很容易受到攻击。比如DNS Spoofing(DNS欺骗)、Cache Poisoing(缓存中毒)，Server Compromising(服务器中毒)，DoS。DNS Spoofing(DNS欺骗)、Cache Poisoing(缓存中毒)是其中最容易实现，且危害最大的两个攻击。</p>
<h3 id="4-3-1-DNS缓存中毒"><a href="#4-3-1-DNS缓存中毒" class="headerlink" title="4.3.1 DNS缓存中毒"></a>4.3.1 DNS缓存中毒</h3><h4 id="4-3-1-1-攻击原理"><a href="#4-3-1-1-攻击原理" class="headerlink" title="4.3.1.1 攻击原理"></a>4.3.1.1 攻击原理</h4><p>DNS缓存中毒通过欺骗DNS服务器保存伪造的DNS条目来起作用。伪造的DNS条目的流量流向选择窃取数据的攻击者的服务器。</p>
<ol>
<li>攻击者植入假的地址到DNS;</li>
<li>服务器缓存假地址;</li>
<li>流量被牵引到攻击者服务器。<h4 id="4-3-1-2-常用技术手段"><a href="#4-3-1-2-常用技术手段" class="headerlink" title="4.3.1.2 常用技术手段"></a>4.3.1.2 常用技术手段</h4></li>
</ol>
<ul>
<li>Birthday Attack</li>
</ul>
<p>DNS不会验证对递归查询的响应，因此第一个响应存储在缓存中。攻击者使用“Birthday Attack”来尝试预测伪造的响应并将其发送给请求者。BirthdayAttack使用数学和概率论进行猜测。在这种情况下，攻击者试图猜测您的DNS请求的事务ID，因此带有伪造的DNS条目的伪造响应会在真正响应之前到达您。</p>
<p>Birthday Attack不一定能成功，但最终，攻击者会将伪造的响应偷偷溜进缓存。一旦攻击确实成功，攻击者将看到来自伪造的DNS条目的流量，直到生存时间(TTL)到期为止。</p>
<ul>
<li>Kaminsky漏洞</li>
</ul>
<p>Kaminsky漏洞利用是BlackHat 2008上提出的Birthday Attack的一种变体。首先，攻击者向目标解析器发送不存在域的DNS查询，例如“fake.dingxinsec.com.cn”。然后，解析程序将查询转发到权威名称服务器，以获取错误子域的IP地址。此时，攻击者向解析器注入了大量伪造的响应，希望这些伪造之一与原始查询的事务ID相匹配。</p>
<p>如果攻击成功，则攻击者已使用<a target="_blank" rel="noopener" href="http://dingxinsec.com.cn的伪造ip地址毒害了目标解析器的dns缓存.直到ttl为止,请求http//dingxinsec.com.cn%E7%9A%84%E4%BA%BA%E9%83%BD%E5%B0%86%E8%8E%B7%E5%BE%97%E4%BC%AA%E9%80%A0%E7%9A%84IP%E5%9C%B0%E5%9D%80%E3%80%82">http://dingxinsec.com.cn的伪造IP地址毒害了目标解析器的DNS缓存。直到TTL为止，请求http://dingxinsec.com.cn的人都将获得伪造的IP地址。</a></p>
<ul>
<li>窃听</li>
</ul>
<p>攻击者如果有足够的网络访问权限，就可以监视本地DNS流量并使用多种技术手段破坏缓存。</p>
<h4 id="4-3-1-3-防御"><a href="#4-3-1-3-防御" class="headerlink" title="4.3.1.3 防御"></a>4.3.1.3 防御</h4><ul>
<li>除了监视和分析之外，还可以在DNS服务器上进行配置更改。</li>
<li>限制递归查询以防止潜在的有针对性的中毒攻击</li>
<li>仅存储与请求域相关的数据</li>
<li>限制响应以仅提供有关请求域的响应</li>
<li>强制客户端使用HTTPS</li>
<li>请确保您使用的是BIND和DNS软件的最新版本，以便您具有最新的安全修复程序。</li>
<li>最后，DNSSEC是一种新的DNS协议，可对DNS请求进行加密以防止伪造。该协议尚未得到广泛采用，因为它确实会减慢DNS进程。HTTPS上的DNS(DoH)是下一版本DNS的竞争规范，可以在不牺牲DNSSEC之类的速度的情况下确保DNS请求的安全。</li>
</ul>
<h3 id="4-3-2-DNS重新绑定攻击"><a href="#4-3-2-DNS重新绑定攻击" class="headerlink" title="4.3.2 DNS重新绑定攻击"></a>4.3.2 DNS重新绑定攻击</h3><p>DNS重新绑定允许远程攻击者绕过受害者的网络防火墙，并使用其Web浏览器作为代理，直接与其私有家庭网络上的设备进行通信。</p>
<h4 id="4-3-2-1-攻击流程"><a href="#4-3-2-1-攻击流程" class="headerlink" title="4.3.2.1 攻击流程"></a>4.3.2.1 攻击流程</h4><ol>
<li>攻击者控制恶意的DNS服务器来回复域的查询,如rebind.network</li>
<li>攻击者通过一些方式诱导受害者加载<a target="_blank" rel="noopener" href="http://rebind.network/">http://rebind.network</a></li>
<li>用户打开链接,浏览器就会发出DNS请求查找rebind.network的IP地址</li>
<li>恶意DNS服务器收到受害者的请求,并使用真实IP地址进行响应,并将TTL值设置为1秒,让受害者的机器缓存很快失效</li>
<li>从<a target="_blank" rel="noopener" href="http://rebind.network加载的网页包含恶意的js代码,构造恶意的请求到http//rebind.network/index,%E8%80%8C%E5%8F%97%E5%AE%B3%E8%80%85%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BE%BF%E5%9C%A8%E6%89%A7%E8%A1%8C%E6%81%B6%E6%84%8F%E8%AF%B7%E6%B1%82">http://rebind.network加载的网页包含恶意的js代码,构造恶意的请求到http://rebind.network/index,而受害者的浏览器便在执行恶意请求</a></li>
<li>一开始的恶意请求当然是发到了攻击者的服务器上,但是随着TTL时间结束,攻击者就可以让<a target="_blank" rel="noopener" href="http://rebind.network绑定到别的ip,如果能捕获受害者的一些放在内网的应用ip地址,就可以针对这个内网应用构造出对应的恶意请求,然后浏览器执行的恶意请求就发送到了内网应用,达到了攻击的效果/">http://rebind.network绑定到别的IP,如果能捕获受害者的一些放在内网的应用IP地址,就可以针对这个内网应用构造出对应的恶意请求,然后浏览器执行的恶意请求就发送到了内网应用,达到了攻击的效果</a><h4 id="4-3-2-2-防御"><a href="#4-3-2-2-防御" class="headerlink" title="4.3.2.2 防御"></a>4.3.2.2 防御</h4></li>
<li><strong>向你的HTTP服务器添加“主机”标头验证</strong>。此标头包含在从现代浏览器发送的所有HTTP请求中，它包含期望与之通信的服务器的主机（主机名：端口）。此值可以是域名或IP地址，但无论哪种方式，接收请求的服务器都应验证其自己的主机是否与所请求的主机匹配。由于DNS重新绑定依赖于与域名关联的基础IP地址的更改，重绑定到目标服务的恶意HTTP请求中的Host头会保持原始的域名。对路由器登录页面的恶意POST请求将具有与你在路由器上的主机名或IP地址不匹配的主机标头值。它看起来像Host：malicious.website。</li>
<li><strong>破坏DNS重绑定攻击的另一种有效方法是使用HTTPS而不是HTTP</strong>，即使对于本地网络连接也是如此。发生重新绑定时，目标服务将具有对malicious.website无效的SSL证书，因此安全警告将阻止请求到达你的API端点。此解决方案还为你的用户提供额外的隐私和安全性，以及TLS &#x2F; SSL带来的常见好处。供应商历来回避使用自己的TLS &#x2F; SSL证书来加固物联网设备的安全性。</li>
<li><strong>可能最好的解决方案是在你的API中添加某种形式的用户身份验证</strong>，尽管这种解决方案可能会对你现有的服务造成最大的破坏。如果你的API控制真实世界的功能或提供对敏感信息的访问，则只有选择方才能访问它。它不应该是整个专用网络，因此也不应该通过DNS重新绑定访问公共Internet。</li>
</ol>
<h2 id="4-4-嗅探"><a href="#4-4-嗅探" class="headerlink" title="4.4 嗅探"></a>4.4 嗅探</h2><h3 id="4-4-1-被动嗅探"><a href="#4-4-1-被动嗅探" class="headerlink" title="4.4.1 被动嗅探"></a>4.4.1 被动嗅探</h3><h4 id="4-4-1-1-技术和方法"><a href="#4-4-1-1-技术和方法" class="headerlink" title="4.4.1.1 技术和方法"></a>4.4.1.1 技术和方法</h4><p>网络监听所需的条件为：</p>
<ul>
<li>网络上的数据能够到达监听主机</li>
<li>监听主机的网卡设置为混杂模式,在共享网络环境下，网络数据能够到达同一网段的所有主机</li>
</ul>
<p>被动监听正是利用这一特点：嗅探者在运行时将网卡设置为混杂模式，这样不用做其他工作，就可以隐蔽的捕获分析数据而不被发现。</p>
<h4 id="4-4-1-2-防御"><a href="#4-4-1-2-防御" class="headerlink" title="4.4.1.2 防御"></a>4.4.1.2 防御</h4><p>对于敏感数据应该进行加密后再传输并使用加密通信协议</p>
<h3 id="4-4-2-主动嗅探"><a href="#4-4-2-主动嗅探" class="headerlink" title="4.4.2 主动嗅探"></a>4.4.2 主动嗅探</h3><h4 id="4-4-2-1技术和方法"><a href="#4-4-2-1技术和方法" class="headerlink" title="4.4.2.1技术和方法"></a>4.4.2.1技术和方法</h4><p>攻击者可以使用ARP欺骗，将数据包导向自己</p>
<h4 id="4-4-2-2-防御"><a href="#4-4-2-2-防御" class="headerlink" title="4.4.2.2 防御"></a>4.4.2.2 防御</h4><ul>
<li>可以安装桌面 ARP 防火墙，用来防护终端 ARP 投毒</li>
<li>配置静态 ARP 地址列表，绑定网关 IP 与 MAC 地址，命令如下<figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp –s <span class="attribute">&lt;网关 IP&gt;</span> <span class="attribute">&lt;网关 MAC&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-4-3-两者的区别"><a href="#4-4-3-两者的区别" class="headerlink" title="4.4.3 两者的区别"></a>4.4.3 两者的区别</h3><ul>
<li>被动嗅探一般存在于共享网络中，在共享网络中一般使用HUB作为接入层，经过HUB的数据报文不管长得什么样，因为HUB工作在第一层，看不懂二层以上的报文是啥样子的，所以一律以广播处理，在同一网段的计算机只要将网卡设置成混杂模式即可。</li>
<li>被动嗅探在交换网络中不适用，因为交换机是通过MAC-端口对应表来转发数据报文的，所以在交换网络中如果只将网卡设置成混杂模式，而不进行主动嗅探，其结果只能接受到网络中的广播包。</li>
<li>共享网络中适用主动嗅探，那是多此一举，适用主动嗅探的方式会对影响网络流量，对网络造成很大的影响，另外适用主动嗅探会产生大量的ARP报文，很容易被发现。而被动嗅探对整个网络几乎没有影响，因为被动嗅探只是做监听，而不会产生多余的数据报文。</li>
</ul>
<h2 id="4-5-ARP欺骗"><a href="#4-5-ARP欺骗" class="headerlink" title="4.5 ARP欺骗"></a>4.5 ARP欺骗</h2><h3 id="4-5-1-场景"><a href="#4-5-1-场景" class="headerlink" title="4.5.1 场景"></a>4.5.1 场景</h3><ul>
<li>攻击者故意发送不正确的MAC-IP映射ARP响应报文，导致发送ARP请求的主机得到不正确的IP地址和MAC地址映射关系</li>
<li>如果该欺骗包的目的MAC地址为广播地址（即FF-FF-FF-FF-FF-FF），则网络中所有节点均会收到该包，从而更新各自的ARP表。</li>
<li>如果欺骗包的目的MAC地址对应的节点不存在，这些包将没有无节点接收，形成所谓的“黑洞攻击”</li>
</ul>
<p>例如：局域网中有一台主机 C，现在假设它感染了 ARP 木马。 主机 C 将会向主机 A 发送一个伪造的 ARP 响应，告知主机 A：主机 B 的 IP 地址 192.168.1.2对应的 MAC 地址是0A-11-22-33-44-03（其实是主机 C 的 MAC 地址）。于是，主机 A 将这个对应关系写入自己的 ARP 缓存表中。以后当主机 A 向主机 B 发送数据时，都会将本应发往主机 B 的数据发送给攻击者（主机 C）。同样地，如果攻击者向主机 B 也发送一个伪造的 ARP响应，告诉主机 B：主机 A 的 IP 地址 192.168.1.1对应的 MAC 地址是0A-11-22-33-44-03，主机 B 也会将数据发送给攻击者。<br>至此攻击者就控制了主机 A 和主机 B 之间的流量，他可以选择被动地监测流量，获取密码和其他涉密信息，也可以主动地伪造数据，改变主机 A 和主机 B 之间的通信内容。</p>
<h3 id="4-5-2-危害"><a href="#4-5-2-危害" class="headerlink" title="4.5.2 危害"></a>4.5.2 危害</h3><ul>
<li>基本的危害是阻塞正常的网络带宽，造成网络拥堵，甚至造成局域网中的其他主机断网。</li>
<li>ARP可以造成中间人攻击，攻击者可以窃取用户敏感信息，实现数据的监听、篡改、重放、钓鱼等。</li>
<li>劫持局域网中其他主机或网关的流量，获取敏感信息等。</li>
</ul>
<h3 id="4-5-3-防御"><a href="#4-5-3-防御" class="headerlink" title="4.5.3 防御"></a>4.5.3 防御</h3><ol>
<li>采用静态绑定的方式防止ARP欺骗<ul>
<li>配置静态 ARP 地址列表，绑定网关 IP 与 MAC 地址，命令如下<figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp –s <span class="attribute">&lt;网关 IP&gt;</span> <span class="attribute">&lt;网关 MAC&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>采用ARP代理服务器<ul>
<li>ARP欺骗之所以能够成功，从根源来看是缺少认证机制，即ARP请求者和ARP响应者均无法确认对方的身份。</li>
<li>可以引入可信的ARP代理服务器（Proxy ARP)，对本网络中或跨网段的ARP请求提供服务，即当主机需要进行ARP请求时，不是广播发送ARP请求消息，而是向可信的ARP服务器发送该ARP请求消息。</li>
</ul>
</li>
<li>在网络设备上对ARP消息进行检测和控制<ul>
<li>交换机:通过端口绑定的方式，只允许满足特定条件的ARP请求和ARP响应数据包通过</li>
<li>路由器:仅允许已经建立了IP地址和MAC地址绑定的数据包通过。不会通过学习的方式来更新自己的ARP表。</li>
<li>防火墙:通过发送可信GARP请求消息来防止ARP欺骗。在发现ARP欺骗时，主动发送GARP请求包，强制主机更新自己本地ARP缓存。</li>
</ul>
</li>
<li>禁用GARP功能<ul>
<li>针对攻击者通过发送恶意GARP请求消息，可以禁用GARP功能达到防御ARP欺骗的目的。</li>
<li>主机也可以选择忽略GARP消息，从而避免更新错误的IP地址和MAC地址映射信息。</li>
</ul>
</li>
</ol>
<h2 id="4-6-IP地址欺骗"><a href="#4-6-IP地址欺骗" class="headerlink" title="4.6 IP地址欺骗"></a>4.6 IP地址欺骗</h2><h3 id="4-6-1-方法"><a href="#4-6-1-方法" class="headerlink" title="4.6.1 方法"></a>4.6.1 方法</h3><ul>
<li>根据IP协议，路由器只是根据IP分组的目的IP地址来确定该IP分组从哪一个端口发送，而不关心该IP分组的源IP地址。因此任意节点均可以构造IP分组，其源IP地址并非当前节点的IP地址,该IP分组能够顺利到达目的节点。</li>
<li>IP地址欺骗能够轻易通过libpcap&#x2F;winpcap库、Scapy库或者raw socket编程实现。<ul>
<li>拒绝服务攻击：避免被追踪而受到惩罚,构造针对同一目的P地址的IP分组，而源IP地址为随机的P地址。</li>
<li>基于IP地址认证服务攻击：假冒可信的IP地址而非法访问计算机资源</li>
</ul>
</li>
</ul>
<h3 id="4-6-2-危害"><a href="#4-6-2-危害" class="headerlink" title="4.6.2 危害"></a>4.6.2 危害</h3><ul>
<li>攻击者可以使用一个受信任的IP地址，用于突破网络安全措施，如基于IP地址的认证服务攻击。通过假冒可信的IP地址，欺骗来自可信机器的连接，同一网络上的攻击者可以不经身份验证访问目标机器</li>
<li>IP地址欺骗最常用在拒绝服务攻击，攻击者构造针对同一目的IP地址的IP分组，而源IP地址为随机的IP地址。其目的是使目标接受压倒性的流量以过载，攻击者不关心接收到攻击数据报的响应。伪造IP地址的数据报过滤更困难，因为每个伪造数据报是来自一个不同的地址，隐藏了攻击的真正来源。</li>
</ul>
<h3 id="4-6-3-防御方法"><a href="#4-6-3-防御方法" class="headerlink" title="4.6.3 防御方法"></a>4.6.3 防御方法</h3><ul>
<li>数据报过滤。对网络的网关执行入口过滤，用内网的源地址来阻止外网的数据包。这可以防止外部攻击者欺骗内部机器的地址。理想情况下，网关也将对传出的数据包执行出口过滤，用外网的源地址阻止内网数据包。这样可以防止网络内的攻击者对来自外部机器进行IP欺骗攻击并进行过滤。</li>
<li>IP回溯。回溯一个IP分组在网络中所经过的路径，追踪攻击者所在地址或网络。</li>
<li>另外建议设计网络协议和服务，使他们不依赖于源IP地址进行身份验证。</li>
</ul>
<h2 id="4-7-TCP会话劫持"><a href="#4-7-TCP会话劫持" class="headerlink" title="4.7 TCP会话劫持"></a>4.7 TCP会话劫持</h2><h3 id="4-7-1-方法"><a href="#4-7-1-方法" class="headerlink" title="4.7.1 方法"></a>4.7.1 方法</h3><ul>
<li>窥探到正在进行TCP通信的两台主机之间传送的报文，这样攻击者就可以得知该报文的源IP、源TCP端口号、目的IP、目的TCP端号，从而可以得知其中一台主机对将要收到的下一个TCP报文段中seq和ackseq值的要求</li>
<li>在该合法主机收到另一台合法主机发送的TCP报文前，攻击者根据所截获的信息向该主机发出一个带有净荷的TCP报文，如果该主机先收到攻击报文，就可以把合法的TCP会话建立在攻击主机与被攻击主机之间</li>
<li>带有净荷的攻击报文能够使被攻击主机对下一个要收到的TCP报文中的确认序号（ackseq）的值的要求发生变化，从而使另一台合法的主机向被攻击主机发出的报文被被攻击主机拒绝。<h3 id="4-7-2-危害"><a href="#4-7-2-危害" class="headerlink" title="4.7.2 危害"></a>4.7.2 危害</h3>攻击者接管会话以后，可以做很多事情，比如：</li>
<li>读取机密文件</li>
<li>用合法用户的身份读取信息</li>
<li>是一种主动攻击，可以获得进入系统的途径<h3 id="4-7-3-防范"><a href="#4-7-3-防范" class="headerlink" title="4.7.3 防范"></a>4.7.3 防范</h3></li>
<li>首先应该使用交换式网络替代共享式网络，这样可以防范最基本的嗅探攻击。</li>
<li>然而，最根本的解决办法是采用加密通讯，使用SSH代替Telnet、使用SSL代替HTTP，或者干脆使用IPSec&#x2F;VPN，这样会话劫持就无用武之地了。</li>
<li>其次，监视网络流量，如发现网络中出现大量的ACK包，则有可能已被进行了会话劫持攻击。</li>
<li>还有一点是比较重要的，就是防范ARP欺骗。实现中间人攻击的前提是ARP欺骗，如能阻止攻击者进行ARP欺骗，中间人攻击也难以进行。</li>
</ul>
<h2 id="4-8-BGP会话劫持"><a href="#4-8-BGP会话劫持" class="headerlink" title="4.8 BGP会话劫持"></a>4.8 BGP会话劫持</h2><p>bgp劫持是指攻击者恶意改变互联网流量的路由。攻击者通过错误地宣布他们实际上并不拥有、控制或路由的IP地址组(称为IP前缀)的所有权来实现这一点。bgp劫持很像是有人在高速公路上改变所有的标志，将汽车指向错误的出口。</p>
<p>整个互联网是由很多的网络组成，这些网络被称为是“自治系统(AS)”，因为边界网关协议（BGP）是建立在假设互联网络真正告诉他们拥有哪些IP地址的基础上的，所以BGP劫持几乎是不可能停止的。</p>
<h3 id="4-8-1-如何劫持"><a href="#4-8-1-如何劫持" class="headerlink" title="4.8.1 如何劫持"></a>4.8.1 如何劫持</h3><p>当AS宣布它实际上不控制的IP前缀的路由时，该公告（如果未被过滤）可以传播并被添加到因特网上的BGP路由器中的路由表。从那时起，直到有人注意到并纠正路由，这些IP的流量将被路由到该AS。BGP始终支持所需IP地址的最快最详细的的路径。为了使BGP劫持成功，路由公告必须：</p>
<ul>
<li>提供一个更具体的路线，宣布一个较小的范围的IP地址比其他AS先宣布。</li>
<li>为某些IP地址块提供更短的路由。此外，不只是任何人都可以宣布更大的互联网的BGP路由。为了发生BGP劫持，必须由AS的运营商或已破坏AS的威胁行为者发布通知（第二种情况更为罕见）。<h3 id="4-8-2-危害"><a href="#4-8-2-危害" class="headerlink" title="4.8.2 危害"></a>4.8.2 危害</h3>由于BGP劫持，互联网流量可能出错，被监控或拦截，被“黑洞”，或者作为中间人攻击的一部分被导向虚假网站。此外，垃圾邮件发送者可以使用BGP劫持或实施BGP劫持的AS网络，以欺骗合法IP以进行垃圾邮件。从用户的角度来看，页面加载时间将会增加，因为请求和响应将不会遵循最有效的网络路由，甚至可能不必要地遍历全世界。</li>
</ul>
<p>在最佳情况下，流量只会占用不必要的长路径，从而增加延迟。在最糟糕的情况下，攻击者可能正在进行中间人攻击，或者将用户重定向到虚假网站以窃取数据。</p>
<h3 id="4-8-3-防范"><a href="#4-8-3-防范" class="headerlink" title="4.8.3 防范"></a>4.8.3 防范</h3><ol>
<li>IP段前缀过滤：大多数网络应该只在必要时接受IP段前缀声明，并且只应将其IP前缀声明到某些网络，而不是整个Internet。这样做有助于防止意外的路由劫持，并可能使AS不接受伪造的IP前缀声明; 但是，在实践中，这很难实施。</li>
<li>BGP劫持检测：增加的延迟，降低的网络性能和错误的互联网流量都是BGP劫持的可能迹象。许多大型网络将监控BGP更新，以确保其客户不会遇到延迟问题，并且一些安全研究人员实际上会监控互联网流量并发布他们的发现。</li>
<li>使BGP更安全：BGP旨在使Internet工作，它肯定会这样做。但BGP的设计并未考虑安全性。整个互联网（如BGPsec）的安全路由解决方案正在开发中，但尚未采用它们。目前，BGP具有内在的脆弱性，并将继续存在。</li>
</ol>
<h1 id="五、安全协议标准"><a href="#五、安全协议标准" class="headerlink" title="五、安全协议标准"></a>五、安全协议标准</h1><h2 id="5-1-IP安全"><a href="#5-1-IP安全" class="headerlink" title="5.1 IP安全"></a>5.1 IP安全</h2><h3 id="5-1-1-IPsec的两种工作模式"><a href="#5-1-1-IPsec的两种工作模式" class="headerlink" title="5.1.1 IPsec的两种工作模式"></a>5.1.1 IPsec的两种工作模式</h3><p>课本P124~P1255<br><img src="/2021-12-04-14-30-52.png"><br><img src="/2021-12-04-14-42-44.png"><br>AH只提供认证功能，ESP可以提供加密和认证功能</p>
<h4 id="5-1-1-1-传输模式"><a href="#5-1-1-1-传输模式" class="headerlink" title="5.1.1.1 传输模式"></a>5.1.1.1 传输模式</h4><p><img src="/2021-12-04-14-40-22.png"></p>
<h4 id="5-1-1-2-隧道模式"><a href="#5-1-1-2-隧道模式" class="headerlink" title="5.1.1.2 隧道模式"></a>5.1.1.2 隧道模式</h4><p><img src="/2021-12-04-14-41-04.png"></p>
<h4 id="5-1-1-3-两者的比较"><a href="#5-1-1-3-两者的比较" class="headerlink" title="5.1.1.3 两者的比较"></a>5.1.1.3 两者的比较</h4><p><img src="/2021-12-04-14-41-34.png"></p>
<h4 id="5-1-1-4-协议的作用"><a href="#5-1-1-4-协议的作用" class="headerlink" title="5.1.1.4 协议的作用"></a>5.1.1.4 协议的作用</h4><p><img src="/2021-12-04-14-45-44.png"></p>
<h4 id="5-1-1-5-协议的安全性分析"><a href="#5-1-1-5-协议的安全性分析" class="headerlink" title="5.1.1.5 协议的安全性分析"></a>5.1.1.5 协议的安全性分析</h4><ol>
<li>提供对跨越LAN&#x2F;WAN，Internet的通讯提供安全性<ul>
<li>分支办公机构通过Internet互连。(Secure VPN)</li>
<li>通过Internet的远程访问。</li>
<li>与合作伙伴建立extranet与intranet的互连。</li>
<li>增强电子商务安全性。</li>
</ul>
</li>
<li>可以支持IP级所有流量的加密和&#x2F;或认证。可以增强所有分布式应用的安全性。</li>
<li>当在路由器和防火墙中使用IPsec,对通过其边界的所有通信流提供强安全性，内部通信无安全开销。</li>
<li>位于传输层之下，对所有应用透明</li>
<li>可以对终端用户透明，不需要对用户进行安全机制培训</li>
</ol>
<h3 id="5-1-2-安全关联SA与安全策略数据库SPD"><a href="#5-1-2-安全关联SA与安全策略数据库SPD" class="headerlink" title="5.1.2 安全关联SA与安全策略数据库SPD"></a>5.1.2 安全关联SA与安全策略数据库SPD</h3><p><img src="/2021-12-08-20-16-43.png"></p>
<p>在IPSec的安全体系中，有两个很重要的数据库。一个是SPD - Security Policy Database（安全策略数据库）；另一个是SAD - Security Association Database（安全关联数据库）。顾名思义，SPD中定义了若干策略，说明对于各个IP数据流应当做出怎样的处理，是透明传输、丢弃，还是执行IPSec加解密。SAD则负责保存已经建立的SA相关信息，比如SA的各种参数，如加密算法、认证算法、生存时间等。同时，它还为SA的建立提供协商用的参数，比如，加密套件，生存时间等。新生成的SA则被插入到SAD中。每当发出或者接收到一个数据包的时候，如果对它的策略是IPSec，那么就要去SAD中找到对应的SA，根据SA中提供的参数，对数据包进行加解密、生成校验和、封装成AH&#x2F;ESP等操作。</p>
<h3 id="5-1-3-密钥交换协议IKE"><a href="#5-1-3-密钥交换协议IKE" class="headerlink" title="5.1.3 密钥交换协议IKE"></a>5.1.3 密钥交换协议IKE</h3><h4 id="5-1-3-1-SA的密钥交换过程"><a href="#5-1-3-1-SA的密钥交换过程" class="headerlink" title="5.1.3.1 SA的密钥交换过程"></a>5.1.3.1 SA的密钥交换过程</h4><p><img src="/2021-12-04-15-23-04.png"><br><img src="/2021-12-04-15-23-24.png"></p>
<h4 id="5-1-3-2-安全性"><a href="#5-1-3-2-安全性" class="headerlink" title="5.1.3.2 安全性"></a>5.1.3.2 安全性</h4><ul>
<li>用Cookie机制防止拥塞攻击；</li>
<li>使用时间戳阻止重放攻击；</li>
<li>认证Diffie-Hellman交换，防止中间人攻击。</li>
</ul>
<h2 id="5-2-传输层安全"><a href="#5-2-传输层安全" class="headerlink" title="5.2 传输层安全"></a>5.2 传输层安全</h2><p>SSL：课本P135<br>TLS：课本P146<br>HTTPS：课本P150<br>SSH：课本P151</p>
<h3 id="5-2-1-SSL"><a href="#5-2-1-SSL" class="headerlink" title="5.2.1 SSL"></a>5.2.1 SSL</h3><p><img src="/2021-12-04-15-40-08.png"></p>
<h4 id="5-2-1-1-功能"><a href="#5-2-1-1-功能" class="headerlink" title="5.2.1.1 功能"></a>5.2.1.1 功能</h4><p><img src="/2021-12-04-15-41-53.png"></p>
<h4 id="5-2-1-2-特点"><a href="#5-2-1-2-特点" class="headerlink" title="5.2.1.2 特点"></a>5.2.1.2 特点</h4><p><img src="/2021-12-04-15-43-57.png"></p>
<h4 id="5-2-1-3-协议框架"><a href="#5-2-1-3-协议框架" class="headerlink" title="5.2.1.3 协议框架"></a>5.2.1.3 协议框架</h4><p><img src="/2021-12-04-15-50-33.png"></p>
<h4 id="5-2-1-4-交互过程"><a href="#5-2-1-4-交互过程" class="headerlink" title="5.2.1.4 交互过程"></a>5.2.1.4 交互过程</h4><p><img src="/2021-12-04-15-56-34.png"></p>
<ul>
<li>第一阶段：建立安全能力。客户端首先发送ClientHello消息到服务器端并等待服务器端响应，服务器端收到ClientHello消息后再发送ServerHello消息回应客户端。这个阶段后，客户端与服务端知道了：SSL版本，密钥交换、消息验证和加密算法，压缩方法，有关密钥生成的两个随机数。</li>
<li>第二阶段：服务器鉴别与密钥交换。服务器启动SSL握手第2阶段，是本阶段所有消息的唯一发送方，客户机是所有消息的唯一接收方。该阶段分为4步：<ol>
<li>证书：服务器将数字证书和到根CA整个链发给客户端，使客户端能用服务器证书中的服务器公钥认证服务器。</li>
<li>服务器密钥交换（可选）：这里视密钥交换算法而定。</li>
<li>证书请求：服务端可能会要求客户自身进行验证。</li>
<li>服务器握手完成：第二阶段的结束，第三阶段开始的信号。</li>
</ol>
</li>
<li>第三阶段：客户机鉴别与密钥交换。客户机启动SSL握手第3阶段，是本阶段所有消息的唯一发送方，服务器是所有消息的唯一接收方。该阶段可分为3步：<ol>
<li>证书（可选）：为了对服务器证明自身，客户要发送一个证书信息，这是可选的，在IIS中可以配置强制客户端证书认证。</li>
<li>客户机密钥交换：这里客户端将预备主密钥发送给服务端，注意这里会使用服务端的公钥进行加密。</li>
<li>证书验证（可选），对预备秘密和随机数进行签名，证明拥有（1）证书的公钥。</li>
</ol>
</li>
<li>第四阶段：变更密钥套件和结束握手。<h3 id="5-2-2-TLS"><a href="#5-2-2-TLS" class="headerlink" title="5.2.2 TLS"></a>5.2.2 TLS</h3><img src="/2021-12-04-16-00-43.png"><h3 id="5-2-3-HTTPS"><a href="#5-2-3-HTTPS" class="headerlink" title="5.2.3 HTTPS"></a>5.2.3 HTTPS</h3><img src="/2021-12-04-16-01-41.png"><h4 id="5-2-3-1-执行过程"><a href="#5-2-3-1-执行过程" class="headerlink" title="5.2.3.1 执行过程"></a>5.2.3.1 执行过程</h4><img src="/2021-12-04-16-07-01.png"><br><img src="/2021-12-04-16-07-15.png"><h4 id="5-2-3-2-消息格式"><a href="#5-2-3-2-消息格式" class="headerlink" title="5.2.3.2 消息格式"></a>5.2.3.2 消息格式</h4><img src="/2021-12-04-16-08-34.png"><h4 id="5-2-3-3-客户对服务器的认证"><a href="#5-2-3-3-客户对服务器的认证" class="headerlink" title="5.2.3.3 客户对服务器的认证"></a>5.2.3.3 客户对服务器的认证</h4><img src="/2021-12-04-16-09-10.png"><br><img src="/2021-12-04-16-09-34.png"><h4 id="5-2-3-4-服务器对客户的认证"><a href="#5-2-3-4-服务器对客户的认证" class="headerlink" title="5.2.3.4 服务器对客户的认证"></a>5.2.3.4 服务器对客户的认证</h4></li>
<li>服务器对用户没有其他信息</li>
<li>服务器对用户的认证只能通过用户的证书<ul>
<li>如果用户的证书是不可接受的，则认证失败</li>
<li>否则认证通过<h4 id="5-2-3-5-解决的问题"><a href="#5-2-3-5-解决的问题" class="headerlink" title="5.2.3.5 解决的问题"></a>5.2.3.5 解决的问题</h4><img src="/2021-12-04-16-02-02.png"></li>
</ul>
</li>
</ul>
<h3 id="5-2-4-SSH"><a href="#5-2-4-SSH" class="headerlink" title="5.2.4 SSH"></a>5.2.4 SSH</h3><h4 id="5-2-4-1-作用"><a href="#5-2-4-1-作用" class="headerlink" title="5.2.4.1 作用"></a>5.2.4.1 作用</h4><p>传统的网络服务程序，如FTP、POP和Telnet在本质上都是不安全的，因为它们在网络上用明文传送口令和数据，攻击者很容易截获这些口令和数据而且很容易受到“中间人攻击”。<br>通过使用SSH协议，可以把所有传输的数据进行加密，能够防止DNS欺骗和IP欺骗，有效防止远程管理过程中的信息泄露问题，替代Telnet和其他不安全的远程登录方案，提供客户端&#x2F;服务器功能，支持文件传输和Email等网络共功能。使用SSH，还有一个额外的好处就是传输的数据是经过压缩的，所以可以加快传输的速度。</p>
<h4 id="5-2-4-2-工作原理"><a href="#5-2-4-2-工作原理" class="headerlink" title="5.2.4.2 工作原理"></a>5.2.4.2 工作原理</h4><ol>
<li>服务器建立公钥： 每一次启动 sshd 服务时，该服务会主动去找 &#x2F;etc&#x2F;ssh&#x2F;ssh_host* 的文件，若系统刚刚安装完成时，由于没有这些公钥，因此 sshd 会主动去计算出这些需要的公钥，同时也会计算出服务器自己需要的私钥。</li>
<li>客户端主动联机请求： 若客户端想要联机到 ssh 服务器，则需要使用适当的客户端程序来联机，包括 ssh, putty 等客户端程序连接。</li>
<li>服务器传送公钥给客户端： 接收到客户端的要求后，服务器便将第一个步骤取得的公钥传送给客户端使用 (此时应是明码传送，反正公钥本来就是给大家使用的)。</li>
<li>客户端记录并比对服务器的公钥数据及随机计算自己的公私钥： 若客户端第一次连接到此服务器，则会将服务器的公钥记录到客户端的用户家目录内的 ~&#x2F;.ssh&#x2F;known_hosts 。若是已经记录过该服务器的公钥，则客户端会去比对此次接收到的与之前的记录是否有差异。若接受此公钥， 则开始计算客户端自己的公私钥。</li>
<li>回传客户端的公钥到服务器端： 用户将自己的公钥传送给服务器。此时服务器：具有服务器的私钥与客户端的公钥，而客户端则是： 具有服务器的公钥以及客户端自己的私钥，你会看到，在此次联机的服务器与客户端的密钥系统 (公钥+私钥) 并不一样，所以才称为非对称加密系统。</li>
<li>开始双向加解密： (1)服务器到客户端：服务器传送数据时，拿用户的公钥加密后送出。客户端接收后，用自己的私钥解密；(2)客户端到服务器：客户端传送数据时，拿服务器的公钥加密后送出。服务器接收后，用服务器的私钥解密，这样就能保证通信安全。<h4 id="5-2-4-3-认证方式"><a href="#5-2-4-3-认证方式" class="headerlink" title="5.2.4.3 认证方式"></a>5.2.4.3 认证方式</h4></li>
</ol>
<ul>
<li>基于口令的认证：与telnet类似，提供正确的用户口令后可以登录远程服务器</li>
</ul>
<p>-基于密钥的认证，具体步骤如下:<br>    1. 客户端建立两把钥匙(公钥与私钥)<br>    1. 将公钥数据上传到服务器上<br>    1. 将公钥放置服务器端的正确目录与文件名（scp 或 ssh-copy-id）</p>
<h2 id="5-3-电子邮件安全"><a href="#5-3-电子邮件安全" class="headerlink" title="5.3 电子邮件安全"></a>5.3 电子邮件安全</h2><h3 id="5-3-1-PGP"><a href="#5-3-1-PGP" class="headerlink" title="5.3.1 PGP"></a>5.3.1 PGP</h3><p>课本P189</p>
<p><img src="/2021-12-04-18-33-38.png"></p>
<p>Bob :</p>
<ul>
<li>用自己的私钥将共享密钥Ks解密出来</li>
<li>用共享密钥Ks解密信息m</li>
</ul>
<h4 id="5-3-1-1-工作流程："><a href="#5-3-1-1-工作流程：" class="headerlink" title="5.3.1.1 工作流程："></a>5.3.1.1 工作流程：</h4><ol>
<li>邮件数据m经哈希函数进行散列处理,形成数据的摘要 </li>
<li>用发送者的RSA私钥KAd对摘要进行数字签名,确保真实性 </li>
<li>将邮件数据与数字签名拼接:数据在前,签名在后 </li>
<li>用ZIP压缩算法对拼接后的数据进行压缩,以便于存储和传输</li>
<li>用会话密钥对压缩后的数据进行加密,加密钥为K,确保保密 </li>
<li>用接收者的RSA公钥KBe加密会话密钥K </li>
<li>将经RSA加密的会话密钥与会话密钥加密的数据拼接:数据在前,密钥在后 </li>
<li>将加密数据进行BASE 64变化,变化为ASCII码<h4 id="5-3-1-2-会话密钥："><a href="#5-3-1-2-会话密钥：" class="headerlink" title="5.3.1.2 会话密钥："></a>5.3.1.2 会话密钥：</h4>每个消息都需要一个会话密钥</li>
</ol>
<ul>
<li>不同大小：56位DES, 128位CAST或IDEA, 168位Triple-DES</li>
<li>使用ANSI X12.17模式生成使用</li>
<li>使用从以前的使用和用户的击键定时随机输入<h4 id="5-3-1-3-消息格式"><a href="#5-3-1-3-消息格式" class="headerlink" title="5.3.1.3 消息格式"></a>5.3.1.3 消息格式</h4><img src="/2021-12-04-19-14-39.png"><h3 id="5-3-2-S-x2F-MIME"><a href="#5-3-2-S-x2F-MIME" class="headerlink" title="5.3.2 S&#x2F;MIME"></a>5.3.2 S&#x2F;MIME</h3>MIME内容类型：课本P194<br>S&#x2F;MIME功能：课本P198<br>S&#x2F;MIME内容类型：课本P200</li>
</ul>
<p>S&#x2F;MIME的全称是安全多用途网际邮件扩充协议。<br>SMIME对安全方面的功能也进行了扩展，可以把MIME的实体(比如加密信息和数字签名等)封装成安全对象。它定义了增强的安全服务，例如具有接收方确认签收的功能，这样就可以确保接收者不能否认已经收到过的邮件。S&#x2F;MIME增加了新的MIME数据类型，用于提供数据保密、完整性保护、认证和鉴定服务等。</p>
<p>MIME消息可以包含文本、图像、声音、视频及其他应用程序的特定数据，采用单向散列算法(如SHA-1、SHA-2、SHA-3、MD5等)和公钥机制的加密体系。S&#x2F;MIME的证书采用X.509标准格式。S&#x2F;MIME的认证机制依赖于层次结构的证书认证机构，所有下一级的组织和个人的证书均由上一级的组织负责认证，而最上一级的组织(根证书)之间相互认证，整个信任关系是树状结构的。另外，S&#x2F;MIME将信件内容加密签名后作为特殊的附件传送。</p>
<h4 id="5-3-2-1-与PGP的比较"><a href="#5-3-2-1-与PGP的比较" class="headerlink" title="5.3.2.1 与PGP的比较"></a>5.3.2.1 与PGP的比较</h4><ul>
<li>公钥可信度： S&#x2F;MIME标准中，用户必须从受信任的证书颁发机构申请X.509v3数字证书，由权威CA机构验证用户真实身份并签署公钥，确保用户公钥可信，收件人通过证书公钥验证发件人身份真实性。而PGP不提供强制创建信任的策略，由发件人自己创建并签署自己的密钥对，或为其他通信用户签署公钥增加其密钥可信度，没有任何受信任的权威中心去验证核实身份信息，每个用户必须自己决定是否信任对方。</li>
<li>加密保护的范围：PGP的诞生是为了解决纯文本消息的安全问题，而S&#x2F;MIME不仅保护文本消息，更旨在保护各种附件&#x2F;数据文件。</li>
<li>集中化管理：从管理角度来看，S&#x2F;MIME被认为优于PGP，因为它具有强大的功能，支持通过X.509证书服务器进行集中式密钥管理。</li>
<li>兼容性和易用性：S&#x2F;MIME具备更广泛的行业支持，S&#x2F;MIME协议已经内置于大多数电子邮件客户端软件中。<h4 id="5-3-2-2-S-x2F-MIME的功能"><a href="#5-3-2-2-S-x2F-MIME的功能" class="headerlink" title="5.3.2.2 S&#x2F;MIME的功能"></a>5.3.2.2 S&#x2F;MIME的功能</h4><img src="/2021-12-04-19-33-21.png"><h3 id="5-3-3-DKIM"><a href="#5-3-3-DKIM" class="headerlink" title="5.3.3 DKIM"></a>5.3.3 DKIM</h3>课本P207~208</li>
</ul>
<p>DKIM（域密钥标识的邮件）是一种电子邮件身份验证机制，允许收件人邮件服务器检查邮件在传输过程中是否已被更改。这是由接收方服务器完成的，检查并验证发送服务器在邮件上留下的加密签名，以确保邮件以与发送邮件相同的形式到达。</p>
<p>DKIM让企业可以把加密签名插入到发送的电子邮件中，然后把该签名与域名关联起来。签名随电子邮件<br>一起传送，而不管是沿着网络上的哪条路径传送，电子邮件收件人则可以使用签名来证实邮件确实来自<br>该企业。</p>
<p>DKIM的基本工作原理同样是基于传统的密钥认证方式，他会产生两组钥匙，公钥(public key)和私钥(private key)，公钥将会存放在DNS中，而私钥会存放在寄信服务器中。数字签名会自动产生，并依附在邮件头中，发送到寄信者的服务器里。公钥则放在DNS服务器上，供自动获得。收信的服务器，将会收到夹带在邮件头中的签名和在DNS上自己获取公钥，然后进行比对，比较寄信者的域名是否合法，如果不合法，则判定为垃圾邮件。 由于数字签名是无法仿造的，因此这项技术对于伪造域名的垃圾邮件制造者将是一次致命的打击，他们很难再像过去一样，通过盗用发件人姓名、改变附件属性等小伎俩达到目的。在此之前，垃圾邮件制造者通过把文本转换为图像等方式逃避邮件过滤，并且使得一度逐渐下降的垃圾邮件数目再度抬头。</p>
<h3 id="5-3-4-垃圾邮件发送的基本原理"><a href="#5-3-4-垃圾邮件发送的基本原理" class="headerlink" title="5.3.4 垃圾邮件发送的基本原理"></a>5.3.4 垃圾邮件发送的基本原理</h3><h4 id="5-3-4-1-SMTP-Relay"><a href="#5-3-4-1-SMTP-Relay" class="headerlink" title="5.3.4.1 SMTP Relay"></a>5.3.4.1 SMTP Relay</h4><p>方法：</p>
<ul>
<li>以这种方式配置的SMTP服务器:允许互联网上的任何人通过它发送电子邮件，而不仅仅是发送给已知用户或由已知用户发出的邮件</li>
<li>SMTP中继转发邮件到目的地：<ol>
<li>批量电子邮件工具通过SMTP(端口25)连接。</li>
<li>发送收件人列表(通过RCPT TO命令)</li>
<li>给所有的收件人发送邮件正文</li>
<li>中继传递消息</li>
</ol>
</li>
<li>一般的中继器会将经过的路由加入报文头部，但被攻击的中继器可以不记录其上一跳的攻击者的地址，因此无法将攻击者加入黑名单</li>
</ul>
<p>举例：bobax蠕虫</p>
<p>特点：</p>
<ul>
<li>SMTP服务器负责中继传出电子邮件，并且不接受传入电子邮件。POP和IMAP是允许您从邮件服务器检索电子邮件的协议，而SMTP是允许您将电子邮件发送到邮件服务器的协议。</li>
<li>SMTP中继服务通过将电子邮件路由到受信任的第三方来帮助发件人传递事务性和批量电子邮件。</li>
<li>中继获取地址列表并将消息发送给所有人，僵尸通常提供被黑客攻击的邮件中继。<h4 id="5-3-4-2-HTTP-proxies"><a href="#5-3-4-2-HTTP-proxies" class="headerlink" title="5.3.4.2 HTTP proxies"></a>5.3.4.2 HTTP proxies</h4>代理：垃圾邮件发送者必须通过代理向每个收件人发送消息正文。<h4 id="5-3-4-3-spamware（垃圾邮件软件）"><a href="#5-3-4-3-spamware（垃圾邮件软件）" class="headerlink" title="5.3.4.3 spamware（垃圾邮件软件）"></a>5.3.4.3 spamware（垃圾邮件软件）</h4></li>
<li>导入数以千计的地址，产生随机地址，在信息中插入欺诈性的标头，同时使用数十或数百个邮件服<br>务，并且能利用匿名转发。</li>
<li>能够搜索电子邮件地址并且建立邮件列表，利用此列表直接发送垃圾邮件或者把此列表卖给垃圾邮<br>件发送者。<h4 id="5-3-4-4-中继vs代理"><a href="#5-3-4-4-中继vs代理" class="headerlink" title="5.3.4.4 中继vs代理"></a>5.3.4.4 中继vs代理</h4></li>
<li>中继获取地址列表并向所有人发送消息。僵尸通常会提供被入侵的邮件中继。</li>
<li>代理:垃圾邮件发送者必须通过代理向每个收件人发送邮件正文。</li>
</ul>
<h3 id="5-3-5-反垃圾邮件的方法"><a href="#5-3-5-反垃圾邮件的方法" class="headerlink" title="5.3.5 反垃圾邮件的方法"></a>5.3.5 反垃圾邮件的方法</h3><h4 id="5-3-5-1-法律CAN-SPAM-act"><a href="#5-3-5-1-法律CAN-SPAM-act" class="headerlink" title="5.3.5.1 法律CAN-SPAM act"></a>5.3.5.1 法律CAN-SPAM act</h4><ul>
<li>禁止虚假或误导性的标题信息，To:和From：标题必须准确</li>
<li>禁止欺骗性的标题</li>
<li>需要选择退出方法</li>
<li>要求电子邮件被识别为广告，并包括发送者的实际邮政地址</li>
<li>还禁止各种形式的电子邮件收集和使用代理<h4 id="5-3-5-2-发送方验证Ⅰ：SPF"><a href="#5-3-5-2-发送方验证Ⅰ：SPF" class="headerlink" title="5.3.5.2 发送方验证Ⅰ：SPF"></a>5.3.5.2 发送方验证Ⅰ：SPF</h4>SPF 记录允许域名管理员公布所授权的邮件服务器IP地址，接收服务器会在收到邮件时验证发件人在SMTP 会话中执行 MAIL FROM命令时的邮件地址是否与域名 SPF 记录中所指定的源 IP 匹配，以判断是否为发件人域名伪造。</li>
</ul>
<p>邮件接收方的收件服务器在接受到邮件后，首先检查域名的SPF记录，来确定发件人的IP地址是否被包含在SPF记录里面，如果在，就认为是一封来自于被授权服务器的邮件，否则会认为是一封伪造的邮件并根据相关政策退回或放进收件人的杂件箱。</p>
<h4 id="5-3-5-3-发送方验证Ⅱ：DKIM"><a href="#5-3-5-3-发送方验证Ⅱ：DKIM" class="headerlink" title="5.3.5.3 发送方验证Ⅱ：DKIM"></a>5.3.5.3 发送方验证Ⅱ：DKIM</h4><p>DKIM（域密钥标识的邮件）是一种电子邮件身份验证机制，允许收件人邮件服务器检查邮件在传输过程中是否已被更改。这是由接收方服务器完成的，检查并验证发送服务器在邮件上留下的加密签名，以确保邮件以与发送邮件相同的形式到达。</p>
<p>客户配置使用该功能后，发送邮件时在每封电子邮件上增加加密的数字标志，以支持接收方与合法的互<br>联网地址数据库中的记录进行比较。<br><img src="/2021-12-04-21-17-27.png"><br>与SPF的比较：SPF（发件人策略框架）是一种电子邮件身份验证，专门保护和验证在邮件传递过程中使用的返回路径地址，从而防止“ 发件人地址”伪造。通过确保已发送的电子邮件源自有权代表发件人发送电子邮件的服务器来执行此操作。如前所述，DKIM可以防止在传输过程中对电子邮件本身进行未经授权的更改。</p>
<h4 id="5-3-5-4-Graylists"><a href="#5-3-5-4-Graylists" class="headerlink" title="5.3.5.4 Graylists"></a>5.3.5.4 Graylists</h4><p>灰名单Graylist是一个由多个email地址或者域名形成列表的广告信件过滤器，用来识别可疑的广告信件。当收到列表中的一个地址或域发出的信息，它将被隔离，仅当发送者在一定时间内再发送一次才能送达给graylist用户。一旦寄件者被认定为合法，它的地址就会从列表中移除，并且将来该地址发送的信息直接通过过滤器而不受拦阻。</p>
<p>其优点在于它排除了试图通过以email作为传递方式派发广告的大部分垃圾信件。它不需要终端用户方拥有特殊配置，并且对终端用户的电脑资源不会造成额外的负担。但是，除非发送者在预先规定的时间内从相同的email地址重复发送第一封信息两次，否则过滤器将阻拦掉信件。Graylist也可能在最初收信时造成恼人的延迟。</p>
<h4 id="5-3-5-5-whitelisting"><a href="#5-3-5-5-whitelisting" class="headerlink" title="5.3.5.5 whitelisting"></a>5.3.5.5 whitelisting</h4><p>用户指定允许发送者的列表</p>
<ul>
<li>所有其他发件人必须解决CAPTCHA以启用电子邮件传送</li>
<li>简单的UI添加进来的发件人白名单</li>
</ul>
<h1 id="六、典型网络攻击与防御方法"><a href="#六、典型网络攻击与防御方法" class="headerlink" title="六、典型网络攻击与防御方法"></a>六、典型网络攻击与防御方法</h1><h2 id="6-1-攻击手段"><a href="#6-1-攻击手段" class="headerlink" title="6.1 攻击手段"></a>6.1 攻击手段</h2><p><img src="/2021-12-05-10-42-10.png"><br><img src="/2021-12-05-10-42-27.png"></p>
<h3 id="6-1-1-攻击准备阶段"><a href="#6-1-1-攻击准备阶段" class="headerlink" title="6.1.1 攻击准备阶段"></a>6.1.1 攻击准备阶段</h3><ul>
<li>信息收集：<br>主要利用搜索引擎和扫描技术。通过外围信息收集和多种扫描技术，可以获得目标的IP地址、端口、操作系统版本、存在的漏洞等攻击必需信息，为下一步的网络攻击做好前期的准备。可以采用如下外围信息收集的方式：<ul>
<li>使用Whois查询域名注册的相关信息：Whois 是Internet上提供的查找相关域名、IP地址、E-mail信箱、联系电话等信息的一种服务。</li>
<li>使用搜索引擎收集更多的外围信息：Google Hack是一个搜索敏感信息的工具，通过编写一些简单的脚本就能搜索到重要的信息，甚至包括密码文件。</li>
</ul>
</li>
<li>战争拨号：<br>战争拨号器是一种计算机程序，它将调用电话号码的预设列表以查找计算机，传真机和其他数据设备。该程序会接收预设的号码列表，通常是单个区号或城市中的所有电话号码。 然后，程序一个接一个地拨号码，寻找数据接收者。 常见的数据设备在响一声后便会应答。 如果电话响了两次，则拨号器会简单挂断并拨打下一个号码。 如果数据设备应答，则会记录该号码，并且拨号程序断开连接。<h3 id="6-1-2-端口扫描"><a href="#6-1-2-端口扫描" class="headerlink" title="6.1.2 端口扫描"></a>6.1.2 端口扫描</h3></li>
<li>方法：逐个对一段端口或指定的端口进行扫描，通过扫描结果可以知道一台计算机上都提供了哪些服务，可以通过所提供的这些服务的己知漏洞进行攻击。常用工具：Nmap。</li>
<li>类别：TCP connect() 扫描、TCP SYN扫描、TCP FIN 扫描、NULL扫描、IP段扫描、ACK扫描。</li>
<li>工作原理：当一个主机向远端一个服务器的某一个端口提出建立一个连接的请求，如果对方有此项服务，就会应答，如果对方未安装此项服务时，即使向相应的端口发出请求，对方仍无应答。</li>
<li>常用端口号：<br>SOCKS代理：1080；FTP：21；Telnet：23；HTTP服务器：80&#x2F;tcp；HTTPS服务器：443&#x2F;tcp、443&#x2F;udp；Telnet：23&#x2F;tcp；FTP：21&#x2F;tcp；SSH：22&#x2F;tcp；SMTP：25&#x2F;tcp；POP3：110&#x2F;tcp。<h3 id="6-1-3-漏洞扫描"><a href="#6-1-3-漏洞扫描" class="headerlink" title="6.1.3 漏洞扫描"></a>6.1.3 漏洞扫描</h3></li>
<li>原理：基于漏洞数据库，通过扫描等手段对指定的远程或者本地计算机系统的安全脆弱性进行检测，发现可利用漏洞的一种安全检测（渗透攻击）行为。</li>
<li>方法：<ol>
<li>网络漏洞扫描工具：<ul>
<li>网络漏洞扫描工具针对网络中的主机和网络设备，发送漏洞探测数据包进行漏洞的扫描。它主要利用模拟攻击技术扫描出具体的漏洞类型。</li>
<li>常见工具：Nessus、OpenVAS、AWVS、X-Scan。</li>
</ul>
</li>
<li>主机漏洞扫描工具：<ul>
<li>主机漏洞扫描工具通过漏洞特征匹配技术和补丁安全信息的检测来进行操作系统和应用软件系统的漏洞检测。</li>
<li>常见工具：Nessus、360安全卫士等。<h3 id="6-1-4-网络测绘"><a href="#6-1-4-网络测绘" class="headerlink" title="6.1.4 网络测绘"></a>6.1.4 网络测绘</h3></li>
</ul>
</li>
</ol>
</li>
<li>一般技术：通过网络空间探测、数据挖掘、数据清洗、算法分析等方式，获取网络空间中设备和基础设施、互联网用户等网络战略资源的地理信息、网络信息、社会信息；通过网络空间可视化技术，以地理地图或逻辑图的形式绘制出来，从而实时地反映出网络空间中各项资源的基础信息和发展变化态势。</li>
<li>相应工具：美国的Shadon、知道创宇的<h3 id="6-1-5-攻击链与反攻击链"><a href="#6-1-5-攻击链与反攻击链" class="headerlink" title="6.1.5 攻击链与反攻击链"></a>6.1.5 攻击链与反攻击链</h3><h4 id="攻击链"><a href="#攻击链" class="headerlink" title="攻击链"></a>攻击链</h4>在越早的杀伤链环节阻止攻击，修复的成本和时间损耗就越低。<br><img src="/2021-12-05-10-49-32.png"><h4 id="反攻击链"><a href="#反攻击链" class="headerlink" title="反攻击链"></a>反攻击链</h4>“发现-定位-跟踪-瞄准-打击-评估”的F2T2EA模型</li>
<li>情报</li>
<li>监视</li>
<li>3C：指挥、控制与协同<br><img src="/2021-12-05-10-51-35.png"><br><img src="/2021-12-05-10-50-35.png"><h2 id="6-2-不同协议层次的DoS攻击"><a href="#6-2-不同协议层次的DoS攻击" class="headerlink" title="6.2 不同协议层次的DoS攻击"></a>6.2 不同协议层次的DoS攻击</h2></li>
<li>DoS：中文名称是拒绝服务，一切能引起DOS行为的攻击都被称为dos攻击。该攻击的效果是使得计算机或网络无法提供正常的服务。常见的DOS攻击有针对计算机网络带宽和连通性的攻击。 DOS是单机于单机之间的攻击。<ul>
<li>DOS攻击的原理：首先攻击者向被攻击的服务器发送大量的虚假ip请求，被攻击者在收到请求后返回确认信息，等待攻击者进行确认，（此处需要拥有HTTP协议工作方式和tcp三次握手的基本知识）该过程需要TCP的三次握手，由于攻击者发送的请求信息是虚假的，所以服务器接收不到返回的确认信息，在一段时间内服务器会处与等待状态，而分配给这次请求的资源却被有被释放。当被攻击者等待一定的时间后，会因连接超时而断开，这时攻击者在次发送新的虚假信息请求，这样最终服务器资源被耗尽，直到瘫痪。</li>
</ul>
</li>
<li>DDoS：DDOS(Distributed Denial Service)分布拒绝式攻击，它是在DOS基础上进行的大规模，大 范围的攻击模式，DOS只是单机和单机之间的攻击模式，而DDOS是利用一批受控制的僵尸主 机向一台服务器主机发起的攻击，其攻击的强度和造成的威胁要比DOS严重很多，更具破坏 性。首先DDOS攻击者要寻找僵尸主机，在互联网上寻找一些有后门漏洞的主机，然后入侵系 统安装控制程序，入侵的越多，控制的僵尸主机就越多，攻击源就更多，然后把入侵的主机 分配，一部分充当攻击的主要控制端，一部分充当攻击源，各负其责，在攻击者统一指挥下 对被攻击的服务器发起攻击，由于这个攻击模式是在幕后操作，所以很难被监控系统跟踪， 身份不容易被发现。</li>
<li>两者异同：<ul>
<li>不同点：DDoS与DoS的最大区别是人多力量大。DoS是一台机器攻击目标，DDoS是被中央攻击中心控制的很多台机器利用他们的高带宽攻击目标，可更容易地将目标网站攻下。另外，DDoS攻击方式较为自动化，攻击者可以把他的程序安装到网络中的多台机器上，所采用的这种攻击方式很难被攻击对象察觉，直到攻击者发下统一的攻击命令，这些机器才同时发起进攻。可以说DDoS攻击是由黑客集中控制发动的一组DoS攻击的集合，现在这种方式被认为是最有效的攻击形式，并且非常难以抵挡。</li>
<li>相同点：无论是DoS攻击还是DDoS攻击，简单的看，都只是一种破坏网络服务的黑客方式，虽然具体的实现方式千变万化，但都有一个共同点，就是其根本目的是使受害主机或网络无法及时接收并处理外界请求，或无法及时回应外界请求。其具体表现方式有以下几种：<ul>
<li>制造大流量无用数据，造成通往被攻击主机的网络拥塞，使被攻击主机无法正常和外界通信。</li>
<li>利用被攻击主机提供服务或传输协议上处理重复连接的缺陷，反复高频的发出攻击性的重复服务请求，使被攻击主机无法及时处理其它正常的请求。</li>
<li>利用被攻击主机所提供服务程序或传输协议的本身实现缺陷，反复发送畸形的攻击数据引发系统错误的分配大量系统资源，使主机处于挂起状态甚至死机。</li>
</ul>
</li>
</ul>
</li>
<li>一个事实：目前的因特网不是设计来处理DDoS攻击的<h3 id="6-2-1-802-11b-DoS-bugs"><a href="#6-2-1-802-11b-DoS-bugs" class="headerlink" title="6.2.1 802.11b DoS bugs"></a>6.2.1 802.11b DoS bugs</h3>无线信号传输的特性和专门使用扩频技术，使得无线网络特别容易受到DoS攻击的威胁。拒绝服务是指攻击者恶意占用主机或网络几乎所有的资源，使得合法用户无法获得这些资源。黑客要造成这类的攻击：①通过让不同的设备使用相同的频率，从而造成无线频谱内出现冲突；②攻击者发送大量非法(或合法)的身份验证请求；③如果攻击者接管AP，并且不把通信量传递到恰当的目的地，那么所有的网络用户都将无法使用网络。无线攻击者可以利用高性能的方向性天线，从很远的地方攻击无线网。已经获得有线网访问权的攻击者，可以通过发送多达无线AP无法处理的通信量进行攻击<h3 id="6-2-2-放大式拒绝服务攻击"><a href="#6-2-2-放大式拒绝服务攻击" class="headerlink" title="6.2.2 放大式拒绝服务攻击"></a>6.2.2 放大式拒绝服务攻击</h3><h4 id="6-2-2-1-Smurf-amplification-attack"><a href="#6-2-2-1-Smurf-amplification-attack" class="headerlink" title="6.2.2.1 Smurf amplification attack"></a>6.2.2.1 Smurf amplification attack</h4><img src="/2021-12-05-14-31-09.png"></li>
<li>Smurf 攻击是一种分布式拒绝服务 (DDoS) 攻击，攻击者尝试使用 Internet 控制消息协议 (ICMP)数据包向目标服务器发起洪水攻击。攻击者使用目标设备的欺骗性 IP 地址向一个或多个计算机网络发出请求，计算机网络将响应目标服务器，因此会放大初始攻击流量并可能使目标不堪重负，使其无法访问。攻击媒介通常被认为是已解决的漏洞，并且不再普遍存在。</li>
<li>原理：ICMP 数据包的 ping 应用程序被网络管理员用于测试联网的硬件设备。但是由于ICMP协议不包括握手，因此接收请求的硬件设备无法验证请求是否合法。向网络广播地址发送ICMP请求（如ping），路由将请求转发给该网段下的所有机器。这个ICMP请求的源地址伪造为攻击目标，如果收到请求的机器都响应这个请求，大量的数据就会流向伪造的目标地址，此之谓“放大”。假如有大量的“肉鸡”或者说是僵尸网络服务器可以一起上，每个机器打满网卡速率放出请求，然后再进行一次放大，效果就完全不一样了。不过，现在一般都把路由配置为不转发这种ICMP给网段内的机器，所以这种攻击目前比较少了。</li>
<li>攻击方式：<ol>
<li>首先，Smurf 恶意软件构建一个欺骗性数据包，其源地址设置为目标受害者的真实 IP 地址。</li>
<li>然后，数据包被发送到路由器或防火墙的 IP 广播地址，后者将请求发送到广播网络内的每个主机设备地址，因此网络上联网设备有多少，就会增加多少个请求。</li>
<li>网络中的每个设备都接收来自广播设备的请求，然后使用 ICMP Echo Reply 数据包响应目标的欺骗性地址。</li>
<li>目标受害者随后收到大量的 ICMP Echo Reply 数据包，可能会不堪重负，并导致对合法流量拒绝服务。</li>
</ol>
</li>
<li>防御措施：<ul>
<li>阻塞 Smurf 攻击的源头。Smurf 攻击依靠攻击者的力量使用欺骗性源地址发送 echo 请求，用户可以使用路由器的访问控制来保证内部网络中发出的所有传输信息都具有合法的源地址，以防止这种攻击。</li>
<li>阻塞 Smurf 的反弹站点。用户可以有两种选择以阻塞 Smurf 攻击的反弹站点。第一种方法可以通过 ACL 阻止所有入站 echo 请求，这样可以防止这些分组到达自己的网络。如果不能阻塞所有入站 echo 请求，用户就需要让自己的路由器把网络广播地址映射成为 LAN 广播地址。<h4 id="6-2-2-2-DNS-amplification-attack"><a href="#6-2-2-2-DNS-amplification-attack" class="headerlink" title="6.2.2.2 DNS amplification attack"></a>6.2.2.2 DNS amplification attack</h4></li>
</ul>
</li>
<li>DNS放大攻击是基于反射的大规模分布式拒绝服务 (DDoS) 攻击，其中，攻击者利用开放 DNS 解析器的功能产生大量流量，使目标服务器或网络不堪重负，导致服务器及其周围基础设施无法访问。</li>
<li>原理：基本上大部分的放大攻击是攻击者通过许多请求然后将其放大以此来消耗目标Web资源间的带宽。通常黑客利用DNS服务器放大攻击的特性，使用受损的被控僵尸主机将带有欺骗性IP地址，然后利用DNS服务器向被攻击者返回查询的结果。通常查询应答数据包会比查询请求数据包大数倍。导致被攻击者的源服务器因为泛滥的流量而变得不堪重负，最终导致拒绝服务。</li>
<li>攻击步骤：<ol>
<li>攻击者使用受损的端点将有欺骗性 IP 地址的 UDP 数据包发送到 DNS 重定向器。数据包上的欺骗性地址指向受害者的真实 IP 地址。</li>
<li>每个 UDP 数据包都向 DNS 解析器发出请求，通常传递一个参数（例如“ANY”）以接收可能的最大响应。</li>
<li>收到请求后，试图通过响应来提供帮助的 DNS 解析器会向欺骗性 IP 地址发送较大的响应。</li>
<li>目标的 IP 地址接到响应，并且周围的网络基础设施被大量流量淹没，从而导致拒绝服务。</li>
</ol>
</li>
<li>防御措施：<ul>
<li>减少开放 DNS 解析器的总数：限制 DNS 解析器，使其仅响应来自可信源的查询或者关闭DNS服务器的递归查询；</li>
<li>源 IP 验证 - 阻止欺骗性数据包离开网络；</li>
<li>正确配置防火墙和网络容量；</li>
<li>增大链路带宽；</li>
<li>使用DDoS防御产品，将入口异常访问请求进行过滤清洗，然后将正常的访问请求分发给服务器进行业务处理。<h3 id="6-2-3-SYN-Floods"><a href="#6-2-3-SYN-Floods" class="headerlink" title="6.2.3 SYN Floods"></a>6.2.3 SYN Floods</h3>SYN报文指的是TCP协议中的Synchronize报文，是TCP三次握手过程中的首个报文。SYN Floods（半开连接攻击）是一种拒绝服务 (DDoS) 攻击，旨在耗尽可用服务器资源，致使服务器无法传输合法流量。通过重复发送初始连接请求 (SYN) 数据包，攻击者将可击垮目标服务器计算机上的所有可用端口，导致目标设备在响应合法流量时表现迟钝乃至全无响应。<h4 id="6-2-3-1-TCP三次握手过程"><a href="#6-2-3-1-TCP三次握手过程" class="headerlink" title="6.2.3.1 TCP三次握手过程"></a>6.2.3.1 TCP三次握手过程</h4><img src="/2021-12-05-15-29-26.png"></li>
</ul>
</li>
<li>开始建立连接时，客户端发送SYN报文到服务器，等待服务器确认。SYN报文的源IP地址和端口是客户端的IP地址和端口。</li>
<li>服务器收到SYN报文，回应一个SYN-ACK（Synchronize-Acknowledgement）报文。SYN-ACK报文的目的P地址和端口是客户端的IP地址和端口。</li>
<li>客户端收到服务器的SYN-ACK报文，向服务器发送ACK报文，服务器收到ACK报文后完成三次握手，TCP连接建立成功。</li>
</ul>
<p>在连接超时之前，服务器会一直等待ACK报文，此时该连接状态为半开放连接（也被称为半连接）。半连接会占用服务器的连接数，当连接数被占满时，服务器就无法提供正常的服务了。黑客正是通过这个机制来实现SYN Flood。<br><img src="/2021-12-05-15-32-41.png"></p>
<h4 id="6-2-3-2-SYN-Floods攻击步骤"><a href="#6-2-3-2-SYN-Floods攻击步骤" class="headerlink" title="6.2.3.2 SYN Floods攻击步骤"></a>6.2.3.2 SYN Floods攻击步骤</h4><ol>
<li>攻击者通常使用伪造的 IP 地址向目标服务器发送大量 SYN 数据包。</li>
<li>然后，服务器分别对每一项连接请求做出响应，并确保打开的端口做好接收响应的准备。</li>
<li>在服务器等待最后一个 ACK 数据包（永远不会到达）的过程中，攻击者将继续发送更多SYN数据包。每当有新的 SYN 数据包到达，服务器都会临时打开一个新的端口并在一段特定时间内保持连接；用遍所有可用端口后，服务器将无法正常运行。<h4 id="6-2-3-3-防御措施"><a href="#6-2-3-3-防御措施" class="headerlink" title="6.2.3.3 防御措施"></a>6.2.3.3 防御措施</h4></li>
</ol>
<ul>
<li>扩展积压工作队列；</li>
<li>回收最先创建的 TCP 半开连接；</li>
<li>采用SYN Cookie认证<ul>
<li>原理是在TCP服务器接收到TCP SYN包并返回TCP SYN + ACK包时，不分配一个专门的数据区，而是根据这个SYN包计算出一个cookie值。这个cookie作为将要返回的SYN ACK包的初始序列号。当客户端返回一个ACK包时，根据包头信息计算cookie，与返回的确认序列号(初始序列号 + 1)进行对比，如果相同，则是一个正常连接，然后，分配资源，建立连接。</li>
</ul>
</li>
<li>采用reset认证<ul>
<li>Reset认证利用的是TCP协议的可靠性，也是首先由DDOS防护系统来响应syn。防护设备收到syn后响应syn_ack,将Acknowledgement number (确认号)设为特定值（记为cookie）。当真实客户端收到这个报文时，发现确认号不正确，将发送reset报文，并且sequence number 为cookie + 1。 而伪造的源，将不会有任何回应。这样我们就可以将真实的客户端IP加入白名单。</li>
</ul>
</li>
<li>通常在实际应用中还会结合首包丢弃的方式结合源认证一起使用<ul>
<li>首包丢弃原理为：在DDOS防护设备收到syn报文后，记录5元组，然后丢弃。正常用户将重传syn报文，防护设备在收到报文命中5元组，并且在规定时间内，则转发。当重传syn报文到达一定阀值时，在启用上述的源认证。这样就能减少反射syn_ack报文的数量，缓解网络拥堵，同时对防护不产生影响。 <h3 id="6-2-4-DNS-Query-Flood"><a href="#6-2-4-DNS-Query-Flood" class="headerlink" title="6.2.4 DNS Query Flood"></a>6.2.4 DNS Query Flood</h3>UDP攻击是最容易发起海量流量的攻击手段，而且源IP随机伪造难以追查。但过滤比较容易，因为大多数IP并不提供UDP服务，直接丢弃UDP流量即可。所以现在纯粹的UDP流量攻击比较少见了，取而代之的是UDP协议承载的DNS Query Flood攻击。简单地说，越上层协议上发动的DDoS攻击越难以防御，因为协议越上层，与业务关联越大，防御系统面临的情况越复杂。</li>
</ul>
</li>
<li>攻击原理：DNS Query Flood就是攻击者操纵大量傀儡机器，对目标发起海量的域名查询请求。为了防止基于ACL的过滤，必须提高数据包的随机性。常用的做法是UDP层随机伪造源IP地址、随机伪造源端口等参数。在DNS协议层，随机伪造查询ID以及待解析域名。随机伪造待解析域名除了防止过滤外，还可以降低命中DNS缓存的可能性，尽可能多地消耗DNS服务器的CPU资源。</li>
<li>攻击手段：<ul>
<li>利用发包程序向DNS服务器发送不带任何负载的NULL数据包。由于数据包本身不符合协议规定，服务器在收到报文的时候将直接丢弃。因此这种攻击方式除非攻击流量比较大，否则不会有明显的效果。</li>
<li>利用程序构造DNS解析请求固定的域名，由于DNS服务器在解析请求的时候会在系统cache存放上一次解析的结果，这种攻击方式也需要较大的流量。</li>
<li>向DNS服务器发起解析请求随机的、不存在的域名；这样DNS服务器就需要进行频繁的字符串匹配，由于在本地无法查到对应的结果，服务器必须使用递归查询向上层域名服务器提交解析请求，引起连锁反应。目前尚没有防火墙能对DNS服务器的攻击进行防护，只有少数的专业防护设备可以做到。</li>
</ul>
</li>
<li>防御措施：<ul>
<li>在UDP Flood的基础上对 UDP DNS Query Flood 攻击进行防护；</li>
<li>根据域名 IP 自学习结果主动回应，减轻服务器负载(使用 DNS Cache)；</li>
<li>对突然发起大量频度较低的域名解析请求的源 IP 地址进行带宽限制? 在攻击发生时降低很少发起域名解析请求的源 IP 地址的优先级；</li>
<li>限制每个源 IP 地址每秒的域名解析请求次数。<h3 id="6-2-5-高层的DoS攻击"><a href="#6-2-5-高层的DoS攻击" class="headerlink" title="6.2.5 高层的DoS攻击"></a>6.2.5 高层的DoS攻击</h3><h4 id="6-2-5-1-Slow-HTTP-DoS"><a href="#6-2-5-1-Slow-HTTP-DoS" class="headerlink" title="6.2.5.1 Slow HTTP DoS"></a>6.2.5.1 Slow HTTP DoS</h4></li>
</ul>
</li>
<li>原理：HTTP慢速攻击是利用HTTP合法机制，以极低的速度往服务器发送HTTP请求，尽量长时间保持连接，不释放，若是达到了Web Server对于并发连接数的上限，同时恶意占用的连接没有被释放，那么服务器端将无法接受新的请求，导致拒绝服务。</li>
<li>防御：<ol>
<li>设置合适的 timeout 时间（Apache 已默认启用了 reqtimeout 模块），规定了 Header 发送的时间以及频率和 Body 发送的时间以及频率；</li>
<li>增大 MaxClients(MaxRequestWorkers)：增加最大的连接数。<h4 id="6-2-5-2-HTTP-Flood（CC攻击）"><a href="#6-2-5-2-HTTP-Flood（CC攻击）" class="headerlink" title="6.2.5.2 HTTP Flood（CC攻击）"></a>6.2.5.2 HTTP Flood（CC攻击）</h4>SYN Flood、DNS Query Flood在现阶段已经能做到有效防御了，真正令各大厂商以及互联网企业头疼的是HTTP Flood攻击。HTTP Flood是针对Web服务在第七层协议发起的攻击。它的巨大危害性主要表现在三个方面：发起方便、过滤困难、影响深远。</li>
</ol>
</li>
<li>攻击原理：攻击者通过代理或僵尸主机向目标服务器发起大量的HTTP报文，请求涉及数据库操作的URI（Universal Resource Identifier）或其它消耗系统资源的URI，造成服务器资源耗尽，无法响应正常请求。例如门户网站经常受到的HTTP Flood攻击，攻击的最大特征就是选择消耗服务器CPU或内存资源的URI，如具有数据库操作的URI。</li>
<li>区别：这个攻击类型和一种CC攻击（Challenge Collapsar）有点像，两者区别就在于一个是耗系统资源，一个是发送大量数据包消耗服务器资源，都是打的持续仗，最终使服务器无法响应正常请求为止。</li>
<li>防御：<ul>
<li>URI监测：URI监测是HTTP源认证防御的补充功能，当通过HTTP源认证的流量是超过阈值时，可以启用URI监测。</li>
<li>URI源指纹学习功能：适用于攻击源访问的URI比较固定。因为如果要形成攻击效果，攻击者一般都事先探测，找到容易消耗系统资源的URI作为攻击目标，然后一个攻击源的一个会话上会有多个针对该URI的请求，最终呈现为该源对选定的URI发送大量的请求报文。</li>
<li>HTTP Flood源认证：源认证防御方式是防御HTTP Flood最常用的手段，这种防御方式适用于客户端为浏览器的HTTP服务器场景，因为浏览器支持完整的HTTP协议，可以正常回应重定向报文或者是验证码。源认证防御主要包含以下三种方式：基本模式（META刷新）、增强模式（验证码认证）、302重定向模式。</li>
<li>HTTP源统计：HTTP源统计是在基于目的IP流量异常的基础上，再启动针对源IP流量进行统计。Anti-DDoS设备首先对到达目的IP的流量进行统计，当目的IP流量触发告警阈值时，再启动到达这个目的IP的每个源的流量进行统计，判定具体某个源流量异常，并对源IP的流量进行限速。HTTP源统计功能可以更准确的定位异常源，并对异常源发出的流量进行限速。</li>
<li>对发出请求的设备实施质询，以测试它是否属于机器人；</li>
<li>使用 Web 应用程序防火墙(WAF)；</li>
<li>管理 IP 信誉数据库以跟踪和有选择地阻止恶意流量。<h4 id="6-2-5-3-SSL-D-DoS"><a href="#6-2-5-3-SSL-D-DoS" class="headerlink" title="6.2.5.3 SSL-(D)DoS"></a>6.2.5.3 SSL-(D)DoS</h4></li>
</ul>
</li>
<li>原理：SSL握手的过程中，在协商加密算法时服务器CPU的开销是客户端开销的15倍左右。攻击者利用这一特点，在一个TCP连接中不停地快速重新协商（这种行为是被SSL所允许的），从而耗尽服务器CPU资源，这种攻击叫做SSL-DoS。如果多个僵尸主机向服务器发起SSL-DoS，则叫做SSLDDoS攻击。</li>
<li>防御：对SSL连接中的所有报文进行检查，如果其不符合ssl报文规格，则丢弃该报文并对源ip进行封禁；对源ip或者一条ssl连接内的协商报文速率进行统计，如果协商报文速率异常，则丢弃该连接的所有报文。<h3 id="6-2-6-DoS防御的方法"><a href="#6-2-6-DoS防御的方法" class="headerlink" title="6.2.6 DoS防御的方法"></a>6.2.6 DoS防御的方法</h3><h4 id="6-2-6-1-Client-Puzzles"><a href="#6-2-6-1-Client-Puzzles" class="headerlink" title="6.2.6.1 Client Puzzles"></a>6.2.6.1 Client Puzzles</h4></li>
<li>原理：当遭受攻击时，攻击方必须提交有一定难度的谜题解决方案与请求，使攻击放慢</li>
<li>举例：<br><img src="/2021-12-05-17-47-58.png"></li>
<li>局限性：<ul>
<li>需要对客户端和服务器进行更改</li>
<li>被攻击期间会损坏低权利合法用户，而且客户端在手机上、PDA上时无法连接<h4 id="6-2-6-2-CAPTCHAs"><a href="#6-2-6-2-CAPTCHAs" class="headerlink" title="6.2.6.2 CAPTCHAs"></a>6.2.6.2 CAPTCHAs</h4>被攻击时生成验证码，只处理有效的解决方案，每个源IP地址提供一个验证码，确认连接来自人类。<h4 id="6-2-6-3-Source-Identification"><a href="#6-2-6-3-Source-Identification" class="headerlink" title="6.2.6.3 Source Identification"></a>6.2.6.3 Source Identification</h4></li>
</ul>
</li>
<li>目的:识别数据包来源</li>
<li>最终目标:从源头阻止攻击</li>
<li>方法：<ul>
<li>入口过滤：ISP只转发源IP合法的报文。(参见SAVE协议)</li>
<li>溯源：溯源技术通常被分为两大类:主动溯源和被动溯源。其中,主动溯源是在报文传输过程中标记报文信息,攻击一旦发生,管理人员就能够利用这些信息去跟踪路由路径并确定攻击源。被动溯源是在判断攻击发生之后才开始采取措施,使用工具分析流量情况等信息进行溯源。常见的溯源方案有以下四种:<ul>
<li>链路测试技术是逐跳地对路由器进行测试以重建攻击路径。在传统网络中,通常需要安装一个跟踪程序,如DoS Tracker,到靠近攻击者的路由器中,监视传入的数据包,找到攻击路径的上一跳,重复该过程,逐跳回溯,直到找到攻击源。</li>
<li>日志记录技术是在中转设备上存储途经它的报文信息,在需要处理时,使用大数据分析技术对海量数据进行分析,来达到寻找攻击源的目的。</li>
<li>基于ICMP的报文技术由Bellovin提出;数据包在通过路由器时以一定概率生成ICMP traceback(iTrace)消息, 一个iTrace消息由下一跳信息、上一跳信息以及一个时间戳组成,目的主机收到足够数量的iTrace消息后,能构造出消息的转发路径。</li>
<li>概率包标记技术使用IP分组头部的某些字段,向字段中添加路径信息;这种方法与ICMP溯源法类似,受害者收到足够的分组后重构攻击路径;该方法相对于基于ICMP的报文技术的优势在于不需要生成新的特殊报文。<h4 id="6-2-6-4-其他方法"><a href="#6-2-6-4-其他方法" class="headerlink" title="6.2.6.4 其他方法"></a>6.2.6.4 其他方法</h4></li>
</ul>
</li>
</ul>
</li>
<li>确保服务器的系统文件是最新的版本,并及时更新系统补丁；</li>
<li>关闭不必要的服务；</li>
<li>正确设置防火墙：禁止对主机的非开放服务的访问，限制特定IP地址的访问，启用防火墙的防DDoS的属性，严格限制对外开放的服务器的向外访问，运行端口映射程序祸端口扫描程序；</li>
<li>认真检查网络设备和主机&#x2F;服务器系统的日志；</li>
<li>限制在防火墙外与网络文件共享；</li>
<li>充分利用网络设备保护网络资源：利用路由器、防火墙等负载均衡设备保护网络；</li>
<li>用足够的机器承受黑客攻击；</li>
<li>检查访问者的来源：通过反向路由器查询的方法检查访问者的IP地址是否是真,如果是假的,它将予以屏蔽。</li>
</ul>
<h1 id="七、网络边界安全防御"><a href="#七、网络边界安全防御" class="headerlink" title="七、网络边界安全防御"></a>七、网络边界安全防御</h1><h2 id="7-1-防火墙"><a href="#7-1-防火墙" class="headerlink" title="7.1 防火墙"></a>7.1 防火墙</h2><h3 id="7-1-1-包过滤防火墙（分组过滤）"><a href="#7-1-1-包过滤防火墙（分组过滤）" class="headerlink" title="7.1.1 包过滤防火墙（分组过滤）"></a>7.1.1 包过滤防火墙（分组过滤）</h3><p>课本P303 12.3.1包过滤防火墙<br><img src="/2021-12-06-10-43-09.png"></p>
<ul>
<li>分组过滤是一种访问控制机制，它控制哪些数据包可以进出网络而哪些数据包应被网络拒绝。</li>
<li>分组过滤技术可以处理<strong>网络层</strong>的数据包<ul>
<li>因此依据源IP地址、目标IP地址、源端口、目标端口、包类型等IP包头信息，允许或拒绝IP包通过</li>
<li>五元组：源IP地址，源端口，目的IP地址，目的端口，和传输层协议</li>
</ul>
</li>
<li>包过滤技术的优点<ul>
<li>简单、易于使用，实现成本低。</li>
<li>处理开销小，因此对使用该技术的防火墙系统的性能影响不大。</li>
</ul>
</li>
<li>分组过滤技术的缺点<ul>
<li>当过滤规则较多时，对过滤规则表的管理和维护较为麻烦</li>
<li>无法识别入侵</li>
<li>无法识别恶意代码</li>
<li>易遭受IP地址欺骗<h3 id="7-1-2-有状态的动态包过滤"><a href="#7-1-2-有状态的动态包过滤" class="headerlink" title="7.1.2 有状态的动态包过滤"></a>7.1.2 有状态的动态包过滤</h3>课本P306 12.3.2状态检测防火墙<br><img src="/2021-12-06-10-43-46.png"></li>
</ul>
</li>
<li>状态的含义<ul>
<li>在TCP&#x2F;IP协议中，状态是指协议过去执行的历史信息。<ul>
<li>例如，对于TCP而言，要进行数据通信，必须建立三次握手，因此对于使用TCP进行数据传输的应用来说，TCP的三次握手所建立的连接信息就是其状态。</li>
</ul>
</li>
<li>在TCP&#x2F;IP协议族中，有些协议是有状态的协议（如TCP协议等），有些协议是无状态协议（如UDP协议等)。</li>
</ul>
</li>
<li>具体有哪些状态信息<ul>
<li>网络通信信息<ul>
<li>所有TCP&#x2F;IP协议的当前信息</li>
</ul>
</li>
<li>网络通信状态<ul>
<li>以前的网络通信信息</li>
<li>例如，同样对于FTP而言，可以记录FTP请求的服务器地址和端口、客户端地址和为此次FTP临时打开的端口</li>
</ul>
</li>
<li>应用状态<ul>
<li>应用程序的信息</li>
<li>例如，已经通过防火墙认证的用户可以通过防火墙访问其他授权的服务</li>
</ul>
</li>
<li>操作信息<ul>
<li>例如，已经通过防火墙认证的用户可以通过防火墙访问其他授权的服务</li>
<li>构造更加复杂、更灵活、实用性强的策略规则</li>
</ul>
</li>
</ul>
</li>
<li>状态如何记录和保存<ul>
<li>可以根据连接的状态存储方式连接<ul>
<li>是完成的一次回话</li>
</ul>
</li>
<li>一般采用连接状态表来存放状态信息<ul>
<li>连接状态表，就是存放协议历史信息的信息表</li>
</ul>
</li>
</ul>
</li>
<li>如何获得无状态协议的状态信息<ul>
<li>对于无连接的应用（如UDP协议），状态检测技术通过虚连接的方法来建立其状态信息。</li>
<li>虚连接:为保存协议的状态信息而虚构的网络连接<ul>
<li>例如，对于基于UDP应用的安全需求，状态检测技术通过在UDP通信之上保持一个虚拟连接</li>
<li>保存通过防火墙的每一个虚连接的状态信息，允许穿过防火墙的UDP请求包被记录</li>
<li>当UDP包在相反方向上通过时，则可以依据连接状态表确定该UDP包是否被授权的，若已被授权，则通过，否则拒绝。</li>
<li>典型的状态信息包括超时检测、是否有以前的UDP数据包通过等</li>
</ul>
</li>
</ul>
</li>
<li>状态包过滤技术的优点：<br>安全性好、灵活性强、扩展性好、应用范围广</li>
<li>状态包过滤技术的缺点：<br>计算开销大、处理速度慢、规则管理复杂<h3 id="7-1-3-应用层防火墙"><a href="#7-1-3-应用层防火墙" class="headerlink" title="7.1.3 应用层防火墙"></a>7.1.3 应用层防火墙</h3>课本P307 12.3.3应用层网关<br><img src="/2021-12-06-10-57-08.png"></li>
<li>代理技术：某个应用为另外一个应用获得某项服务。例如，用户A可以委托主机B帮助它从外部下载某个文件或访问某个网站。<br><img src="/2021-12-06-11-20-52.png"></li>
<li>·应用代理技术的优点<ul>
<li>提供更高层次的安全性</li>
<li>易于审计</li>
<li>有助于提高访问速度</li>
<li>具备细粒度的过滤检测</li>
<li>隐蔽性较强</li>
</ul>
</li>
<li>应用代理技术的缺点：处理开销大、扩展性弱、使用不便<h3 id="7-1-4-包碎片攻击"><a href="#7-1-4-包碎片攻击" class="headerlink" title="7.1.4 包碎片攻击"></a>7.1.4 包碎片攻击</h3>课本P306 细小帧攻击</li>
<li>原理：碎片包能被用来在一些防火墙上传播拥堵的规则。 这通过碎片偏移的值来欺骗完成。做法是设置在第二个包设置碎片偏移非常低,而不让第二个包紧跟着延续第一个包, 它实际上覆盖了数据和第一个包的TCP头部分。</li>
<li>攻击过程<ul>
<li>假设你想要登录到一个网络里,而它的tcp端口23是被包过滤防火墙禁止的。但是,smtp端口25是被允许访问的。你所要做的就是发送两个包:<ul>
<li>第一个包是:<ul>
<li>碎片偏移为0</li>
<li>DF位为0意味着”可被碎片的”</li>
<li>MF位为1意味着“更多的碎片”</li>
<li>TCP头里的目标端口25被允许,防火墙将允许包进入网络。</li>
</ul>
</li>
<li>第二个包是:<ul>
<li>碎片偏移为1, 意味着第二个包实际上将覆盖除了第一个包的前8位的所有数据</li>
<li>DF位为0意味着“可被碎片的”</li>
<li>MF位为0意味着“最后的碎片”</li>
<li>TCP头里的目标端口23。通常会被禁止,但这个案例中不会。</li>
</ul>
</li>
</ul>
</li>
<li>包过滤防火墙看到在第二个数据包里碎片偏移比0大。从这个数据里,它将推论第二个包是另一个包的碎片,将不会再次检查规则设定。</li>
</ul>
<p>  -当两个包到达目标主机,它们将重新组合。第二个包将覆盖第一个包的大部分,组合的包的内容将去向端口23。</p>
<h3 id="7-1-5-防火墙的部署"><a href="#7-1-5-防火墙的部署" class="headerlink" title="7.1.5 防火墙的部署"></a>7.1.5 防火墙的部署</h3><h4 id="7-1-5-1-屏蔽主机结构"><a href="#7-1-5-1-屏蔽主机结构" class="headerlink" title="7.1.5.1 屏蔽主机结构"></a>7.1.5.1 屏蔽主机结构</h4><p><img src="/2021-12-06-13-57-35.png"></p>
</li>
<li>原理：<br>通过一个单独的路由器和内部网络上的堡垒主机共同构成防火墙，主要通过数据包过滤实现内外网络的隔离和对内网的保护。</li>
<li>优点：<ol>
<li>能提供比单纯的过滤路由器和双重宿主主机更高的安全性；</li>
<li>支持多种网络服务的深层过滤，并具有相当的可扩展性；</li>
<li>系统本身稳固可靠。保护简单配置的路由器比保护一台主机要容易的多；</li>
<li>对内部网络有一定的隐蔽性；</li>
<li>成本比较低。</li>
</ol>
</li>
<li>缺点：<ol>
<li>堡垒主机和其它内网主机放在一起，它们之间没有一道安全隔离屏障缺少防范内部欺骗的能力；</li>
<li>过滤路由器容易受到攻击。内联网络的安全性维系在相对脆弱的路由表上。<h4 id="7-1-5-2-屏蔽子网结构"><a href="#7-1-5-2-屏蔽子网结构" class="headerlink" title="7.1.5.2 屏蔽子网结构"></a>7.1.5.2 屏蔽子网结构</h4><img src="/2021-12-06-14-03-15.png"></li>
</ol>
</li>
<li>原理：在内部网络和外部网络之间建立一个被隔离的子网，用两台分组过滤路由器将这一子网分别与内部网络和外部网络分开。在很多实现中，两个分组过滤路由器放在子网的两端，在子网内构成一个“非军事区”DMZ。有的屏蔽子网中还设有一堡垒主机作为唯一可访问点，支持终端交互或作为应用网关代理。</li>
<li>优点：<ol>
<li>内联网络实现了与外联网络的隔离，内部结构无法探测，外联网络只能知道到外部路由器或非军事区的存在，而不知道内部路由器的存在，也就无法探测到内部网络路由器后面的内部网络。</li>
<li>内联网络安全防护严密。</li>
<li>降低了堡垒主机处理的负载量，减轻了堡垒主机的压力，增强了堡垒主机的可靠性和安全性。</li>
<li>非军事区的划分将用户网络的信息流量明确地分为不同的等级，通过内部路由器的隔离作用，机密信息流受到严密的保护，减少了信息泄漏现象的发生。</li>
</ol>
</li>
<li>缺点<ul>
<li>成本高</li>
<li>配置复杂<h4 id="7-1-5-3-双宿主机结构"><a href="#7-1-5-3-双宿主机结构" class="headerlink" title="7.1.5.3 双宿主机结构"></a>7.1.5.3 双宿主机结构</h4><img src="/2021-12-06-14-08-39.png"></li>
</ul>
</li>
<li>原理：用一台装有两个网络适配器的双宿主机做防火墙。双宿主机用两个网络适配器分别连接两个网络，又称堡垒主机（Bastion Host）。堡垒主机上运行着防火墙软件（通常是代理服务器），可以转发应用程序，提供服务等。</li>
<li>堡垒主机可以充当与这些接口相连的网络之间的路由器，在网络之间发送数据包。而一般情况下双宿主机的路由功能是被禁止的，因而能够隔离内部网络与外部网络之间的直接通信，从而起到保护内部网络的作用。<ul>
<li>双宿主机结构采用主机替代路由器执行安全控制功能，故类似于包过滤防火墙。双宿主机即一台配有多个网络接口的主机，它可以用来在内部网络和外部网络之间进行寻径。如果在一台双宿主机中寻径功能被禁止了，则这个主机可以隔离与它相连的内部网络和外部网络之间的通信，而与它相连的内部和外部网络都可以执行由它所提供的网络应用，如果这个应用允许的话，它们就可以共享数据。这样就保证内部网络和外部网络的某些节点之间可以通过双宿主机上的共享数据传递信息，但内部网络与外部网络之间却不能传递信息，从而达到保护内部网络的作用。</li>
</ul>
</li>
<li>优点：<ul>
<li>成本低：由于只需要一台具备包过滤的路由器或一台能够执行包过滤的防火墙，因此价格低廉。</li>
<li>管理简单：结构简单，不需要复杂的配置，易于管理和维护。</li>
</ul>
</li>
<li>缺点：<ul>
<li>安全性低：如果包过滤路由器是唯一的安全设备，那么黑客们将非常容易地攻破系统，在局域网里为所欲为。</li>
<li>过滤规则简单：只能通过网络层信息来进行过滤，无法提供复杂的过滤规则。此外，随着过滤规则数目的增加，防火墙本身的性能会受到影响。</li>
<li>缺少审计和报警机制：大多数过滤器中缺少审计和报警机制。</li>
<li>隐蔽性差：采用这种结构的防火墙系统，内部网络的IP地址并没有被隐藏起来，并且它不具备监测，跟踪和记录的功能。</li>
</ul>
</li>
</ul>
<h2 id="7-2-入侵检测"><a href="#7-2-入侵检测" class="headerlink" title="7.2 入侵检测"></a>7.2 入侵检测</h2><ul>
<li>入侵检测：对入侵行为(任何企图破坏资源的完整性、保密性和有效性的行为)的发觉。</li>
<li>入侵检测系统（IDS）：入侵检测系统通过监视受保护系统的状态和活动，采用异常检测或滥用检测的方式，发现非授权的或恶意的系统及网络行为，为防范入侵行为提供有效的手段，是一个完备的网络安全体系的重要组成部分。入侵检测的软件与硬件的组合，是防火墙的合理补充，是防火墙之后的第二道安全闸门。</li>
<li>入侵检测流程：信息收集、信息分析、结果处理</li>
<li>入侵检测的分类：<ol>
<li>按照分析方法&#x2F;检测原理分类：异常检测、滥用检测</li>
<li>按照数据来源分类：基于主机（HIDS）、基于网络（NIDS）、混合型</li>
<li>按照系统体系结构：集中式；分布式</li>
<li>按照工作方式：离线检测；在线检测</li>
<li>按照时间：实时；定时（事后入侵检测）</li>
</ol>
</li>
<li>入侵检测的工作过程<br><img src="/2021-12-06-16-45-35.png"><h3 id="7-2-1-IDS的基本结构"><a href="#7-2-1-IDS的基本结构" class="headerlink" title="7.2.1 IDS的基本结构"></a>7.2.1 IDS的基本结构</h3><img src="/2021-12-06-16-44-27.png"></li>
<li>事件产生器：负责原始数据采集，并将收集到的原始数据转换为事件，向系统的其他部分提供此事<br>件。<ul>
<li>收集的信息包括：系统或网络的日志文件；[网络流量；系统目录和文件的异常变化；程序执行中的异常行为。</li>
<li>注意：入侵检测很大程度上依赖于收集信息的可靠性和正确性。</li>
</ul>
</li>
<li>事件分析器：接收事件信息，对其进行分析，判断是否为入侵行为或异常现象，最后将判断的结果转变为告警信息。分析方法有如下三种：<ol>
<li>模式匹配：将收集到的信息与已知的网络入侵和系统误用模式数据库进行比较，从而发现违背安全策略的行为。</li>
<li>统计分析：首先给系统对象（如用户、文件、目录和设备等）创建一个统计描述，统计正常使用时的一些测量属性（如访问次数、操作失败次数和延时等）；测量属性的平均值和偏差将被用来与网络、系统的行为进行比较，任何观察值在正常值范围之外时，就认为有入侵发生。</li>
<li>完整性分析（往往用于事后分析）：主要关注某个文件或对象是否被更改。</li>
</ol>
</li>
<li>事件数据库：存放各种中间和最终数据的地方。</li>
<li>响应单元：根据告警信息做出反应。（强烈反应：切断连接、改变文件属性等；简单的报警）<h3 id="7-2-2-滥用检测"><a href="#7-2-2-滥用检测" class="headerlink" title="7.2.2 滥用检测"></a>7.2.2 滥用检测</h3>滥用检测是根据己知的攻击方法,预先定义入侵特征，通过判断特征是否出现来完成检测任务。</li>
<li>原理：基于模式匹配。收集非正常操作的行为特征，建立相关的特征库，当监测的用户或系统行为与库中的记录相匹配时，系统就认为这种行为是入侵。</li>
<li>技术：模式匹配技术，专家系统，特征分析方法，Petri网、状态转移分析</li>
<li>前提：所有的入侵行为都有可被检测到的特征。</li>
<li>指标：误报低、漏报高。</li>
<li>攻击特征库：当监测的用户或系统行为与库中的记录相匹配时，系统就认为这种行为是入侵。</li>
<li>特点：采用模式匹配，滥用模式能明显降低误报率，但漏报率随之增加。攻击特征的细微变化，会使得滥用检测无能为力。<h4 id="7-2-2-1-专家系统滥用检测"><a href="#7-2-2-1-专家系统滥用检测" class="headerlink" title="7.2.2.1 专家系统滥用检测"></a>7.2.2.1 专家系统滥用检测</h4></li>
<li>原理：通过将安全专家的知识表示成If－Then结构的规则（if部分：构成入侵所要求的条件；then部分：发现入侵后采取的相应措施）形成专家知识库，然后运用推理算法检测入侵。</li>
<li>注意：需要解决的主要问题是处理序列数据和知识库的维护（只能检测已知弱点）。<h4 id="7-2-2-2-状态转换分析滥用检测"><a href="#7-2-2-2-状态转换分析滥用检测" class="headerlink" title="7.2.2.2 状态转换分析滥用检测"></a>7.2.2.2 状态转换分析滥用检测</h4></li>
<li>原理：将入侵过程看作一个行为序列，该行为序列导致系统从初始状态转入被入侵状态。分析时，需要针对每一种入侵方法确定系统的初始状态和被入侵状态，以及导致状态转换的转换条件（导致系统进入被入侵状态必须执行的操作&#x2F;特征事件）；然后用状态转换图来表示每一个状态和特征事件。</li>
<li>缺点：不善于分析过分复杂的事件，也不能检测与系统状态无关的入侵<h3 id="7-2-3-异常检测"><a href="#7-2-3-异常检测" class="headerlink" title="7.2.3 异常检测"></a>7.2.3 异常检测</h3>异常检测是根据用户的行为或资源的使用状况的正常程度来判断是否属于入侵。</li>
<li>原理：基于统计分析。首先总结正常操作应该具有的特征（用户轮廓），试图用定量的方式加以描述，当用户活动与正常行为有重大偏离时即被认为是入侵。</li>
<li>技术：统计分析，神经网络，数据挖掘方法</li>
<li>前提：入侵是异常活动的子集。指标：漏报率低，误报率高。</li>
<li>用户轮廓：通常定义为各种行为参数及其阀值的集合，用于描述正常行为范围。</li>
<li>特点：异常检测系统的效率取决于用户轮廓的完备性和监控的频率；不需要对每种入侵行为进行定义，因此能有效检测未知的入侵；系统能针对用户行为的改变进行自我调整和优化，但随着检测模型的逐步精确，异常检测会消耗更多的系统资源。<h4 id="7-2-3-1-概率统计异常检测"><a href="#7-2-3-1-概率统计异常检测" class="headerlink" title="7.2.3.1 概率统计异常检测"></a>7.2.3.1 概率统计异常检测</h4></li>
<li>原理：每一个轮廓保存记录主体当前行为，并定时将当前轮廓与历史轮廓合并形成统计轮廓（更新），通过比较当前轮廓与统计轮廓来判定异常行为。</li>
<li>优点：可应用成熟的概率统计理论</li>
<li>缺点：①由于用户行为的复杂性，要想准确地匹配一个用户的历史行为非常困难，容易造成系统误报和漏报；②定义入侵阈值比较困难，阈值高则误报率提高，阈值低则漏报率增高。<h4 id="7-2-3-2-神经网络异常检测"><a href="#7-2-3-2-神经网络异常检测" class="headerlink" title="7.2.3.2 神经网络异常检测"></a>7.2.3.2 神经网络异常检测</h4></li>
<li>原理：对下一事件的预测错误率在一定程度上反映了用户行为的异常程度。</li>
<li>优点：①更好地表达了变量间的非线性关系，能更好地处理原始数据的随机特征，即不需要对这些数据做任何统计假设，并且能自动学习和更新；②有较好的抗干扰能力</li>
<li>缺点：网络拓扑结构以及各元素的权重很难确定<h3 id="7-2-4-基于主机的入侵检测（HIDS）"><a href="#7-2-4-基于主机的入侵检测（HIDS）" class="headerlink" title="7.2.4 基于主机的入侵检测（HIDS）"></a>7.2.4 基于主机的入侵检测（HIDS）</h3>检测主机特征和该主机发生的与可疑活动相关的时间</li>
<li>基于主机的入侵检测系统通常被安装在被保护的主机上，对该主机的网络实时连接以及系统审计日志进行分析和检查，当发现可疑行为和安全违规事件时，系统就会向管理员报警，以便采取措施。这些受保护的主机可以是Web服务器、邮件服务器、DNS服务器等关键主机设备。</li>
<li>主机的数据源：操作系统事件日志、应用程序日志系统日志、关系数据库、Web服务器。</li>
<li>检测内容：系统调用、端口调用、系统日志、安全审记、应用日志。</li>
<li>优点：<ul>
<li>检测精度高。HIDS针对用户和系统活动进行检测,更适用于检测内部用户攻击或越权行为。不受加密和交换设备影响。</li>
<li>HIDS只关注主机本身发生的事件，并不关心主机之外的网络事件，所以检测性能不受数据加密、隧道和交换设备影响。不受网络流量影响。</li>
<li>HIDS并不采集网络数据包，不会因为网络流量增加而丢失对系统行为的监视，故其检测性能与网络流量无关。</li>
</ul>
</li>
<li>缺点 ：<ul>
<li>HIDS安装在需要保护的主机上，必然会占用主机系统资源，额外负载将降低应用系统的效率。</li>
<li>HIDS完全依赖操作系统固有的审计机制，所以必须与操作系统紧密集成，导致平台的可移植性差。</li>
<li>HIDS本身的健壮性也受到主机操作系统安全性的限制。</li>
<li>HIDS只能检测针对本机的攻击，而不能检测基于网络协议的攻击。<h3 id="7-2-5-基于网络的入侵检测（NIDS）"><a href="#7-2-5-基于网络的入侵检测（NIDS）" class="headerlink" title="7.2.5 基于网络的入侵检测（NIDS）"></a>7.2.5 基于网络的入侵检测（NIDS）</h3>检测特定网段或设备的流量并分析网络、传输和应用协议，用以识别可疑的活动</li>
</ul>
</li>
<li>安装在需要保护的网段中，实时监视网段中传输的各种数据包，并对这些数据包进行分析和检测。如果发现入侵行为或可疑事件，入侵检测系统就会发出警报甚至切断网络连接。可以检测网络层、传输层、应用层协议的活动。</li>
<li>优点： <ul>
<li>检测与响应速度快。NIDS能够在成功入侵之前发现攻击和可疑意图，在攻击目标遭受破坏之前即可执行快速响应中止攻击过程。</li>
<li>入侵监视范围大。由于每个网络传感器能够采集共享网段内的所有数据包，一个网络传感器就可以保护一个网段。因此，只在网络关键路径上安装网络传感器，就可以监视整个网络通信。</li>
<li>入侵取证可靠。NIDS通过捕获数据包收集入侵证据，攻击者无法转移证据。</li>
<li>能够检测协议漏洞攻击。许多攻击程序是基于网络协议漏洞编写的，诸如同步洪流（SYN flood）、Smurf攻击和泪滴攻击（teardrop）等只有通过查看数据包头或有效负载才能识别。</li>
</ul>
</li>
<li>缺点：<ul>
<li>网络的局限。只能检测经过本网段的活动，且精确度较差。在交换式网络环境下会出现检测范围的局限且难以配置，防入侵欺骗的能力也比较差。无法知道主机内的安全情况。</li>
<li>检测方法局限。难以审查处理加密的数据流的内容，对主机上执行的命令也难以检测。对重放攻击无能为力。<h3 id="7-2-6-snort的结构"><a href="#7-2-6-snort的结构" class="headerlink" title="7.2.6 snort的结构"></a>7.2.6 snort的结构</h3></li>
</ul>
</li>
<li>Snort是最流行的免费NIDS。Snort是基于滥用&#x2F;异常检测的IDS，使用规则的定义来检查网络中的问题数<br>据包。</li>
<li>设计遵守轻量级的网络入侵检测系统，基于 Libpcap 的报文嗅探接口，基于规则的检测引擎和支持无限扩展的插件系统，支持 BPF 过滤规则。<br><img src="/2021-12-06-17-31-15.png"><h4 id="7-2-6-1-snort的组成"><a href="#7-2-6-1-snort的组成" class="headerlink" title="7.2.6.1 snort的组成"></a>7.2.6.1 snort的组成</h4></li>
<li>数据包嗅探模块：负责监听网络数据包，对网络进行分析；</li>
<li>预处理模块：该模块用相应的插件来检查原始数据包，从中发现原始数据的“行为”，如端口扫描，IP 碎片等，数据包经过预处理后才传到检测引擎；</li>
<li>检测模块：该模块是Snort的核心模块。当数据包从预处理器送过来后，检测引擎依据预先设置的规则检查数据包，一旦发现数据包中的内容和某条规则相匹配，就通知报警模块；</li>
<li>输出报警模块：经检测引擎检查后的Snort数据需要以某种方式输出。如果检测引擎中的某条规则被匹配，则会触发一条报警，这条报警信息会通过网络、UNIXsocket、WindowsPopup(SMB)、SNMP 协议的 trap 命令传送给日志文件，甚至可以将报警传送给第三方插件（如SnortSam），另外报警信息也可以记入 SQL 数据库。<h4 id="7-2-6-2-snort的三种工作方式"><a href="#7-2-6-2-snort的三种工作方式" class="headerlink" title="7.2.6.2 snort的三种工作方式"></a>7.2.6.2 snort的三种工作方式</h4>三大基本功能：嗅探器、数据包记录器和入侵检测。</li>
<li>嗅探器模式仅从网络上读取数据包并作为连续不断的流显示在终端上，常用命令：snort -dev。</li>
<li>数据包记录器模式是把数据包记录到硬盘上，常用命令：snort -b。</li>
<li>网络入侵检测模式是最复杂的，而且是可配置的。我们可以让Snort分析网络数据流以匹配用户定义的一些规则，并根据检测结果采取一定的动作。<h4 id="7-2-6-3-snort规则"><a href="#7-2-6-3-snort规则" class="headerlink" title="7.2.6.3 snort规则"></a>7.2.6.3 snort规则</h4>Snort的每条规则都可以分成逻辑上的两个部分：规则头和规则体。规则头包括4个部分：规则行为；协议；源信息；目的信息。<br><img src="/2021-12-06-18-37-20.png"></li>
<li>Snort预置的规则动作有5种：（此外，用户还可以定制自己的类型）<ul>
<li>pass——动作选项pass将忽略当前的包，后继捕获的包将被继续分析。</li>
<li>log——动作选项log将按照自己配置的格式记录包。</li>
<li>alert——动作选项alert将按照自己配置的格式记录包，然后进行报警。它的功能强大，但是必须恰当的用，因为如果报警记录过多，从中攫取有效信息的工作量增大，反而会使安全防护工作变得低效。</li>
<li>dynamic——动作选项dynamic是比较独特的一种，它保持在一种潜伏状态，直到activate类型的规则将其触发，之后它将像log动作一样记录数据包。</li>
<li>activate——动作选项activate功能强大，当被规则触发时生成报警，并启动相关的dynamic类型规则。在检测复杂的攻击，或对数据进行归类时，该动作选项相当有用。</li>
</ul>
</li>
<li>规则体的作用是在规则头信息的基础上进一步分析，有了它才能确认复杂的攻击。Snort的规则定义中可以没有规则体。规则体由若干个被分别隔开的片断组成，每个片断定义了一个选项和相应的选项值。一部分选项是对各种协议的详细说明，包括IP、ICMP和TCP协议，其余的选项是：规则触发时提供给管理员的参考信息，被搜索的关键字，Snort规则的标识和大小写不敏感选项。</li>
<li>举例：<br><img src="/2021-12-06-18-41-37.png"><br>方向操作符-&gt;表示数据包的流向。它左边的数据包分别是源地址和源端口，目的地址和目的端口。</li>
</ul>
<h1 id="八、Web应用安全"><a href="#八、Web应用安全" class="headerlink" title="八、Web应用安全"></a>八、Web应用安全</h1><h2 id="8-1-命令注入"><a href="#8-1-命令注入" class="headerlink" title="8.1 命令注入"></a>8.1 命令注入</h2><h3 id="8-1-1-方法"><a href="#8-1-1-方法" class="headerlink" title="8.1.1 方法"></a>8.1.1 方法</h3><p>利用可以调用系统命令的web应用，通过构造特殊命令字符串的方式，把恶意代码输入一个编辑域（例如缺乏有效验证的输入框）来改变网页动态生成的内容，最终实现本应在服务端才能工作的系统命令。一个恶意黑客可以利用这种攻击方法来非法获取数据或者网络资源。</p>
<h3 id="8-1-2-出现场景"><a href="#8-1-2-出现场景" class="headerlink" title="8.1.2 出现场景"></a>8.1.2 出现场景</h3><p>该类漏洞通常出现在调用外部程序完成一些功能的情景下。比如一些Web管理界面的配置主机名&#x2F;IP&#x2F;掩码&#x2F;网关、查看系统信息以及关闭重启等功能，或者一些站点提供如ping、nslookup、提供发送邮件、转换图片等功能都可能出现该类漏洞。</p>
<h3 id="8-1-3-防御手段"><a href="#8-1-3-防御手段" class="headerlink" title="8.1.3 防御手段"></a>8.1.3 防御手段</h3><ul>
<li>不使用时禁用相应函数；</li>
<li>尽量不要执行外部的应用程序或命令；</li>
<li>对用户输入的参数进行过滤校验；</li>
<li>转义命令中的所有shell元字符（#&amp;;&#96;,|*?~&lt;&gt;^()[]{}$\）。<h2 id="8-2-SQL注入"><a href="#8-2-SQL注入" class="headerlink" title="8.2 SQL注入"></a>8.2 SQL注入</h2></li>
<li>原理：利用web层和通讯层的缺陷对数据库进行外部恶意攻击。将SQL命令巧妙的插入通讯的交互过程中，如：Web表单的递交、域名输入、页面请求等。通过硬性植入的查询语句攻击数据库，利用服务器自身缺陷执行恶意的SQL命令，从而入侵数据库。根据输入的参数，可将SQL注入方式大致分为两类：数字型注入、字符型注入。<h3 id="8-2-1-攻击方法"><a href="#8-2-1-攻击方法" class="headerlink" title="8.2.1 攻击方法"></a>8.2.1 攻击方法</h3></li>
<li>基于布尔的盲注<ul>
<li>因为web的页面返回值都是True或者False，所以布尔盲注就是注入后根据页面返回值来得到数据库信息的一种办法。</li>
</ul>
</li>
<li>基于时间的盲注<ul>
<li>当布尔型注入没有结果（页面显示正常）的时候，我们很难判断注入的代码是否被执行，也可以说到底这个注入点存不存在？这个时候布尔型注入就无法发挥自己的作用了。基于时间的盲注便应运而生，所谓基于时间的盲注，就是我们根据web页面相应的时间差来判断该页面是否存在SQL注入点。</li>
</ul>
</li>
<li>联合查询注入<ul>
<li>使用联合查询进行注入的前提是我们要进行注入的页面必须有显示位。所谓联合查询注入即是使用union合并两个或多个SELECT语句的结果集，所以两个及以上的select必须有相同列、且各列的数据类型也都相同。联合查询注入可在链接最后添加order by 9基于随意数字的注入，根据页面的返回结果来判断站点中的字段数目。</li>
</ul>
</li>
<li>基于错误信息的注入<ul>
<li>此方法是在页面没有显示位，但是echo mysql_error();函数输出了错误信息的时候方能使用。优点是注入速度快，缺点是语句较为复杂，而且只能用limit依次进行猜解。总体来说，报错注入其实是一种公式化的注入方法，主要用于在页面中没有显示位，但是用echo mysql_error();输出了错误信息时使用。<h3 id="8-2-2-出现场景"><a href="#8-2-2-出现场景" class="headerlink" title="8.2.2 出现场景"></a>8.2.2 出现场景</h3></li>
</ul>
</li>
<li>在应用程序中使用字符串联结方式或联合查询方式组合SQL指令。</li>
<li>在应用程序链接数据库时使用权限过大的账户（例如很多开发人员都喜欢用最高权限的系统管理员账户（如常见的root，sa等）连接数据库）。</li>
<li>在数据库中开放了不必要但权力过大的功能（例如在Microsoft SQL Server数据库中的xp_cmdshell延伸存储程序或是OLE Automation存储程序等）。</li>
<li>太过于信任用户所输入的资料，未限制输入的特殊字符，以及未对用户输入的资料做潜在指令的检查。<h3 id="8-2-3-防御手段"><a href="#8-2-3-防御手段" class="headerlink" title="8.2.3 防御手段"></a>8.2.3 防御手段</h3></li>
</ul>
<ol>
<li>分级管理：对用户进行分级管理，严格控制用户的权限；</li>
<li>参数传值：禁止将变量直接写入到SQL语句，必须通过设置相应的参数来传递相关的变量；</li>
<li>基础过滤与二次过滤：对于单引号、双引号、冒号等字符进行转换或者过滤。首先进行基础过滤，然后根据程序的功能及用户输入的可能性进行二次过滤，以确保系统的安全性；</li>
<li>使用安全参数：在程序编写时应尽量使用安全参数来杜绝注入式攻击；</li>
<li>漏洞扫描：根据不同的情况采取相应的防范措施封堵扫描得到的漏洞；</li>
<li>多层验证：访问者的数据输入必须经过严格的验证才能进入系统，验证没通过的输入直接被拒绝访问数据库，并且向上层系统发出错误提示信息；</li>
<li>数据库信息加密<h2 id="8-3-CSRF跨站点请求伪造"><a href="#8-3-CSRF跨站点请求伪造" class="headerlink" title="8.3 CSRF跨站点请求伪造"></a>8.3 CSRF跨站点请求伪造</h2>CSRF攻击可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击站点，从而在并未授权的情况下执行在权限保护之下的操作。<h3 id="8-3-1-方法"><a href="#8-3-1-方法" class="headerlink" title="8.3.1 方法"></a>8.3.1 方法</h3>攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。<h3 id="8-3-2-出现场景"><a href="#8-3-2-出现场景" class="headerlink" title="8.3.2 出现场景"></a>8.3.2 出现场景</h3><img src="/2021-12-06-19-27-24.png"><br>其中Web A为存在CSRF漏洞的网站，Web B为攻击者构建的恶意网站，User C为Web A网站的合法用户。</li>
<li>用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；</li>
<li>在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；</li>
<li>用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；</li>
<li>网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；</li>
<li>浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。<h3 id="8-3-3-防御手段"><a href="#8-3-3-防御手段" class="headerlink" title="8.3.3 防御手段"></a>8.3.3 防御手段</h3></li>
<li>采用秘密令牌验证机制<ul>
<li>web应用程序可以在其页面中嵌入一个秘密令牌。来自这些页面的所有请求都必须携带此令牌，否则它们将被视为跨站点请求，并且将不具有与相同站点请求相同的特权。攻击者将无法获得这个秘密令牌，因此他们的请求很容易被识别为跨站点请求。</li>
</ul>
</li>
<li>验证HTTP Referer字段<ul>
<li>HTTP头部存在一个Referer字段,记录了HTTP请求的来源地址。一般情况下，只有来自于同一网站，一个页面才能对另一个安全受限的页面进行请访问请求。如果Referer是来自自己网站，那么请求合法，接受该请求;如果Referer来自其他网站，那么可能是CSRF攻击，拒绝该请求。</li>
</ul>
</li>
<li>在HTTP中自定义属性并验证<ul>
<li>用户代码中设置XMLHttpRequest来获取服务，在HTTP头部自定义属性，由于XMLHttpRequest不支持跨域修改头部，服务器方可以依据请求中是否有用户自定义的头部属性来判定请求是否合法。</li>
<li>如果要用该方法对没有做过CSRF防护的系统重新进行CSRF防护，就要把整个页面的请求都变成XMLHttpRequest请求，从而带来巨大的工作量，得不偿失。<h2 id="8-4-XSS-CSS-跨站脚本攻击"><a href="#8-4-XSS-CSS-跨站脚本攻击" class="headerlink" title="8.4 XSS(CSS)跨站脚本攻击"></a>8.4 XSS(CSS)跨站脚本攻击</h2>Cross-Site Scripting（跨站脚本攻击）简称 XSS，是一种代码注入攻击。攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全。XSS 的本质是：恶意代码未经过滤，与网站正常代码混在一起；浏览器无法分辨哪些脚本是可信的，导致恶意脚本被执行。<h3 id="8-4-1-反射型XSS"><a href="#8-4-1-反射型XSS" class="headerlink" title="8.4.1 反射型XSS"></a>8.4.1 反射型XSS</h3></li>
</ul>
</li>
</ol>
<ul>
<li>反射型 XSS 的恶意代码存在 URL 里。</li>
<li>常见于通过 URL 传递参数的功能，如网站搜索、跳转等。由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。</li>
<li>攻击步骤：<ol>
<li>攻击者构造出特殊的 URL，其中包含恶意代码。</li>
<li>用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。</li>
<li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。<h3 id="8-4-2-存储型XSS"><a href="#8-4-2-存储型XSS" class="headerlink" title="8.4.2 存储型XSS"></a>8.4.2 存储型XSS</h3></li>
</ol>
</li>
<li>存储型 XSS 的恶意代码存在数据库里。</li>
<li>常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。</li>
<li>攻击步骤：<ol>
<li>攻击者将恶意代码提交到目标网站的数据库中。</li>
<li>用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器。</li>
<li>用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。<h3 id="8-4-3-基于DOM的XSS"><a href="#8-4-3-基于DOM的XSS" class="headerlink" title="8.4.3 基于DOM的XSS"></a>8.4.3 基于DOM的XSS</h3></li>
</ol>
</li>
<li>DOM XSS是基于DOM文档对象模型的一种漏洞，所以受客户端浏览器的脚本代码所影响，而其他两种 XSS 都属于服务端的安全漏洞。</li>
<li>攻击步骤：<ol>
<li>攻击者构造出特殊的 URL，其中包含恶意代码。</li>
<li>用户打开带有恶意代码的 URL。</li>
<li>用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。</li>
<li>恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。<h3 id="8-4-4-漏洞利用"><a href="#8-4-4-漏洞利用" class="headerlink" title="8.4.4 漏洞利用"></a>8.4.4 漏洞利用</h3></li>
</ol>
</li>
</ul>
<ol>
<li>Cookie劫持<ul>
<li>一般Cookie中保存了用户的登录凭证。如果Cookie泄露，则可以直接登录进用户的账号。</li>
</ul>
</li>
<li>构造GET与POST请求<ul>
<li>通过js，让浏览器发起GET、POST请求，完成各种操作。</li>
</ul>
</li>
<li>钓鱼<ul>
<li>通过param变量注入xss payload，xss payload加载远程脚本。</li>
<li>脚本中构造一个登录框，表单提交时将账号密码发送到攻击者服务器上。</li>
</ul>
</li>
<li>识别浏览器及插件<ul>
<li>信息收集用户的浏览器版本信息，扩大攻击面。通过js读取浏览器的userAgent对象识别浏览器版本，查询navigator.plugins对象获取插件信息。<h3 id="8-4-5-防御方法"><a href="#8-4-5-防御方法" class="headerlink" title="8.4.5 防御方法"></a>8.4.5 防御方法</h3></li>
</ul>
</li>
</ol>
<ul>
<li>确保你的应用程序验证了所有头部、cookies、查询字符串、表单域、所有隐藏的参数域，严格的规范应该允许什么。</li>
<li>尝试过滤可执行的代码是不明智的，因为太多方法可以编码绕过。应采用正面的安全策略，即定义好哪些是允许的。</li>
<li>输入检查：对传入参数进行格式校验，并对特殊字符进行过滤或转义。</li>
<li>输出检查：对返回给浏览器的输出结果进行HTML实体化编码。对JavaScript输出的用户可控数据进行转义。</li>
<li>客户端防御：<ul>
<li>基于代理：分析用户浏览器和目标浏览器之间交换的HTTP流量</li>
<li>应用级防火墙：分析页面中可能导致敏感信息泄漏的超链接，设定连接规则阻止恶意请求</li>
<li>审计系统：监测代码运行，检测恶意行为</li>
</ul>
</li>
<li>此外还可以使用Vue、Angular、React等前端开发框架自带的XSS防御机制。<h4 id="8-4-5-1-预防存储型和反射型-XSS-攻击"><a href="#8-4-5-1-预防存储型和反射型-XSS-攻击" class="headerlink" title="8.4.5.1 预防存储型和反射型 XSS 攻击"></a>8.4.5.1 预防存储型和反射型 XSS 攻击</h4></li>
<li>改成纯前端渲染，把代码和数据分隔开；</li>
<li>对 HTML 做充分转义。<h4 id="8-4-5-2-预防-DOM-型-XSS-攻击"><a href="#8-4-5-2-预防-DOM-型-XSS-攻击" class="headerlink" title="8.4.5.2 预防 DOM 型 XSS 攻击"></a>8.4.5.2 预防 DOM 型 XSS 攻击</h4></li>
<li>使用安全函数；</li>
<li>不要把不可信的数据作为 HTML 插到页面上；</li>
<li>避免在字符串中拼接不可信数据。<h4 id="8-4-5-3-其他安全措施"><a href="#8-4-5-3-其他安全措施" class="headerlink" title="8.4.5.3 其他安全措施"></a>8.4.5.3 其他安全措施</h4></li>
<li>避免内联事件</li>
<li>严格执行内容安全策略（CSP）</li>
<li>控制输入内容长度</li>
<li>HTTP-only Cookie: 禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此Cookie。</li>
<li>使用验证码：防止脚本冒充用户提交危险操作。</li>
<li>主动检测和发现<h2 id="8-5-Web安全防护策略"><a href="#8-5-Web安全防护策略" class="headerlink" title="8.5 Web安全防护策略"></a>8.5 Web安全防护策略</h2><h3 id="8-5-1-基本原则"><a href="#8-5-1-基本原则" class="headerlink" title="8.5.1 基本原则"></a>8.5.1 基本原则</h3></li>
<li>缺省安全：<ul>
<li>缺省安全可以说是Web安全中最基本、最重要的原则，可以归纳为白名单、黑名单的思想以及最小权限原则。</li>
<li>有些场合适合使用黑名单，而有些场合使用白名单，但是更多地使用白名单，系统会变得更加安全。</li>
<li>最小权限原则就是只授予主体必要的权限，而不要过度授权。</li>
</ul>
</li>
<li>数据与代码分离：<ul>
<li>数据与代码分离原则广泛适用于由于“注入”而引发的安全问题，在使用该原则时，需要严格区分代码和数据段。</li>
</ul>
</li>
<li>不可预测性：<ul>
<li>不可预测性原则能够有效对抗篡改和伪造攻击。很多时候攻击者能够实现伪适的原因是所有的数据都已经知道了，因此可以伪造。如果使用一个随机的token来保护敏感的数据，就可以防止伪造了。<h3 id="8-5-2-主要措施"><a href="#8-5-2-主要措施" class="headerlink" title="8.5.2 主要措施"></a>8.5.2 主要措施</h3></li>
</ul>
</li>
<li>输入数据验证和过滤：对传入参数进行格式校验，并对特殊字符进行过滤或转义。</li>
<li>输出数据验证和过滤：对返回给浏览器的输出结果进行HTML实体化编码。对JavaScript输出的用户可控数据进行转义。</li>
<li>处理用户访问<ul>
<li>身份验证</li>
<li>会话管理</li>
<li>访问控制</li>
</ul>
</li>
<li>处理用户输入<ul>
<li>拒绝已知的不良输入(黑名单)</li>
<li>接收已知的正常输入(白名单)</li>
<li>将数据中可能存在的恶意内容彻底删除掉或者进行适当的编码和转义</li>
</ul>
</li>
<li>处理攻击行为<ul>
<li>维护日志</li>
<li>发出警报</li>
<li>修复漏洞<h2 id="8-6-Web漏洞检测工具"><a href="#8-6-Web漏洞检测工具" class="headerlink" title="8.6 Web漏洞检测工具"></a>8.6 Web漏洞检测工具</h2><h3 id="8-6-1-OpenVAS漏洞扫描工具"><a href="#8-6-1-OpenVAS漏洞扫描工具" class="headerlink" title="8.6.1 OpenVAS漏洞扫描工具"></a>8.6.1 OpenVAS漏洞扫描工具</h3>OpenVAS漏洞扫描器是一种漏洞分析工具，由于其全面的特性，IT部门可以使用它来扫描服务器和网络设备。</li>
</ul>
</li>
</ul>
<p>这些扫描器将通过扫描现有设施中的开放端口、错误配置和漏洞来查找IP地址并检查任何开放服务。</p>
<p>扫描完成后，将自动生成报告并以电子邮件形式发送，以供进一步研究和更正。</p>
<p>OpenVAS也可以从外部服务器进行操作，从黑客的角度出发，从而确定暴露的端口或服务并及时进行处理。</p>
<p>如果您已经拥有一个内部事件响应或检测系统，则OpenVAS将帮助您使用网络渗透测试工具和整个警报来改进网络监控。</p>
<h3 id="8-6-2-Tripwire-IP360"><a href="#8-6-2-Tripwire-IP360" class="headerlink" title="8.6.2 Tripwire IP360"></a>8.6.2 Tripwire IP360</h3><p>Tripwire IP360是市场上领先的漏洞管理解决方案之一，它使用户能够识别其网络上的所有内容，包括内部部署，云和容器资产。</p>
<p>Tripwire将允许IT部门使用代理访问他们的资产，并减少代理扫描。</p>
<p>它还与漏洞管理和风险管理集成在一起，使IT管理员和安全专业人员可以对安全管理采取更全面的方法。</p>
<h3 id="8-6-3-Nessus漏洞扫描工具"><a href="#8-6-3-Nessus漏洞扫描工具" class="headerlink" title="8.6.3 Nessus漏洞扫描工具"></a>8.6.3 Nessus漏洞扫描工具</h3><p>Tenable的Nessus Professional是一款面向安全专业人士的工具，负责修补程序、软件问题、恶意软件和广告软件删除工具，以及各种操作系统和应用程序的错误配置。</p>
<p>Nessus提供了一个主动的安全程序，在黑客利用漏洞入侵网络之前及时识别漏洞，同时还处理远程代码执行漏洞。</p>
<p>它关心大多数网络设备，包括虚拟，物理和云基础架构。</p>
<p>Tenable还被认为是Gartner Peer Insights在2020年3月之前进行危险性评估的首选方案。</p>
<h3 id="8-6-4-Comodo-HackerProof"><a href="#8-6-4-Comodo-HackerProof" class="headerlink" title="8.6.4 Comodo HackerProof"></a>8.6.4 Comodo HackerProof</h3><p>Comodo HackerProof是另一款优秀的漏洞扫描程序，它具有强大的功能，可让IT部门每天扫描其漏洞。</p>
<p>PCI扫描选项，防止驱动攻击和站点检查器技术，有助于下一代网站扫描。</p>
<p>除了这些特权，Comodo还提供了一个指标，让用户在与其互动时感到安全。</p>
<h3 id="8-6-5-Nexpose-community"><a href="#8-6-5-Nexpose-community" class="headerlink" title="8.6.5 Nexpose community"></a>8.6.5 Nexpose community</h3><p>Nexpose community是由Rapid7开发的漏洞扫描工具，它是涵盖大多数网络检查的开源解决方案。</p>
<p>这个解决方案的多功能性是IT管理员的一个优势，它可以被整合到一个Metaspoit框架中，能够在任何新设备访问网络时检测和扫描设备。</p>
<p>它还可以监控真实世界中的漏洞暴露，最重要的是，它可以进行相应的修复。</p>
<p>此外，漏洞扫描程序还可以对威胁进行风险评分，范围在1-1000之间，从而为安全专家在漏洞被利用之前修复漏洞提供了便利。Nexpose目前可免费试用一年。</p>
<h3 id="8-6-6-Vulnerability-Manager-Plus"><a href="#8-6-6-Vulnerability-Manager-Plus" class="headerlink" title="8.6.6 Vulnerability Manager Plus"></a>8.6.6 Vulnerability Manager Plus</h3><p>Vulnerability Manager Plus是由ManageEngine开发的针对目前市场的新解决方案。</p>
<p>它提供基于攻击者的分析，使网络管理员可以从黑客的角度检查现有漏洞。</p>
<p>除此之外，还可以进行自动扫描、影响评估、软件风险评估、安全性配置错误、修补程序、0 day漏洞缓解扫描程序， Web服务器渗透测试和强化是Vulnerability Manager Plus的其他亮点。</p>
<h3 id="8-6-7-Nikto"><a href="#8-6-7-Nikto" class="headerlink" title="8.6.7 Nikto"></a>8.6.7 Nikto</h3><p>Nikto是另一个免费的在线漏洞扫描工具，如Nexpose community。</p>
<p>Nikto可帮助您了解服务器功能，检查其版本，在网络服务器上进行测试以识别威胁和恶意软件的存在，并扫描不同的协议，如https、httpd、HTTP等。</p>
<p>还有助于在短时间内扫描服务器的多个端口。Nikto因其效率和服务器强化功能而受到青睐。</p>
<h3 id="8-6-8-Wireshark"><a href="#8-6-8-Wireshark" class="headerlink" title="8.6.8 Wireshark"></a>8.6.8 Wireshark</h3><p>Wireshark被认为是市场上功能强大的网络协议分析器之一。</p>
<p>许多政府机构，企业，医疗保健和其他行业都使用它来分析非常敏感的网络。一旦Wireshark识别出威胁，便将其脱机以进行检查。</p>
<p>Wireshark可在Linux，macOS和Windows设备上成功运行。</p>
<p>Wireshark的其他亮点还包括标准的三窗格数据包浏览器，可以使用GUI浏览网络数据，强大的显示过滤器，VoIP分析，对Kerberos，WEP，SSL &#x2F; TLS等协议的解密支持。</p>
<h3 id="8-6-9-Aircrack-ng"><a href="#8-6-9-Aircrack-ng" class="headerlink" title="8.6.9 Aircrack-ng"></a>8.6.9 Aircrack-ng</h3><p>Aircrack-ng将帮助IT部门处理WiFi网络安全问题。</p>
<p>它被用于网络审计，并提供WiFi安全和控制，还可以作为具有驱动程序和显卡，重放攻击的最佳wifi黑客应用程序之一。</p>
<p>通过捕获数据包来处理丢失的密钥。支持的操作系统包括NetBSD，Windows，OS X，Linux和Solaris。</p>
<h3 id="8-6-10-Retina"><a href="#8-6-10-Retina" class="headerlink" title="8.6.10 Retina"></a>8.6.10 Retina</h3><p>Retina漏洞扫描工具是基于Web的开源软件，从中心位置负责漏洞管理。</p>
<p>它的功能包括修补、合规性、配置和报告。</p>
<p>负责数据库、工作站、服务器分析和web应用程序，完全支持VCenter集成和应用程序扫描虚拟环境。</p>
<p>它负责多个平台，提供完整的跨平台漏洞评估和安全性。</p>
<h2 id="8-7-Web应用防火墙"><a href="#8-7-Web应用防火墙" class="headerlink" title="8.7 Web应用防火墙"></a>8.7 Web应用防火墙</h2><ul>
<li>Web应用防火墙(Web Application Firewall，简称WAF)是通过执行一系列针对HTTP&#x2F;HTTPS的安全策略来专门为Web应用提供保护的一款产品，主要用于防御针对网络应用层的攻击，像SQL注入、跨站脚本攻击、参数篡改、应用平台漏洞攻击、拒绝服务攻击等。</li>
<li>原理：WAF部署在web应用程序前面，在用户请求到达web服务器前对用户请求进行扫描和过滤，分析并校验每个用户请求的网络包，确保每个用户请求有效且安全，对无效或有攻击行为的请求进行阻断或隔离。通过检查HTTP流量，可以防止源自web应用程序的安全漏洞(如SQL注入，跨站脚本攻击，文件包含和安全配置错误)的攻击。</li>
<li>WAF的出现解决了传统防火墙无法解决的针对应用层的攻击问题：<ul>
<li>WAF会对HTTP的请求进行异常检测，拒绝不符合HTTP标准的请求，从而减少攻击的影响范围;</li>
<li>WAF增强了输入验证，可以有效防止网页篡改、信息泄露、木马植入等恶意网络入侵行为，减小Web服务器被攻击的可能;</li>
<li>WAF可以对用户访问行为进行监测，为Web应用提供基于各类安全规则与异常事件的保护;</li>
<li>WAF还有一些安全增强的功能，用以解决WEB程序员过分信任输入数据带来的问题，如隐藏表单域保护、抗入侵规避技术、响应监视和信息泄露保护等。<h2 id="8-8-浏览器终端安全"><a href="#8-8-浏览器终端安全" class="headerlink" title="8.8 浏览器终端安全"></a>8.8 浏览器终端安全</h2><h3 id="8-8-1-安全机制"><a href="#8-8-1-安全机制" class="headerlink" title="8.8.1 安全机制"></a>8.8.1 安全机制</h3><img src="/2021-12-07-14-46-27.png"><h3 id="8-8-2同源策略"><a href="#8-8-2同源策略" class="headerlink" title="8.8.2同源策略"></a>8.8.2同源策略</h3></li>
</ul>
</li>
<li>同源策略是指在Web浏览器中，允许某个网页脚本访问另一个网页的数据，但前提是这两个网页必须有相同的协议、域名和端口号，一旦两个网站满足上述条件，这两个网站就被认定为具有相同来源。此策略可防止某个网页上的恶意脚本通过该页面的文档对象模型访问另一网页上的敏感数据。</li>
<li>同源策略对Web应用程序具有特殊意义，因为Web应用程序广泛依赖于HTTP cookie来维持用户会话，所以必须将不相关网站严格分隔，以防止丢失数据泄露。</li>
<li>缺点：同源策略仅适用于脚本，这意味着某网站可以通过相应的HTML标签访问不同来源网站上的图像、CSS和动态加载脚本等资源。而跨站请求伪造就是利用同源策略不适用于HTML标签的缺陷。<h2 id="8-9-web会话管理"><a href="#8-9-web会话管理" class="headerlink" title="8.9 web会话管理"></a>8.9 web会话管理</h2><h3 id="8-9-1-cookie"><a href="#8-9-1-cookie" class="headerlink" title="8.9.1 cookie"></a>8.9.1 cookie</h3></li>
<li>cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。Cookie使基于无状态的HTTP协议记录稳定的状态信息成为了可能。</li>
<li>cookie的同源策略：域名相同</li>
<li>cookie设置和发送范围：<ul>
<li>标记为 Secure 的 Cookie 只应通过被HTTPS协议加密过的请求发送给服务端；</li>
<li>为避免跨域脚本 (XSS) 攻击，通过 JavaScript 的 Document.cookie API无法访问带有HttpOnly 标记的 Cookie；</li>
<li>Domain 标识指定了哪些主机可以接受 Cookie；</li>
<li>Path 标识指定了主机下的哪些路径可以接受Cookie；</li>
<li>SameSite Cookie 允许服务器要求某个cookie在跨站请求时不会被发送，从而可以阻止跨站请求伪造攻击（CSRF）。</li>
</ul>
</li>
<li>安全问题：<ul>
<li>Cookie捕获&#x2F;重放：<br>  攻击者可以通过木马等恶意程序，或使用跨站脚本攻击等手段偷窃存放在用户硬盘或内存中的Cookie。借助网络攻击手段，包括在不安全的局域网中被动地监听网络通信；通过攻击网络用户的路由器，或通过搭建恶意的无线路由器等手法，控制路由基础设施，将网络流量重定向到攻击者控制的主机；发动DNSPharming(域欺骗)攻击，通过DNS缓存中毒、DNS应答欺骗、或修改用户端的本地域名解析文件等方法攻击DNS系统，导致用户对合法网站的访问请求被重定向到恶意网站等等，同样可能窃取Cookie。对于捕获到的认证Cookie，攻击者往往会猜测其中的访问令牌，试图获取会话ID、用户名与口令、用户角色、时间戳等敏感信息；或者直接重放该Cookie，假冒受害者的身份发动攻击。</li>
<li>恶意 Cookies：<br>  Cookies 是文本文件， 一般情况下认为它不会造成安全威胁。 但是，如果在 Cookies 中通过特殊标记语言，引入可执行代码，就很可能给用户造成严重的安全隐患。HTML 为区别普通文本和标记语言，用符号“&lt;&gt;”来指示HTML 代码。 这些 HTML 代码或者定义 Web 网页格式，或者引入 Web 浏览器可执行代码段。 Web 服务 器可以使用Cookies 信息创建动态网页。假使Cookies 包含可执行恶意代码段，那么在显示合成有该 Cookies 的网页时，就会自动执行这段恶意代码。当然，恶意代码能否真正造成危害，还取决于Web 站点的安全配置策略。</li>
<li>会话定置<br>  会话定置(Session Fixation)攻击是指，攻击者向受害者主机注入自己控制的认证Cookie等信息，使得受害者以攻击者的身份登录网站，从而窃取受害者的会话信息。注入Cookie的方法包括：使用跨站脚本或木马等恶意程序；或伪造与合法网站同域的站点，并利用各种方法欺骗用户访问该仿冒网站，从而通过HTTP响应中的Set-Cookie头将攻击者拥有的该域Cookie发送给用户等。</li>
<li>CSRF攻击：<br>  跨站请求伪造（Cross-Site Request Forgery，简称CSRF）是指，攻击者可能利用网页中的恶意代码强迫受害者浏览器向被攻击的Web站点发送伪造的请求，篡夺受害者的认证Cookie等身份信息，从而假冒受害者对目标站点执行指定的操作。浏览器不同的窗口或标签之间可能会共享会话数据。因此，用户同时打开多个浏览器窗口或标签访问互联网资源时，就为CSRF攻击篡夺用户的会话Cookie创造了条件。另外，如果一个Web站点提供持久化Cookie，则CSRF攻击将更直接、更容易 。</li>
</ul>
</li>
<li>防御措施：<ul>
<li>加入MAC以进行完整性校验;</li>
<li>防止非法用户非法截获后的重放，可以让用户对相关信息进行数字签名，加强有效性验证;</li>
<li>对Cookie本身进行随机密钥加密，保证Cookie本身的信息安全。<h3 id="8-9-2-token"><a href="#8-9-2-token" class="headerlink" title="8.9.2 token"></a>8.9.2 token</h3></li>
</ul>
</li>
<li>当客户端请求页面时，服务器会生成一个随机数 Token，并且将 Token 放置到 session 当中，然后将 Token 发给客户端（一般通过构造 hidden 表单）。下次客户端提交请求时，Token 会随着表单一起提交到服务器端。</li>
<li>确保验证过程的安全性：建议采用HTTPS，通过SSL加密传输，以确保通道的安全性。</li>
<li>防范XSS Attacks：XSS攻击代码过滤；采用HTTP-Only Cookies。</li>
<li>防范Replay Attacks：缩短token的有效时间；记录已生成的token，限制token的使用次数。</li>
<li>防范中间人攻击：使用HTTPS。</li>
</ul>
<h1 id="九、网络安全威胁攻防链"><a href="#九、网络安全威胁攻防链" class="headerlink" title="九、网络安全威胁攻防链"></a>九、网络安全威胁攻防链</h1><h2 id="9-1-APT攻击"><a href="#9-1-APT攻击" class="headerlink" title="9.1 APT攻击"></a>9.1 APT攻击</h2><p>APT( Advanced Persistent Threat）指某组织对特定对象展开的持续有效的攻击活动.</p>
<h3 id="9-1-1-特点"><a href="#9-1-1-特点" class="headerlink" title="9.1.1 特点"></a>9.1.1 特点</h3><ol>
<li>持续性：攻击者为了重要的目标长时间持续攻击直到攻破为止。攻击成功用上一年到三年，攻击成功后持续潜伏五年到十年的案例都有。这种持续性攻击下，让攻击完全处于动态发展之中，而当前我们的防护体系都是强调静态对抗能力很少有防护者有动态对抗能力，因此防护者或许能挡住一时的攻击，但随时间的发展，系统不断有新的漏洞被发现，防御体系也会存在一定的空窗期：比如设备升级、应用需要的兼容性测试环境等等，最终导致系统的失守。</li>
<li>终端性：攻击者虽然针对的是重要的资产目标，但是入手点却是终端为主。再重要的目标，也是由终端的人来访问的。而人在一个大型组织里，是难以保证所有人的安全能力与安全意识都处于一个很高水准之上的。而做好每个人的终端防护比服务器端防护要困难很多。通过SQL注射攻击了WEB服务器，一般也是希望利用他攻击使用这些WEB服务器的终端用户作为跳板渗透进内网。</li>
<li>广谱信息收集性：攻击者会花上很长的时间和资源，依靠互联网搜集，主动扫描，甚至真实物理访问方式，收集被攻击目标的信息，主要包括：组织架构，人际关系，常用软件，常用防御策略与产品，内部网络部署等信息。</li>
<li>针对性：攻击者会针对收集到的常用软件，常用防御策略与产品，内部网络部署等信息，搭建专门的环境，用于寻找有针对性安全漏洞，测试特定的木马是否能饶过检测。</li>
<li>隐蔽合法性：攻击者访问到重要资产后，往往通过控制的客户端，分布使用合法加密的数据通道，将信息窃取出来，以饶过我们的审计和异常检测的防护。</li>
<li>攻击行为特征难以提取：APT普遍采用0day漏洞获取权限、通过未知木马进行远程控制，而传统基于特征匹配的检测设备总是要先捕获恶意代码样本，才能提取特征并基于特征进行攻击识别，这就存在先天的滞后性。</li>
<li>长期潜伏与控制：攻击者长期控制重要目标获取的利益更大。一般都会长期潜伏下来，控制和窃取重要目标。当然也不排除在关键时候破坏型爆发。</li>
<li>单点隐蔽能力强：为了躲避传统检测设备，APT更加注重动态行为和静态文件的隐蔽性。例如通过隐蔽通道、加密通道避免网络行为被检测，或者通过伪造合法签名的方式避免恶意代码文件本身被识别，这就给传统基于签名的检测带1. 攻击渠道多样化：目前被曝光的知名APT事件中，社交攻击、0day漏洞利用、物理摆渡等方式层出不穷，而传统的检测往往只注重边界防御，系统边界一旦被绕过，后续的攻击步骤实施的难度将大大降低。<h3 id="9-1-2-防御难点"><a href="#9-1-2-防御难点" class="headerlink" title="9.1.2 防御难点"></a>9.1.2 防御难点</h3></li>
<li>与攻击者信息不对称。</li>
<li>攻击行为特征难以提取，攻击渠道多元化。导致难以使用单一的手段建立通用防御机制。</li>
<li>APT攻击注重动态行为和静态文件得隐蔽性，导致实时监测困难。</li>
<li>APT攻击空间拥有不确定性。<h3 id="9-1-3-防御的基本方法"><a href="#9-1-3-防御的基本方法" class="headerlink" title="9.1.3 防御的基本方法"></a>9.1.3 防御的基本方法</h3></li>
<li>恶意代码检测<ol>
<li>基于特征码的检测技术:是对恶意代码的静态分析，找到该恶意代码中具有代表性的特征信息（指纹），如十六进制的字节序列、字符串序列等，然后再利用该特征进行快速匹配。大体不过是特征分析、特征码入库、安全检测（特征库匹配）。</li>
<li>基于启发式的检测技术:通过对恶意代码的分析获得恶意代码执行中通用的行为操作序列或结构模式，这些行为序列和模式一般再正常文件中很少出现，如修改某个PE文件的结构、删除某个系统关键文件、格式化磁盘等，然后再把每一个行为操作序列或结构模式按照危险程度排序并设定不同的危险程度加权值，在实施检测时，若行为操作序列或结构模式的加权值综合超过某个指定的阈值，即判定为恶意代码。启发式有一个特点就是阈值的设定，如果设定不合理会造成误报率过高或者漏报的情况。</li>
</ol>
</li>
<li>主机应用保护:加强系统内各主机节点的安全测试，进行系统加固可有效的阻止APT攻击</li>
<li>网络入侵分析:APT攻击的恶意代码变种多且升级频繁，但恶意代码所构建的命令控制通道通信模式并不经常变化。因此，可采用传统入侵检测方法来检测APT的命令控制通道，关键是如何及时获取APT攻击命令控制通道的通信模式特征</li>
<li>大数据分析检测:大数据分析是一种网络取证思路，它全面采集网络设备的原始流量及终端和日志服务器日志，进行集中的海量数据存储和深入分析，可通过数据来还原APT攻击场景，因涉及海量数据处理，因此需要构建Hadoop、Spark等大数据存储和分析平台，并通过机器学习对数据进行分析，从而检测是否受到攻击。<br>例如：用K-means聚类算法和ID3决策树学习算法进行网络异常流量检测，使用基于欧式距离的K-means聚类算法对正常流量行为和一场流量行为进行训练，最后结合ID3决策树判断是否发生流量异常。<h2 id="9-2-攻击链"><a href="#9-2-攻击链" class="headerlink" title="9.2 攻击链"></a>9.2 攻击链</h2><img src="/2021-12-07-15-33-19.png"><h3 id="9-2-1-侦查跟踪"><a href="#9-2-1-侦查跟踪" class="headerlink" title="9.2.1 侦查跟踪"></a>9.2.1 侦查跟踪</h3></li>
</ol>
<ul>
<li>目的：寻找可能目标，收集目标信息，评估攻击成本</li>
<li>攻击者收集有关目标和攻击策略的数据。入侵者使用自动扫描器来查找系统中的漏洞点。这包括扫描防火墙、入侵防御系统等，以获得攻击的入口点。</li>
<li>技术举例：<ul>
<li>网络搜索（搜索引擎、whois等）</li>
<li>网络扫描、嗅探</li>
<li>采集特定的信息（社工冒名）</li>
</ul>
</li>
<li>防御：<ul>
<li>检测：网络分析；威胁情报；网络入侵检测系统</li>
<li>拒绝：信息共享政策；防火墙访问控制列表<h3 id="9-2-2-武器构建"><a href="#9-2-2-武器构建" class="headerlink" title="9.2.2 武器构建"></a>9.2.2 武器构建</h3></li>
</ul>
</li>
<li>目的:确定攻击方式，准备攻击工具<ul>
<li>检视自己所拥有的攻击手段和技术优势</li>
<li>研究自己的攻击目标</li>
<li>攻击工具&amp;攻击环境准备</li>
</ul>
</li>
<li>攻击者利用安全漏洞开发恶意软件。攻击者根据他们的需求和攻击意图设计恶意软件。此过程还涉及攻击者试图减少被组织现有的安全解决方案检测到的机会。</li>
<li>技术举例：恶意代码payload，可以利用相关缺陷获取控制权</li>
<li>防御：<ul>
<li>检测：威胁情报；网络入侵检测系统</li>
<li>拒绝：网络入侵防御系统<h3 id="9-2-3-载荷投递"><a href="#9-2-3-载荷投递" class="headerlink" title="9.2.3 载荷投递"></a>9.2.3 载荷投递</h3></li>
</ul>
</li>
<li>目的：将恶意代码传递至目标机器内</li>
<li>攻击者通过网络钓鱼电子邮件或其他某种媒介传播武器化的恶意软件。武器化有效载荷最常见的传送媒介包括网站、可移动磁盘和电子邮件。这是安全团队可以阻止攻击的最重要阶段。</li>
<li>技术举例：<ul>
<li>通过应用&amp;网络漏洞投送恶意代码(开放端口)</li>
<li>通过钓鱼邮件或水坑网站投送恶意代码</li>
<li>通过U盘投送恶意代码</li>
<li>扫二维码</li>
<li>钓鱼WIFI劫持信息</li>
</ul>
</li>
<li>防御：<ul>
<li>检测：端点恶意软件保护</li>
<li>拒绝：变更管理；应用白名单；代理过滤器；基于主机的入侵防御系统</li>
<li>中断：内联防病毒</li>
<li>降级：排队</li>
<li>遏制：路由器访问控制列表；应用感知防火墙；信任区；区域间网络入侵检测系统<h3 id="9-2-4-突破利用"><a href="#9-2-4-突破利用" class="headerlink" title="9.2.4 突破利用"></a>9.2.4 突破利用</h3></li>
</ul>
</li>
<li>目的∶获得系统控制权限<ul>
<li>在目标上执行恶意代码</li>
<li>利用恶意代码获取系统控制权限</li>
</ul>
</li>
<li>恶意代码被传送到组织的系统中。边界在这里被破坏。攻击者有机会通过安装工具、运行脚本和修改安全证书来利用组织的系统。大多数情况下，目标是应用程序或操作系统的漏洞。利用攻击的示例可以是脚本编写、动态数据交换和本地作业调度。</li>
<li>防御：<ul>
<li>检测：端点恶意软件保护；基于主机的入侵检测系统</li>
<li>拒绝：安全密码；补丁管理</li>
<li>中断：数据执行保护</li>
<li>遏制：应用感知防火墙；信任区；区域间网络入侵检测系统<h3 id="9-2-5-安装植入"><a href="#9-2-5-安装植入" class="headerlink" title="9.2.5 安装植入"></a>9.2.5 安装植入</h3><img src="/2021-12-07-16-38-42.png"></li>
</ul>
</li>
<li>目的:植入后门并持续保持系统控制权<ul>
<li>在目标上植入后门</li>
<li>添加用户和服务终端</li>
<li>保持后门的持久性</li>
</ul>
</li>
<li>恶意软件安装了后门或远程访问木马，提供对入侵者的访问权限。这也是可以使用 HIPS（基于主机的入侵防御系统）等系统阻止攻击的另一个重要阶段。</li>
<li>防御：<ul>
<li>检测：安全信息和事件管理（SIEM）；基于主机的入侵检测系统</li>
<li>拒绝：权限分离；强密码；两因素身份验证</li>
<li>中断：路由器访问控制列表</li>
<li>遏制：应用感知防火墙；信任区；区域间网络入侵检测系统<h3 id="9-2-6-通信控制"><a href="#9-2-6-通信控制" class="headerlink" title="9.2.6 通信控制"></a>9.2.6 通信控制</h3></li>
</ul>
</li>
<li>目的:实现远程通信控制，为进一步入侵打基础<ul>
<li>与外部C&amp;C通信控制服务器建立通信连接</li>
<li>用web、DNS、邮件等隐藏其通信通道</li>
<li>不定期确定恶意程序的活动状态</li>
</ul>
</li>
<li>攻击者可以控制组织的系统和网络。攻击者获得特权帐户的访问权限并尝试暴力攻击、搜索凭据并更改权限以接管控制权。</li>
<li>防御： <ul>
<li>检测：网络入侵检测系统；基于主机的入侵检测系统</li>
<li>拒绝：防火墙访问控制列表；网络分割</li>
<li>中断：基于主机的入侵防御系统</li>
<li>降级：Tarpit。（Tarpit 是计算机系统（通常是服务器）上的一项服务，它故意延迟传入连接。该技术是为了防御计算机蠕虫而开发的，其想法是网络滥用（如垃圾邮件或广泛扫描）如果持续时间过长，则效果较差，因此吸引力也较低。这个概念类似于焦油坑，动物可以在其中陷入困境并慢慢沉入水面，就像在沼泽中一样。）</li>
<li>欺骗：域名系统重定向</li>
<li>遏制：信任区；域名系统漏洞<h3 id="9-2-7-达成目标"><a href="#9-2-7-达成目标" class="headerlink" title="9.2.7 达成目标"></a>9.2.7 达成目标</h3></li>
</ul>
</li>
<li>目的：破坏系统正常运行、窃取修改数据、勒索金钱等<ul>
<li>以此为跳板执行进一步渗透(横向移动到其他主机)</li>
<li>删除、修改、窃取有价值的目标数据</li>
<li>清理攻击痕迹</li>
</ul>
</li>
<li>攻击者最终从系统中提取数据。目标涉及从组织环境中收集、加密和提取机密信息。</li>
<li>防御：<ul>
<li>检测：端点恶意软件保护</li>
<li>拒绝：静态数据加密</li>
<li>中断：端点恶意软件保护</li>
<li>降级：服务质量</li>
<li>欺骗：蜜罐</li>
<li>遏制：事件响应<h2 id="9-3-防御链"><a href="#9-3-防御链" class="headerlink" title="9.3 防御链"></a>9.3 防御链</h2><img src="/2021-12-07-16-43-23.png"></li>
</ul>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" rel="prev" title="我的第一篇博客">
      <i class="fa fa-chevron-left"></i> 我的第一篇博客
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">一、网络安全概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8%E9%9D%A2%E4%B8%B4%E7%9A%84%E6%8C%91%E6%88%98"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 计算机安全面临的挑战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E4%BF%A1%E6%81%AF%E5%9C%A8%E5%A4%84%E7%90%86%E3%80%81%E4%BF%9D%E5%AD%98%E3%80%81%E4%BC%A0%E8%BE%93%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1.1 信息在处理、保存、传输中的安全威胁</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%AE%E6%A0%87"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 计算机安全的目标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%85%A5%E4%BE%B5%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 计算机入侵的特点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%85%A5%E4%BE%B5%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.3.1 计算机入侵基本术语</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A8%81%E8%83%81%E7%9A%84%E5%9B%9B%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">威胁的四种类型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-%E5%90%84%E7%B1%BB%E8%B5%84%E6%BA%90%E8%84%86%E5%BC%B1%E7%82%B9%E5%8F%8A%E5%85%B6%E5%9F%BA%E6%9C%AC%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 各类资源脆弱点及其基本防御方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-%E7%A1%AC%E4%BB%B6"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.4.1 硬件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-2-%E8%BD%AF%E4%BB%B6"><span class="nav-number">1.4.2.</span> <span class="nav-text">1.4.2 软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-3-%E6%95%B0%E6%8D%AE"><span class="nav-number">1.4.3.</span> <span class="nav-text">1.4.3 数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-4-%E4%BC%A0%E8%BE%93%E4%BB%8B%E8%B4%A8"><span class="nav-number">1.4.4.</span> <span class="nav-text">1.4.4 传输介质</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-%E9%BB%91%E5%AE%A2"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 黑客</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-1-%E9%BB%91%E5%AE%A2%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%B2"><span class="nav-number">1.5.1.</span> <span class="nav-text">1.5.1 黑客的发展史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-2-%E9%BB%91%E5%AE%A2%E7%9A%84%E7%9B%AE%E7%9A%84"><span class="nav-number">1.5.2.</span> <span class="nav-text">1.5.2 黑客的目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-3-%E8%91%97%E5%90%8D%E9%BB%91%E5%AE%A2"><span class="nav-number">1.5.3.</span> <span class="nav-text">1.5.3 著名黑客</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-4-%E9%BB%91%E5%AE%A2%E7%9A%84%E6%8A%80%E6%9C%AF%E8%A6%81%E6%B1%82"><span class="nav-number">1.5.4.</span> <span class="nav-text">1.5.4 黑客的技术要求</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E4%BA%8B%E4%BB%B6%E4%B8%BE%E4%BE%8B"><span class="nav-number">1.6.</span> <span class="nav-text">1.6 网络攻击事件举例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-1-%E6%B5%B7%E6%B9%BE%E6%88%98%E4%BA%89"><span class="nav-number">1.6.1.</span> <span class="nav-text">1.6.1 海湾战争</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-2-%E9%9C%87%E7%BD%91"><span class="nav-number">1.6.2.</span> <span class="nav-text">1.6.2 震网</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7-%E6%96%B0%E7%9A%84%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E4%B8%8E%E8%B6%8B%E5%8A%BF"><span class="nav-number">1.7.</span> <span class="nav-text">1.7 新的攻击手段与趋势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-8-%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A0%87%E5%87%86"><span class="nav-number">1.8.</span> <span class="nav-text">1.8 安全的相关标准</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-9-%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-number">1.9.</span> <span class="nav-text">1.9 信息安全研究的内容</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AF%86%E7%A0%81%E5%AD%A6%E3%80%81%E5%AF%86%E9%92%A5%E5%88%86%E9%85%8D"><span class="nav-number">2.</span> <span class="nav-text">二、密码学、密钥分配</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 密码学的基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1 密码算法的表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">2.1.2.</span> <span class="nav-text">2.1.2 密码算法的分类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E5%85%B8%E5%9E%8B%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E6%B3%95"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 典型的加密方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5%E6%A0%87%E5%87%86DES%E3%80%813DES%E3%80%81AES"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 对称密钥标准DES、3DES、AES</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-DES"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1 DES</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">安全性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-3DES"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2 3DES</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95-1"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7-1"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">安全性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-3-AES"><span class="nav-number">2.3.3.</span> <span class="nav-text">2.3.3 AES</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95-2"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7-2"><span class="nav-number">2.3.3.2.</span> <span class="nav-text">安全性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E6%A0%87%E5%87%86RSA%E3%80%81Diffie-Hellman"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 公开密钥标准RSA、Diffie-Hellman</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-1-RSA"><span class="nav-number">2.4.1.</span> <span class="nav-text">2.4.1 RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95-3"><span class="nav-number">2.4.1.1.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7-3"><span class="nav-number">2.4.1.2.</span> <span class="nav-text">安全性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-2-Diffie-Hellman"><span class="nav-number">2.4.2.</span> <span class="nav-text">2.4.2 Diffie-Hellman</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95-4"><span class="nav-number">2.4.2.1.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7-4"><span class="nav-number">2.4.2.2.</span> <span class="nav-text">安全性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E5%93%88%E5%B8%8C%E4%B8%8E%E8%AE%A4%E8%AF%81%E7%A0%81"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 哈希与认证码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-1-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">2.5.1.</span> <span class="nav-text">2.5.1 哈希函数的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-2-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">2.5.2.</span> <span class="nav-text">2.5.2 哈希函数的应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-3-%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%E7%A0%81HMAC%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-number">2.5.3.</span> <span class="nav-text">2.5.3 消息认证码HMAC的原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-4-HMAC%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">2.5.4.</span> <span class="nav-text">2.5.4 HMAC的作用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E5%AE%8C%E6%95%B4%E6%80%A7%E8%AE%A4%E8%AF%81"><span class="nav-number">2.5.4.1.</span> <span class="nav-text">消息完整性认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%A1%E6%BA%90%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="nav-number">2.5.4.2.</span> <span class="nav-text">信源身份认证</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-%E5%AF%86%E9%92%A5%E5%88%86%E9%85%8D%E5%92%8C%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 密钥分配和用户认证的作用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-1-%E4%BC%9A%E8%AF%9D%E5%AF%86%E9%92%A5%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">2.6.1.</span> <span class="nav-text">2.6.1 会话密钥的作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-%E5%9F%BA%E4%BA%8E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%9A%84%E5%AF%86%E9%92%A5%E5%88%86%E9%85%8D%EF%BC%9BKerberos%E8%AE%A4%E8%AF%81"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 基于对称加密的密钥分配；Kerberos认证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-1-Kerberos%E8%AE%A4%E8%AF%81%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">2.7.1.</span> <span class="nav-text">2.7.1 Kerberos认证适用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-2-AS%E3%80%81TGS%E3%80%81V%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">2.7.2.</span> <span class="nav-text">2.7.2 AS、TGS、V之间的关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-3-Kerberos%E5%AE%89%E5%85%A8%E6%80%A7"><span class="nav-number">2.7.3.</span> <span class="nav-text">2.7.3 Kerberos安全性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-8-%E5%9F%BA%E4%BA%8E%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%9A%84%E5%AF%86%E9%92%A5%E5%88%86%E9%85%8D"><span class="nav-number">2.8.</span> <span class="nav-text">2.8 基于非对称加密的密钥分配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-9-X-509%E8%AF%81%E4%B9%A6"><span class="nav-number">2.9.</span> <span class="nav-text">2.9 X.509证书</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-1-%E8%AF%81%E4%B9%A6%E5%8C%85%E5%90%AB%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-number">2.9.1.</span> <span class="nav-text">2.9.1 证书包含的内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-2-%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81%E7%9B%B8%E5%BA%94%E7%9A%84%E8%AF%81%E4%B9%A6"><span class="nav-number">2.9.2.</span> <span class="nav-text">2.9.2 如何验证相应的证书</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-10-%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BDKPI"><span class="nav-number">2.10.</span> <span class="nav-text">2.10 公钥基础设施KPI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-10-1-PKI%E4%B8%ADCA%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">2.10.1.</span> <span class="nav-text">2.10.1 PKI中CA的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-10-2-CA%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB"><span class="nav-number">2.10.2.</span> <span class="nav-text">2.10.2 CA之间的信任关系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81"><span class="nav-number">3.</span> <span class="nav-text">三、用户认证</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E8%AE%A4%E8%AF%81%E7%9A%84%E4%B8%80%E8%88%AC%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 认证的一般方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-%E8%AE%A4%E8%AF%81%E9%87%87%E7%94%A8%E7%9A%84%E4%B8%80%E8%88%AC%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.1.</span> <span class="nav-text">3.1.1 认证采用的一般方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E5%8F%A3%E4%BB%A4%E8%AE%A4%E8%AF%81%E9%9D%A2%E4%B8%B4%E7%9A%84%E5%A8%81%E8%83%81"><span class="nav-number">3.1.2.</span> <span class="nav-text">3.1.2 口令认证面临的威胁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-3-Unix%E5%8F%A3%E4%BB%A4%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">3.1.3.</span> <span class="nav-text">3.1.3 Unix口令存储方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E8%BF%9C%E7%A8%8B%E8%AE%A4%E8%AF%81"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 远程认证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-%E8%BF%9C%E7%A8%8B%E8%AE%A4%E8%AF%81%E4%B8%AD%E9%9C%80%E8%A6%81%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">3.2.1.</span> <span class="nav-text">3.2.1 远程认证中需要解决的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-%E6%9E%84%E9%80%A0%E4%B8%80%E6%AC%A1%E6%80%A7%E5%8A%A8%E6%80%81%E5%8F%A3%E4%BB%A4%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">3.2.2.</span> <span class="nav-text">3.2.2 构造一次性动态口令的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-%E6%8C%91%E6%88%98%E5%BA%94%E7%AD%94%E9%9D%9E%E5%90%8C%E6%AD%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E4%B8%80%E8%88%AC%E5%8E%9F%E7%90%86"><span class="nav-number">3.2.3.</span> <span class="nav-text">3.2.3 挑战应答非同步认证的一般原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-4-%E6%8C%91%E6%88%98%E5%BA%94%E7%AD%94%E9%9D%9E%E5%90%8C%E6%AD%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7"><span class="nav-number">3.2.4.</span> <span class="nav-text">3.2.4 挑战应答非同步认证的安全性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E4%B8%8E%E8%BF%9C%E7%A8%8B%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8A%80%E6%9C%AF"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 与远程认证相关的技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-TCP%E5%BA%8F%E5%88%97%E5%8F%B7"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.3.1 TCP序列号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-DNS"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.3.2 DNS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DNSSEC"><span class="nav-number">3.3.2.1.</span> <span class="nav-text">DNSSEC</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-3-HTTP"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.3.3 HTTP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%81"><span class="nav-number">3.3.3.1.</span> <span class="nav-text">基本认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%91%98%E8%A6%81%E8%AE%A4%E8%AF%81"><span class="nav-number">3.3.3.2.</span> <span class="nav-text">摘要认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OAuth%E8%AE%A4%E8%AF%81"><span class="nav-number">3.3.3.3.</span> <span class="nav-text">OAuth认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookie%E8%AE%A4%E8%AF%81"><span class="nav-number">3.3.3.4.</span> <span class="nav-text">Cookie认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Token%E8%AE%A4%E8%AF%81"><span class="nav-number">3.3.3.5.</span> <span class="nav-text">Token认证</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-4-SSL"><span class="nav-number">3.3.4.</span> <span class="nav-text">3.3.4 SSL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-5-SSH"><span class="nav-number">3.3.5.</span> <span class="nav-text">3.3.5 SSH</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%BC%BA%E9%99%B7"><span class="nav-number">4.</span> <span class="nav-text">四、网络协议缺陷</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-Internet%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E6%9C%AC%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 Internet网络协议基本的安全问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E8%B7%AF%E7%94%B1%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 路由的漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-ARP%E6%AC%BA%E9%AA%97%E8%BF%87%E7%A8%8B"><span class="nav-number">4.2.1.</span> <span class="nav-text">4.2.1 ARP欺骗过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-BGP%E5%8D%8F%E8%AE%AE"><span class="nav-number">4.2.2.</span> <span class="nav-text">4.2.2 BGP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BGP%E5%8A%AB%E6%8C%81%E7%AE%80%E4%BB%8B"><span class="nav-number">4.2.2.1.</span> <span class="nav-text">BGP劫持简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BGP%E5%8A%AB%E6%8C%81%E8%A6%81%E6%B1%82"><span class="nav-number">4.2.2.2.</span> <span class="nav-text">BGP劫持要求</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-DNS%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 DNS系统的安全问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-DNS%E7%BC%93%E5%AD%98%E4%B8%AD%E6%AF%92"><span class="nav-number">4.3.1.</span> <span class="nav-text">4.3.1 DNS缓存中毒</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-1-%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="nav-number">4.3.1.1.</span> <span class="nav-text">4.3.1.1 攻击原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-2-%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF%E6%89%8B%E6%AE%B5"><span class="nav-number">4.3.1.2.</span> <span class="nav-text">4.3.1.2 常用技术手段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-3-%E9%98%B2%E5%BE%A1"><span class="nav-number">4.3.1.3.</span> <span class="nav-text">4.3.1.3 防御</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-DNS%E9%87%8D%E6%96%B0%E7%BB%91%E5%AE%9A%E6%94%BB%E5%87%BB"><span class="nav-number">4.3.2.</span> <span class="nav-text">4.3.2 DNS重新绑定攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-1-%E6%94%BB%E5%87%BB%E6%B5%81%E7%A8%8B"><span class="nav-number">4.3.2.1.</span> <span class="nav-text">4.3.2.1 攻击流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-2-%E9%98%B2%E5%BE%A1"><span class="nav-number">4.3.2.2.</span> <span class="nav-text">4.3.2.2 防御</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E5%97%85%E6%8E%A2"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 嗅探</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-%E8%A2%AB%E5%8A%A8%E5%97%85%E6%8E%A2"><span class="nav-number">4.4.1.</span> <span class="nav-text">4.4.1 被动嗅探</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-1-1-%E6%8A%80%E6%9C%AF%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-number">4.4.1.1.</span> <span class="nav-text">4.4.1.1 技术和方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-1-2-%E9%98%B2%E5%BE%A1"><span class="nav-number">4.4.1.2.</span> <span class="nav-text">4.4.1.2 防御</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-%E4%B8%BB%E5%8A%A8%E5%97%85%E6%8E%A2"><span class="nav-number">4.4.2.</span> <span class="nav-text">4.4.2 主动嗅探</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-2-1%E6%8A%80%E6%9C%AF%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-number">4.4.2.1.</span> <span class="nav-text">4.4.2.1技术和方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-2-2-%E9%98%B2%E5%BE%A1"><span class="nav-number">4.4.2.2.</span> <span class="nav-text">4.4.2.2 防御</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-3-%E4%B8%A4%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.4.3.</span> <span class="nav-text">4.4.3 两者的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-ARP%E6%AC%BA%E9%AA%97"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 ARP欺骗</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-1-%E5%9C%BA%E6%99%AF"><span class="nav-number">4.5.1.</span> <span class="nav-text">4.5.1 场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-2-%E5%8D%B1%E5%AE%B3"><span class="nav-number">4.5.2.</span> <span class="nav-text">4.5.2 危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-3-%E9%98%B2%E5%BE%A1"><span class="nav-number">4.5.3.</span> <span class="nav-text">4.5.3 防御</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-IP%E5%9C%B0%E5%9D%80%E6%AC%BA%E9%AA%97"><span class="nav-number">4.6.</span> <span class="nav-text">4.6 IP地址欺骗</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-1-%E6%96%B9%E6%B3%95"><span class="nav-number">4.6.1.</span> <span class="nav-text">4.6.1 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-2-%E5%8D%B1%E5%AE%B3"><span class="nav-number">4.6.2.</span> <span class="nav-text">4.6.2 危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-3-%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95"><span class="nav-number">4.6.3.</span> <span class="nav-text">4.6.3 防御方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-TCP%E4%BC%9A%E8%AF%9D%E5%8A%AB%E6%8C%81"><span class="nav-number">4.7.</span> <span class="nav-text">4.7 TCP会话劫持</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-1-%E6%96%B9%E6%B3%95"><span class="nav-number">4.7.1.</span> <span class="nav-text">4.7.1 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-2-%E5%8D%B1%E5%AE%B3"><span class="nav-number">4.7.2.</span> <span class="nav-text">4.7.2 危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-3-%E9%98%B2%E8%8C%83"><span class="nav-number">4.7.3.</span> <span class="nav-text">4.7.3 防范</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-8-BGP%E4%BC%9A%E8%AF%9D%E5%8A%AB%E6%8C%81"><span class="nav-number">4.8.</span> <span class="nav-text">4.8 BGP会话劫持</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-1-%E5%A6%82%E4%BD%95%E5%8A%AB%E6%8C%81"><span class="nav-number">4.8.1.</span> <span class="nav-text">4.8.1 如何劫持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-2-%E5%8D%B1%E5%AE%B3"><span class="nav-number">4.8.2.</span> <span class="nav-text">4.8.2 危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-3-%E9%98%B2%E8%8C%83"><span class="nav-number">4.8.3.</span> <span class="nav-text">4.8.3 防范</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE%E6%A0%87%E5%87%86"><span class="nav-number">5.</span> <span class="nav-text">五、安全协议标准</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-IP%E5%AE%89%E5%85%A8"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 IP安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-1-IPsec%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="nav-number">5.1.1.</span> <span class="nav-text">5.1.1 IPsec的两种工作模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-1-%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F"><span class="nav-number">5.1.1.1.</span> <span class="nav-text">5.1.1.1 传输模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-2-%E9%9A%A7%E9%81%93%E6%A8%A1%E5%BC%8F"><span class="nav-number">5.1.1.2.</span> <span class="nav-text">5.1.1.2 隧道模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-3-%E4%B8%A4%E8%80%85%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">5.1.1.3.</span> <span class="nav-text">5.1.1.3 两者的比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-4-%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">5.1.1.4.</span> <span class="nav-text">5.1.1.4 协议的作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-5-%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="nav-number">5.1.1.5.</span> <span class="nav-text">5.1.1.5 协议的安全性分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-2-%E5%AE%89%E5%85%A8%E5%85%B3%E8%81%94SA%E4%B8%8E%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5%E6%95%B0%E6%8D%AE%E5%BA%93SPD"><span class="nav-number">5.1.2.</span> <span class="nav-text">5.1.2 安全关联SA与安全策略数据库SPD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-3-%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AEIKE"><span class="nav-number">5.1.3.</span> <span class="nav-text">5.1.3 密钥交换协议IKE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-3-1-SA%E7%9A%84%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E8%BF%87%E7%A8%8B"><span class="nav-number">5.1.3.1.</span> <span class="nav-text">5.1.3.1 SA的密钥交换过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-3-2-%E5%AE%89%E5%85%A8%E6%80%A7"><span class="nav-number">5.1.3.2.</span> <span class="nav-text">5.1.3.2 安全性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 传输层安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1-SSL"><span class="nav-number">5.2.1.</span> <span class="nav-text">5.2.1 SSL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-1-%E5%8A%9F%E8%83%BD"><span class="nav-number">5.2.1.1.</span> <span class="nav-text">5.2.1.1 功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-2-%E7%89%B9%E7%82%B9"><span class="nav-number">5.2.1.2.</span> <span class="nav-text">5.2.1.2 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-3-%E5%8D%8F%E8%AE%AE%E6%A1%86%E6%9E%B6"><span class="nav-number">5.2.1.3.</span> <span class="nav-text">5.2.1.3 协议框架</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-4-%E4%BA%A4%E4%BA%92%E8%BF%87%E7%A8%8B"><span class="nav-number">5.2.1.4.</span> <span class="nav-text">5.2.1.4 交互过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2-TLS"><span class="nav-number">5.2.2.</span> <span class="nav-text">5.2.2 TLS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-3-HTTPS"><span class="nav-number">5.2.3.</span> <span class="nav-text">5.2.3 HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-1-%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="nav-number">5.2.3.1.</span> <span class="nav-text">5.2.3.1 执行过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-2-%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.2.3.2.</span> <span class="nav-text">5.2.3.2 消息格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-3-%E5%AE%A2%E6%88%B7%E5%AF%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E8%AE%A4%E8%AF%81"><span class="nav-number">5.2.3.3.</span> <span class="nav-text">5.2.3.3 客户对服务器的认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-4-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AF%B9%E5%AE%A2%E6%88%B7%E7%9A%84%E8%AE%A4%E8%AF%81"><span class="nav-number">5.2.3.4.</span> <span class="nav-text">5.2.3.4 服务器对客户的认证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-5-%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">5.2.3.5.</span> <span class="nav-text">5.2.3.5 解决的问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-4-SSH"><span class="nav-number">5.2.4.</span> <span class="nav-text">5.2.4 SSH</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-4-1-%E4%BD%9C%E7%94%A8"><span class="nav-number">5.2.4.1.</span> <span class="nav-text">5.2.4.1 作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-4-2-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">5.2.4.2.</span> <span class="nav-text">5.2.4.2 工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-4-3-%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F"><span class="nav-number">5.2.4.3.</span> <span class="nav-text">5.2.4.3 认证方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 电子邮件安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-PGP"><span class="nav-number">5.3.1.</span> <span class="nav-text">5.3.1 PGP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-1-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="nav-number">5.3.1.1.</span> <span class="nav-text">5.3.1.1 工作流程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-2-%E4%BC%9A%E8%AF%9D%E5%AF%86%E9%92%A5%EF%BC%9A"><span class="nav-number">5.3.1.2.</span> <span class="nav-text">5.3.1.2 会话密钥：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-3-%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.3.1.3.</span> <span class="nav-text">5.3.1.3 消息格式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-S-x2F-MIME"><span class="nav-number">5.3.2.</span> <span class="nav-text">5.3.2 S&#x2F;MIME</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-1-%E4%B8%8EPGP%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">5.3.2.1.</span> <span class="nav-text">5.3.2.1 与PGP的比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-2-S-x2F-MIME%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="nav-number">5.3.2.2.</span> <span class="nav-text">5.3.2.2 S&#x2F;MIME的功能</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-3-DKIM"><span class="nav-number">5.3.3.</span> <span class="nav-text">5.3.3 DKIM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-4-%E5%9E%83%E5%9C%BE%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">5.3.4.</span> <span class="nav-text">5.3.4 垃圾邮件发送的基本原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-1-SMTP-Relay"><span class="nav-number">5.3.4.1.</span> <span class="nav-text">5.3.4.1 SMTP Relay</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-2-HTTP-proxies"><span class="nav-number">5.3.4.2.</span> <span class="nav-text">5.3.4.2 HTTP proxies</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-3-spamware%EF%BC%88%E5%9E%83%E5%9C%BE%E9%82%AE%E4%BB%B6%E8%BD%AF%E4%BB%B6%EF%BC%89"><span class="nav-number">5.3.4.3.</span> <span class="nav-text">5.3.4.3 spamware（垃圾邮件软件）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-4-%E4%B8%AD%E7%BB%A7vs%E4%BB%A3%E7%90%86"><span class="nav-number">5.3.4.4.</span> <span class="nav-text">5.3.4.4 中继vs代理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-5-%E5%8F%8D%E5%9E%83%E5%9C%BE%E9%82%AE%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">5.3.5.</span> <span class="nav-text">5.3.5 反垃圾邮件的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-5-1-%E6%B3%95%E5%BE%8BCAN-SPAM-act"><span class="nav-number">5.3.5.1.</span> <span class="nav-text">5.3.5.1 法律CAN-SPAM act</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-5-2-%E5%8F%91%E9%80%81%E6%96%B9%E9%AA%8C%E8%AF%81%E2%85%A0%EF%BC%9ASPF"><span class="nav-number">5.3.5.2.</span> <span class="nav-text">5.3.5.2 发送方验证Ⅰ：SPF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-5-3-%E5%8F%91%E9%80%81%E6%96%B9%E9%AA%8C%E8%AF%81%E2%85%A1%EF%BC%9ADKIM"><span class="nav-number">5.3.5.3.</span> <span class="nav-text">5.3.5.3 发送方验证Ⅱ：DKIM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-5-4-Graylists"><span class="nav-number">5.3.5.4.</span> <span class="nav-text">5.3.5.4 Graylists</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-5-5-whitelisting"><span class="nav-number">5.3.5.5.</span> <span class="nav-text">5.3.5.5 whitelisting</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E5%85%B8%E5%9E%8B%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95"><span class="nav-number">6.</span> <span class="nav-text">六、典型网络攻击与防御方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 攻击手段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-1-%E6%94%BB%E5%87%BB%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="nav-number">6.1.1.</span> <span class="nav-text">6.1.1 攻击准备阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-2-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">6.1.2.</span> <span class="nav-text">6.1.2 端口扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-3-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="nav-number">6.1.3.</span> <span class="nav-text">6.1.3 漏洞扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-%E7%BD%91%E7%BB%9C%E6%B5%8B%E7%BB%98"><span class="nav-number">6.1.4.</span> <span class="nav-text">6.1.4 网络测绘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-5-%E6%94%BB%E5%87%BB%E9%93%BE%E4%B8%8E%E5%8F%8D%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">6.1.5.</span> <span class="nav-text">6.1.5 攻击链与反攻击链</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">6.1.5.1.</span> <span class="nav-text">攻击链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">6.1.5.2.</span> <span class="nav-text">反攻击链</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-%E4%B8%8D%E5%90%8C%E5%8D%8F%E8%AE%AE%E5%B1%82%E6%AC%A1%E7%9A%84DoS%E6%94%BB%E5%87%BB"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 不同协议层次的DoS攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-1-802-11b-DoS-bugs"><span class="nav-number">6.2.1.</span> <span class="nav-text">6.2.1 802.11b DoS bugs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-2-%E6%94%BE%E5%A4%A7%E5%BC%8F%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="nav-number">6.2.2.</span> <span class="nav-text">6.2.2 放大式拒绝服务攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-2-1-Smurf-amplification-attack"><span class="nav-number">6.2.2.1.</span> <span class="nav-text">6.2.2.1 Smurf amplification attack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-2-2-DNS-amplification-attack"><span class="nav-number">6.2.2.2.</span> <span class="nav-text">6.2.2.2 DNS amplification attack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-3-SYN-Floods"><span class="nav-number">6.2.3.</span> <span class="nav-text">6.2.3 SYN Floods</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-3-1-TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B"><span class="nav-number">6.2.3.1.</span> <span class="nav-text">6.2.3.1 TCP三次握手过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-3-2-SYN-Floods%E6%94%BB%E5%87%BB%E6%AD%A5%E9%AA%A4"><span class="nav-number">6.2.3.2.</span> <span class="nav-text">6.2.3.2 SYN Floods攻击步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-3-3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="nav-number">6.2.3.3.</span> <span class="nav-text">6.2.3.3 防御措施</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-4-DNS-Query-Flood"><span class="nav-number">6.2.4.</span> <span class="nav-text">6.2.4 DNS Query Flood</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-5-%E9%AB%98%E5%B1%82%E7%9A%84DoS%E6%94%BB%E5%87%BB"><span class="nav-number">6.2.5.</span> <span class="nav-text">6.2.5 高层的DoS攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-5-1-Slow-HTTP-DoS"><span class="nav-number">6.2.5.1.</span> <span class="nav-text">6.2.5.1 Slow HTTP DoS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-5-2-HTTP-Flood%EF%BC%88CC%E6%94%BB%E5%87%BB%EF%BC%89"><span class="nav-number">6.2.5.2.</span> <span class="nav-text">6.2.5.2 HTTP Flood（CC攻击）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-5-3-SSL-D-DoS"><span class="nav-number">6.2.5.3.</span> <span class="nav-text">6.2.5.3 SSL-(D)DoS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-6-DoS%E9%98%B2%E5%BE%A1%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">6.2.6.</span> <span class="nav-text">6.2.6 DoS防御的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-6-1-Client-Puzzles"><span class="nav-number">6.2.6.1.</span> <span class="nav-text">6.2.6.1 Client Puzzles</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-6-2-CAPTCHAs"><span class="nav-number">6.2.6.2.</span> <span class="nav-text">6.2.6.2 CAPTCHAs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-6-3-Source-Identification"><span class="nav-number">6.2.6.3.</span> <span class="nav-text">6.2.6.3 Source Identification</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-6-4-%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="nav-number">6.2.6.4.</span> <span class="nav-text">6.2.6.4 其他方法</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%95%8C%E5%AE%89%E5%85%A8%E9%98%B2%E5%BE%A1"><span class="nav-number">7.</span> <span class="nav-text">七、网络边界安全防御</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 防火墙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-1-%E5%8C%85%E8%BF%87%E6%BB%A4%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%88%E5%88%86%E7%BB%84%E8%BF%87%E6%BB%A4%EF%BC%89"><span class="nav-number">7.1.1.</span> <span class="nav-text">7.1.1 包过滤防火墙（分组过滤）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-2-%E6%9C%89%E7%8A%B6%E6%80%81%E7%9A%84%E5%8A%A8%E6%80%81%E5%8C%85%E8%BF%87%E6%BB%A4"><span class="nav-number">7.1.2.</span> <span class="nav-text">7.1.2 有状态的动态包过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-3-%E5%BA%94%E7%94%A8%E5%B1%82%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">7.1.3.</span> <span class="nav-text">7.1.3 应用层防火墙</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-4-%E5%8C%85%E7%A2%8E%E7%89%87%E6%94%BB%E5%87%BB"><span class="nav-number">7.1.4.</span> <span class="nav-text">7.1.4 包碎片攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-5-%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E9%83%A8%E7%BD%B2"><span class="nav-number">7.1.5.</span> <span class="nav-text">7.1.5 防火墙的部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-5-1-%E5%B1%8F%E8%94%BD%E4%B8%BB%E6%9C%BA%E7%BB%93%E6%9E%84"><span class="nav-number">7.1.5.1.</span> <span class="nav-text">7.1.5.1 屏蔽主机结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-5-2-%E5%B1%8F%E8%94%BD%E5%AD%90%E7%BD%91%E7%BB%93%E6%9E%84"><span class="nav-number">7.1.5.2.</span> <span class="nav-text">7.1.5.2 屏蔽子网结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-5-3-%E5%8F%8C%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%BB%93%E6%9E%84"><span class="nav-number">7.1.5.3.</span> <span class="nav-text">7.1.5.3 双宿主机结构</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 入侵检测</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-1-IDS%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="nav-number">7.2.1.</span> <span class="nav-text">7.2.1 IDS的基本结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-2-%E6%BB%A5%E7%94%A8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.2.</span> <span class="nav-text">7.2.2 滥用检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-1-%E4%B8%93%E5%AE%B6%E7%B3%BB%E7%BB%9F%E6%BB%A5%E7%94%A8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.2.1.</span> <span class="nav-text">7.2.2.1 专家系统滥用检测</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-2-%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%88%86%E6%9E%90%E6%BB%A5%E7%94%A8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.2.2.</span> <span class="nav-text">7.2.2.2 状态转换分析滥用检测</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-3-%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.3.</span> <span class="nav-text">7.2.3 异常检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-1-%E6%A6%82%E7%8E%87%E7%BB%9F%E8%AE%A1%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.3.1.</span> <span class="nav-text">7.2.3.1 概率统计异常检测</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-2-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B"><span class="nav-number">7.2.3.2.</span> <span class="nav-text">7.2.3.2 神经网络异常检测</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-4-%E5%9F%BA%E4%BA%8E%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%EF%BC%88HIDS%EF%BC%89"><span class="nav-number">7.2.4.</span> <span class="nav-text">7.2.4 基于主机的入侵检测（HIDS）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-5-%E5%9F%BA%E4%BA%8E%E7%BD%91%E7%BB%9C%E7%9A%84%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%EF%BC%88NIDS%EF%BC%89"><span class="nav-number">7.2.5.</span> <span class="nav-text">7.2.5 基于网络的入侵检测（NIDS）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-6-snort%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-number">7.2.6.</span> <span class="nav-text">7.2.6 snort的结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-6-1-snort%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-number">7.2.6.1.</span> <span class="nav-text">7.2.6.1 snort的组成</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-6-2-snort%E7%9A%84%E4%B8%89%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="nav-number">7.2.6.2.</span> <span class="nav-text">7.2.6.2 snort的三种工作方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-6-3-snort%E8%A7%84%E5%88%99"><span class="nav-number">7.2.6.3.</span> <span class="nav-text">7.2.6.3 snort规则</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AB%E3%80%81Web%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8"><span class="nav-number">8.</span> <span class="nav-text">八、Web应用安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="nav-number">8.1.</span> <span class="nav-text">8.1 命令注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-1-%E6%96%B9%E6%B3%95"><span class="nav-number">8.1.1.</span> <span class="nav-text">8.1.1 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-2-%E5%87%BA%E7%8E%B0%E5%9C%BA%E6%99%AF"><span class="nav-number">8.1.2.</span> <span class="nav-text">8.1.2 出现场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-3-%E9%98%B2%E5%BE%A1%E6%89%8B%E6%AE%B5"><span class="nav-number">8.1.3.</span> <span class="nav-text">8.1.3 防御手段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">8.2.</span> <span class="nav-text">8.2 SQL注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-1-%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="nav-number">8.2.1.</span> <span class="nav-text">8.2.1 攻击方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-2-%E5%87%BA%E7%8E%B0%E5%9C%BA%E6%99%AF"><span class="nav-number">8.2.2.</span> <span class="nav-text">8.2.2 出现场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-3-%E9%98%B2%E5%BE%A1%E6%89%8B%E6%AE%B5"><span class="nav-number">8.2.3.</span> <span class="nav-text">8.2.3 防御手段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-CSRF%E8%B7%A8%E7%AB%99%E7%82%B9%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0"><span class="nav-number">8.3.</span> <span class="nav-text">8.3 CSRF跨站点请求伪造</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-1-%E6%96%B9%E6%B3%95"><span class="nav-number">8.3.1.</span> <span class="nav-text">8.3.1 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-2-%E5%87%BA%E7%8E%B0%E5%9C%BA%E6%99%AF"><span class="nav-number">8.3.2.</span> <span class="nav-text">8.3.2 出现场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-3-%E9%98%B2%E5%BE%A1%E6%89%8B%E6%AE%B5"><span class="nav-number">8.3.3.</span> <span class="nav-text">8.3.3 防御手段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-XSS-CSS-%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB"><span class="nav-number">8.4.</span> <span class="nav-text">8.4 XSS(CSS)跨站脚本攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-1-%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="nav-number">8.4.1.</span> <span class="nav-text">8.4.1 反射型XSS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-2-%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="nav-number">8.4.2.</span> <span class="nav-text">8.4.2 存储型XSS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-3-%E5%9F%BA%E4%BA%8EDOM%E7%9A%84XSS"><span class="nav-number">8.4.3.</span> <span class="nav-text">8.4.3 基于DOM的XSS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-4-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">8.4.4.</span> <span class="nav-text">8.4.4 漏洞利用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-5-%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95"><span class="nav-number">8.4.5.</span> <span class="nav-text">8.4.5 防御方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-4-5-1-%E9%A2%84%E9%98%B2%E5%AD%98%E5%82%A8%E5%9E%8B%E5%92%8C%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS-%E6%94%BB%E5%87%BB"><span class="nav-number">8.4.5.1.</span> <span class="nav-text">8.4.5.1 预防存储型和反射型 XSS 攻击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-4-5-2-%E9%A2%84%E9%98%B2-DOM-%E5%9E%8B-XSS-%E6%94%BB%E5%87%BB"><span class="nav-number">8.4.5.2.</span> <span class="nav-text">8.4.5.2 预防 DOM 型 XSS 攻击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-4-5-3-%E5%85%B6%E4%BB%96%E5%AE%89%E5%85%A8%E6%8E%AA%E6%96%BD"><span class="nav-number">8.4.5.3.</span> <span class="nav-text">8.4.5.3 其他安全措施</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-Web%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4%E7%AD%96%E7%95%A5"><span class="nav-number">8.5.</span> <span class="nav-text">8.5 Web安全防护策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-5-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="nav-number">8.5.1.</span> <span class="nav-text">8.5.1 基本原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-5-2-%E4%B8%BB%E8%A6%81%E6%8E%AA%E6%96%BD"><span class="nav-number">8.5.2.</span> <span class="nav-text">8.5.2 主要措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-6-Web%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7"><span class="nav-number">8.6.</span> <span class="nav-text">8.6 Web漏洞检测工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-1-OpenVAS%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7"><span class="nav-number">8.6.1.</span> <span class="nav-text">8.6.1 OpenVAS漏洞扫描工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-2-Tripwire-IP360"><span class="nav-number">8.6.2.</span> <span class="nav-text">8.6.2 Tripwire IP360</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-3-Nessus%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7"><span class="nav-number">8.6.3.</span> <span class="nav-text">8.6.3 Nessus漏洞扫描工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-4-Comodo-HackerProof"><span class="nav-number">8.6.4.</span> <span class="nav-text">8.6.4 Comodo HackerProof</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-5-Nexpose-community"><span class="nav-number">8.6.5.</span> <span class="nav-text">8.6.5 Nexpose community</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-6-Vulnerability-Manager-Plus"><span class="nav-number">8.6.6.</span> <span class="nav-text">8.6.6 Vulnerability Manager Plus</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-7-Nikto"><span class="nav-number">8.6.7.</span> <span class="nav-text">8.6.7 Nikto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-8-Wireshark"><span class="nav-number">8.6.8.</span> <span class="nav-text">8.6.8 Wireshark</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-9-Aircrack-ng"><span class="nav-number">8.6.9.</span> <span class="nav-text">8.6.9 Aircrack-ng</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-10-Retina"><span class="nav-number">8.6.10.</span> <span class="nav-text">8.6.10 Retina</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-7-Web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">8.7.</span> <span class="nav-text">8.7 Web应用防火墙</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-8-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8"><span class="nav-number">8.8.</span> <span class="nav-text">8.8 浏览器终端安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-8-1-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6"><span class="nav-number">8.8.1.</span> <span class="nav-text">8.8.1 安全机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-8-2%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5"><span class="nav-number">8.8.2.</span> <span class="nav-text">8.8.2同源策略</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-9-web%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86"><span class="nav-number">8.9.</span> <span class="nav-text">8.9 web会话管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-1-cookie"><span class="nav-number">8.9.1.</span> <span class="nav-text">8.9.1 cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-9-2-token"><span class="nav-number">8.9.2.</span> <span class="nav-text">8.9.2 token</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%9D%E3%80%81%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81%E6%94%BB%E9%98%B2%E9%93%BE"><span class="nav-number">9.</span> <span class="nav-text">九、网络安全威胁攻防链</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-APT%E6%94%BB%E5%87%BB"><span class="nav-number">9.1.</span> <span class="nav-text">9.1 APT攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-1-%E7%89%B9%E7%82%B9"><span class="nav-number">9.1.1.</span> <span class="nav-text">9.1.1 特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-2-%E9%98%B2%E5%BE%A1%E9%9A%BE%E7%82%B9"><span class="nav-number">9.1.2.</span> <span class="nav-text">9.1.2 防御难点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-3-%E9%98%B2%E5%BE%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E6%B3%95"><span class="nav-number">9.1.3.</span> <span class="nav-text">9.1.3 防御的基本方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">9.2.</span> <span class="nav-text">9.2 攻击链</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-1-%E4%BE%A6%E6%9F%A5%E8%B7%9F%E8%B8%AA"><span class="nav-number">9.2.1.</span> <span class="nav-text">9.2.1 侦查跟踪</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-2-%E6%AD%A6%E5%99%A8%E6%9E%84%E5%BB%BA"><span class="nav-number">9.2.2.</span> <span class="nav-text">9.2.2 武器构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-3-%E8%BD%BD%E8%8D%B7%E6%8A%95%E9%80%92"><span class="nav-number">9.2.3.</span> <span class="nav-text">9.2.3 载荷投递</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-4-%E7%AA%81%E7%A0%B4%E5%88%A9%E7%94%A8"><span class="nav-number">9.2.4.</span> <span class="nav-text">9.2.4 突破利用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-5-%E5%AE%89%E8%A3%85%E6%A4%8D%E5%85%A5"><span class="nav-number">9.2.5.</span> <span class="nav-text">9.2.5 安装植入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-6-%E9%80%9A%E4%BF%A1%E6%8E%A7%E5%88%B6"><span class="nav-number">9.2.6.</span> <span class="nav-text">9.2.6 通信控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-7-%E8%BE%BE%E6%88%90%E7%9B%AE%E6%A0%87"><span class="nav-number">9.2.7.</span> <span class="nav-text">9.2.7 达成目标</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-3-%E9%98%B2%E5%BE%A1%E9%93%BE"><span class="nav-number">9.3.</span> <span class="nav-text">9.3 防御链</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">1_ynx</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">1_ynx</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
